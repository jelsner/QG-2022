<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Thursday, September 15, 2022 | GEO5156: Quantitative Geography</title>
  <meta name="description" content="Thursday, September 15, 2022 | GEO5156: Quantitative Geography" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Thursday, September 15, 2022 | GEO5156: Quantitative Geography" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="jelsner/QG-2022" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Thursday, September 15, 2022 | GEO5156: Quantitative Geography" />
  
  
  

<meta name="author" content="James B. Elsner" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tuesday-september-13-2022.html"/>
<link rel="next" href="thursday-october-20-2022.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Quantitative Geography</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html"><i class="fa fa-check"></i>Syllabus</a>
<ul>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#geo5165c-quantitative-geography"><i class="fa fa-check"></i>GEO5165C: Quantitative Geography</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#contact-information"><i class="fa fa-check"></i>Contact information</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#course-description"><i class="fa fa-check"></i>Course description</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#grades"><i class="fa fa-check"></i>Grades</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#ethics"><i class="fa fa-check"></i>Ethics</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#schedule-subject-to-change-with-notice"><i class="fa fa-check"></i>Schedule (subject to change with notice)</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#deeper-dives"><i class="fa fa-check"></i>Deeper dives</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html"><i class="fa fa-check"></i>Tuesday, August 23, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#what-is-this-course"><i class="fa fa-check"></i>What is this course?</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#where-are-the-materials-for-this-course"><i class="fa fa-check"></i>Where are the materials for this course?</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#syllabus-1"><i class="fa fa-check"></i>Syllabus</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#getting-setup"><i class="fa fa-check"></i>Getting setup</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#rstudios-integrated-development-environment-ide"><i class="fa fa-check"></i>RStudio’s integrated development environment (IDE)</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#example-tallahassee-daily-temperatures"><i class="fa fa-check"></i>Example: Tallahassee daily temperatures</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-august-25-2022.html"><a href="thursday-august-25-2022.html"><i class="fa fa-check"></i>Thursday, August 25, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-august-25-2022.html"><a href="thursday-august-25-2022.html#data-science"><i class="fa fa-check"></i>Data science</a></li>
<li class="chapter" data-level="" data-path="thursday-august-25-2022.html"><a href="thursday-august-25-2022.html#structure-of-markdown-files"><i class="fa fa-check"></i>Structure of markdown files</a></li>
<li class="chapter" data-level="" data-path="thursday-august-25-2022.html"><a href="thursday-august-25-2022.html#how-to-make-a-plot"><i class="fa fa-check"></i>How to make a plot</a></li>
<li class="chapter" data-level="" data-path="thursday-august-25-2022.html"><a href="thursday-august-25-2022.html#getting-started-using-r"><i class="fa fa-check"></i>Getting started using R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-august-30-2022.html"><a href="tuesday-august-30-2022.html"><i class="fa fa-check"></i>Tuesday, August 30, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-august-30-2022.html"><a href="tuesday-august-30-2022.html#graphing-examples"><i class="fa fa-check"></i>Graphing examples</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-30-2022.html"><a href="tuesday-august-30-2022.html#working-with-r"><i class="fa fa-check"></i>Working with R</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-30-2022.html"><a href="tuesday-august-30-2022.html#data-vectors"><i class="fa fa-check"></i>Data vectors</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-september-1-2022.html"><a href="thursday-september-1-2022.html"><i class="fa fa-check"></i>Thursday, September 1, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-september-1-2022.html"><a href="thursday-september-1-2022.html#sample-statistics"><i class="fa fa-check"></i>Sample statistics</a></li>
<li class="chapter" data-level="" data-path="thursday-september-1-2022.html"><a href="thursday-september-1-2022.html#structured-data"><i class="fa fa-check"></i>Structured data</a></li>
<li class="chapter" data-level="" data-path="thursday-september-1-2022.html"><a href="thursday-september-1-2022.html#tables-and-summaries"><i class="fa fa-check"></i>Tables and summaries</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-september-6-2022.html"><a href="tuesday-september-6-2022.html"><i class="fa fa-check"></i>Tuesday, September 6, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-september-6-2022.html"><a href="tuesday-september-6-2022.html#getting-your-data-into-r"><i class="fa fa-check"></i>Getting your data into R</a></li>
<li class="chapter" data-level="" data-path="tuesday-september-6-2022.html"><a href="tuesday-september-6-2022.html#data-frames"><i class="fa fa-check"></i>Data frames</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-september-8-2022.html"><a href="thursday-september-8-2022.html"><i class="fa fa-check"></i>Thursday, September 8, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-september-8-2022.html"><a href="thursday-september-8-2022.html#using-pipes"><i class="fa fa-check"></i>Using pipes</a></li>
<li class="chapter" data-level="" data-path="thursday-september-8-2022.html"><a href="thursday-september-8-2022.html#wrangling-data-frames"><i class="fa fa-check"></i>Wrangling data frames</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-september-13-2022.html"><a href="tuesday-september-13-2022.html"><i class="fa fa-check"></i>Tuesday, September 13, 2022</a>
<ul>
<li class="chapter" data-level="0.1" data-path="tuesday-september-13-2022.html"><a href="tuesday-september-13-2022.html#data-munging-examples"><i class="fa fa-check"></i><b>0.1</b> Data munging examples</a></li>
<li class="chapter" data-level="" data-path="tuesday-september-13-2022.html"><a href="tuesday-september-13-2022.html#putting-things-together"><i class="fa fa-check"></i>Putting things together</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-september-15-2022.html"><a href="thursday-september-15-2022.html"><i class="fa fa-check"></i>Thursday, September 15, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-september-15-2022.html"><a href="thursday-september-15-2022.html#data-visualization"><i class="fa fa-check"></i>Data visualization</a></li>
<li class="chapter" data-level="" data-path="thursday-september-15-2022.html"><a href="thursday-september-15-2022.html#transforming-the-response-variable"><i class="fa fa-check"></i>Transforming the response variable</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-october-20-2022.html"><a href="thursday-october-20-2022.html"><i class="fa fa-check"></i>Thursday, October 20, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-october-20-2022.html"><a href="thursday-october-20-2022.html#more-regression-examples"><i class="fa fa-check"></i>More regression examples</a></li>
<li class="chapter" data-level="" data-path="thursday-october-20-2022.html"><a href="thursday-october-20-2022.html#outliers"><i class="fa fa-check"></i>Outliers</a></li>
<li class="chapter" data-level="" data-path="thursday-october-20-2022.html"><a href="thursday-october-20-2022.html#simpsons-paradox"><i class="fa fa-check"></i>Simpson’s paradox</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html"><i class="fa fa-check"></i>Tuesday, October 25, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#a-regression-plane"><i class="fa fa-check"></i>A regression plane</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#fitting-a-multiple-variable-regression-model"><i class="fa fa-check"></i>Fitting a multiple variable regression model</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#should-you-remove-a-variable-from-the-model"><i class="fa fa-check"></i>Should you remove a variable from the model?</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#checking-on-the-model-assumptions"><i class="fa fa-check"></i>Checking on the model assumptions</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#using-the-model-to-make-predictions"><i class="fa fa-check"></i>Using the model to make predictions</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#collinearity"><i class="fa fa-check"></i>Collinearity</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#interactions"><i class="fa fa-check"></i>Interactions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-october-27-2022.html"><a href="thursday-october-27-2022.html"><i class="fa fa-check"></i>Thursday, October 27, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-october-27-2022.html"><a href="thursday-october-27-2022.html#removing-variables-from-a-regression-model"><i class="fa fa-check"></i>Removing variables from a regression model</a></li>
<li class="chapter" data-level="" data-path="thursday-october-27-2022.html"><a href="thursday-october-27-2022.html#the-stepwise-selection-procedure"><i class="fa fa-check"></i>The stepwise selection procedure</a></li>
<li class="chapter" data-level="" data-path="thursday-october-27-2022.html"><a href="thursday-october-27-2022.html#transforming-a-response-variable"><i class="fa fa-check"></i>Transforming a response variable</a></li>
<li class="chapter" data-level="" data-path="thursday-october-27-2022.html"><a href="thursday-october-27-2022.html#regression-trees"><i class="fa fa-check"></i>Regression trees</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-november-1-2022.html"><a href="tuesday-november-1-2022.html"><i class="fa fa-check"></i>Tuesday, November 1, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-november-1-2022.html"><a href="tuesday-november-1-2022.html#predictive-uncertainty-with-regression-trees"><i class="fa fa-check"></i>Predictive uncertainty with regression trees</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-1-2022.html"><a href="tuesday-november-1-2022.html#the-random-forest-algorithm"><i class="fa fa-check"></i>The random forest algorithm</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-1-2022.html"><a href="tuesday-november-1-2022.html#cross-validation"><i class="fa fa-check"></i>Cross validation</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-1-2022.html"><a href="tuesday-november-1-2022.html#classification-trees"><i class="fa fa-check"></i>Classification trees</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-november-3-2022.html"><a href="thursday-november-3-2022.html"><i class="fa fa-check"></i>Thursday, November 3, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-november-3-2022.html"><a href="thursday-november-3-2022.html#binary-outcomes-and-probabilities"><i class="fa fa-check"></i>Binary outcomes and probabilities</a></li>
<li class="chapter" data-level="" data-path="thursday-november-3-2022.html"><a href="thursday-november-3-2022.html#logistic-regression"><i class="fa fa-check"></i>Logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html"><i class="fa fa-check"></i>Tuesday, November 8, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html#quantifying-autocorrelation-in-spatial-data"><i class="fa fa-check"></i>Quantifying autocorrelation in spatial data</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html#spatial-data-as-polygon-areas"><i class="fa fa-check"></i>Spatial data as polygon areas</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html#nearest-neighbors"><i class="fa fa-check"></i>Nearest neighbors</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html#spatial-weights"><i class="fa fa-check"></i>Spatial weights</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html#morans-i"><i class="fa fa-check"></i>Moran’s I</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html#spatial-lag-variable"><i class="fa fa-check"></i>Spatial lag variable</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-november-10-2022.html"><a href="thursday-november-10-2022.html"><i class="fa fa-check"></i>Thursday, November 10, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-november-10-2022.html"><a href="thursday-november-10-2022.html#statistical-significance-of-spatial-autocorrelation"><i class="fa fa-check"></i>Statistical significance of spatial autocorrelation</a></li>
<li class="chapter" data-level="" data-path="thursday-november-10-2022.html"><a href="thursday-november-10-2022.html#a-monte-carlo-approach-to-inference-about-spatial-autocorrelation"><i class="fa fa-check"></i>A Monte Carlo approach to inference about spatial autocorrelation</a></li>
<li class="chapter" data-level="" data-path="thursday-november-10-2022.html"><a href="thursday-november-10-2022.html#spatial-autocorrelation-in-model-residuals"><i class="fa fa-check"></i>Spatial autocorrelation in model residuals</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-november-15-2022.html"><a href="tuesday-november-15-2022.html"><i class="fa fa-check"></i>Tuesday, November 15, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-november-15-2022.html"><a href="tuesday-november-15-2022.html#bi-variate-spatial-autocorrelation"><i class="fa fa-check"></i>Bi-variate spatial autocorrelation</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-15-2022.html"><a href="tuesday-november-15-2022.html#local-autocorrelation"><i class="fa fa-check"></i>Local autocorrelation</a></li>
<li class="chapter" data-level="0.2" data-path="tuesday-november-15-2022.html"><a href="tuesday-november-15-2022.html#local-regression"><i class="fa fa-check"></i><b>0.2</b> Local regression</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-15-2022.html"><a href="tuesday-november-15-2022.html#spatial-weights-1"><i class="fa fa-check"></i>Spatial weights</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-november-17-2022.html"><a href="thursday-november-17-2022.html"><i class="fa fa-check"></i>Thursday, November 17, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-november-17-2022.html"><a href="thursday-november-17-2022.html#geographic-regression"><i class="fa fa-check"></i>Geographic regression</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GEO5156: Quantitative Geography</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="thursday-september-15-2022" class="section level1 unnumbered hasAnchor">
<h1>Thursday, September 15, 2022<a href="thursday-september-15-2022.html#thursday-september-15-2022" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Today</p>
<ul>
<li>Making graphs</li>
</ul>
<div id="data-visualization" class="section level2 unnumbered hasAnchor">
<h2>Data visualization<a href="thursday-september-15-2022.html#data-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Data visualization is a cornerstone of data science. It gives insights into your data that are not accessible by looking at a spreadsheet or data frame of values.</p>
<p>The {ggplot2} package provides functions to make plots efficiently. The functions are an application of the grammar of graphics theory (Leland Wilkinson) of data visualization.</p>
<p>At a basic level, graphics/plots/charts (all interchangeable terms) provide a way to explore the patterns in data; the presence of extreme values, distributions of individual variables, and relationships between groups of variables.</p>
<p>Graphics should emphasize the findings and insights you want your audience to understand. This requires a balance.</p>
<p>On the one hand, you want to highlight as many interesting findings as possible. On the other hand, you don’t want to include so much information that it overwhelms the audience.</p>
<p>The grammar of graphics specifies how a plot translates data to attributes and geometric objects.
- Attributes are things like location on along an axes, color, shape, and size.
- Geometric objects are things like points, lines, bars, and polygons.</p>
<p>The type of plot depends on the geometric object, which is specified as a function.</p>
<p>Function names for geometric objects begin with <code>geom_</code>. For example, to create a scatter plot of points the <code>geom_point()</code> function is used.</p>
<p>Make the functions from the {ggplot2} package available in your current session.</p>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="thursday-september-15-2022.html#cb520-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<p>Bar chart</p>
<p>A simple graph is the bar chart showing the number of cases within each group. Consider again the annual hurricane counts.</p>
<p>Import the data from the file on my website and print the first six rows.</p>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="thursday-september-15-2022.html#cb521-1" aria-hidden="true" tabindex="-1"></a>loc <span class="ot">&lt;-</span> <span class="st">&quot;http://myweb.fsu.edu/jelsner/temp/data/US.txt&quot;</span></span>
<span id="cb521-2"><a href="thursday-september-15-2022.html#cb521-2" aria-hidden="true" tabindex="-1"></a>LH.df <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_table</span>(loc)</span></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   Year = col_double(),
##   All = col_double(),
##   MUS = col_double(),
##   G = col_double(),
##   FL = col_double(),
##   E = col_double()
## )</code></pre>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="thursday-september-15-2022.html#cb523-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(LH.df)</span></code></pre></div>
<pre><code>## Rows: 166
## Columns: 6
## $ Year &lt;dbl&gt; 1851, 1852, 1853, 1854, 1855, 1856, 1857, 1858, 1859, 1860, 1861,…
## $ All  &lt;dbl&gt; 1, 3, 0, 2, 1, 2, 1, 1, 1, 3, 2, 0, 0, 0, 2, 1, 1, 0, 4, 2, 3, 0,…
## $ MUS  &lt;dbl&gt; 1, 1, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ G    &lt;dbl&gt; 0, 1, 0, 1, 1, 1, 0, 0, 1, 3, 0, 0, 0, 0, 1, 1, 1, 0, 2, 1, 0, 0,…
## $ FL   &lt;dbl&gt; 1, 2, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 2, 0,…
## $ E    &lt;dbl&gt; 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 2, 0, 1, 0,…</code></pre>
<p>Recall that each case is a year and that the function <code>table()</code> returns the number of years for each landfall count.</p>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="thursday-september-15-2022.html#cb525-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(LH.df<span class="sc">$</span>All)</span></code></pre></div>
<pre><code>## 
##  0  1  2  3  4  5  6  7 
## 36 50 40 27  6  1  5  1</code></pre>
<p>The number of cases for each count is tallied and displayed below the count. There were 36 cases of 0 hurricanes.</p>
<p>The function <code>geom_bar()</code> creates a bar chart of this frequency table.</p>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="thursday-september-15-2022.html#cb527-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> LH.df) <span class="sc">+</span> </span>
<span id="cb527-2"><a href="thursday-september-15-2022.html#cb527-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> All))</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-216-1.png" width="672" /></p>
<p>You begin a plot with the function <code>ggplot()</code> that creates a coordinate system that you add layers to. The first argument of <code>ggplot()</code> is the data frame to use in the graph. So <code>ggplot(data = LH.df)</code> creates an empty graph.</p>
<p>You complete the graph by adding one or more layers. The function <code>geom_bar()</code> adds a layer of bars to our plot, which creates a bar chart.</p>
<p>Each <code>geom_</code> function takes a mapping argument. This defines how variables in our data frame are mapped to visual properties. The mapping argument is always paired with <code>aes()</code> function, and the <code>x</code> argument of <code>aes()</code> specifies which variables to map to the x axes, in this case <code>All</code>. <code>ggplot()</code> looks for the mapped variable in the data argument, in this case, <code>LH.df</code>.</p>
<p>The function <code>geom_bar()</code> tables the counts and then maps the number of cases to bars with the bar height proportional to the number of cases. Here the number of cases is the number of years with that many hurricanes.</p>
<p>The functions are applied in order (<code>ggplot()</code> comes before <code>geom_bar()</code>) and are linked with the addition <code>+</code> symbol. In this way you can think of the functions as layers in a GIS.</p>
<p>The bar chart contains the same information as displayed by the function <code>table()</code>. The y-axis label is ‘count’ and x-axis label is the column name.</p>
<p>Repeat this time using Florida hurricane counts. The annual number of Florida hurricanes by year is given in column <code>FL</code> in the data frame <code>LH.df</code>.</p>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="thursday-september-15-2022.html#cb528-1" aria-hidden="true" tabindex="-1"></a>LH.df<span class="sc">$</span>FL</span></code></pre></div>
<pre><code>##   [1] 1 2 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 1 2 0 2 1 0 1 2 1 0 3 0 2 0 0 0 3 1
##  [38] 2 0 0 0 0 1 2 0 3 1 1 1 0 1 0 1 0 0 2 0 0 1 1 1 0 0 0 1 2 1 0 1 0 1 0 0 2
##  [75] 1 2 0 2 1 0 0 0 2 2 2 1 0 0 1 0 1 2 0 1 2 1 2 2 1 2 0 0 1 0 0 1 0 0 0 1 0
## [112] 0 0 3 1 2 1 1 0 0 0 1 0 0 1 0 0 0 1 0 0 0 0 0 2 0 1 0 1 0 0 1 0 0 2 0 0 2
## [149] 1 0 0 0 0 4 3 0 0 0 0 0 0 0 0 0 0 1</code></pre>
<p>The <code>geom_bar()</code> function tables these numbers and plots the frequency as a bar.</p>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="thursday-september-15-2022.html#cb530-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> LH.df) <span class="sc">+</span> </span>
<span id="cb530-2"><a href="thursday-september-15-2022.html#cb530-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> FL)) <span class="sc">+</span></span>
<span id="cb530-3"><a href="thursday-september-15-2022.html#cb530-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Number of Florida Hurricanes (1851-2016)&quot;</span>) <span class="sc">+</span></span>
<span id="cb530-4"><a href="thursday-september-15-2022.html#cb530-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Number of Years&quot;</span>)</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-218-1.png" width="672" /></p>
<p>Here axes labels are placed on the plot with the functions <code>ylab()</code> and <code>xlab()</code>. With this type of ‘layering’ it’s easy to go from data on the web to a publishable plot.</p>
<p>Pie preference</p>
<p>Thirty graduate students are surveyed about their favor pie. Categories are (1) chocolate cream, (2) coconut custard, (3) georgia peach, and (4) strawberry. To make a bar chart first create the data as a character vector and then change the vector to a data frame.</p>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="thursday-september-15-2022.html#cb531-1" aria-hidden="true" tabindex="-1"></a>pie <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&#39;chocolate cream&#39;</span>, <span class="at">times =</span> <span class="dv">4</span>), </span>
<span id="cb531-2"><a href="thursday-september-15-2022.html#cb531-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">rep</span>(<span class="st">&#39;coconut custard&#39;</span>, <span class="at">times =</span>  <span class="dv">12</span>), </span>
<span id="cb531-3"><a href="thursday-september-15-2022.html#cb531-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">rep</span>(<span class="st">&#39;georgia peach&#39;</span>, <span class="at">times =</span>  <span class="dv">5</span>), </span>
<span id="cb531-4"><a href="thursday-september-15-2022.html#cb531-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">rep</span>(<span class="st">&#39;strawberry&#39;</span>, <span class="at">times =</span>  <span class="dv">9</span>))</span>
<span id="cb531-5"><a href="thursday-september-15-2022.html#cb531-5" aria-hidden="true" tabindex="-1"></a>piePref.df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pie)</span></code></pre></div>
<p>Use the function <code>str()</code> to see the column type in the data frame.</p>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="thursday-september-15-2022.html#cb532-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(piePref.df)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    30 obs. of  1 variable:
##  $ pie: chr  &quot;chocolate cream&quot; &quot;chocolate cream&quot; &quot;chocolate cream&quot; &quot;chocolate cream&quot; ...</code></pre>
<p>There is a single column in the data frame with the name <code>pie</code>. It is a factor variable with 4 levels one for each type of pie. A factor is a categorical vector. It looks like a character but it can be ordered. This is important when factors are used in statistical models.</p>
<p>Create a table.</p>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="thursday-september-15-2022.html#cb534-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(piePref.df<span class="sc">$</span>pie)</span></code></pre></div>
<pre><code>## 
## chocolate cream coconut custard   georgia peach      strawberry 
##               4              12               5               9</code></pre>
<p>Create a bar chart and specify the axis labels.</p>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="thursday-september-15-2022.html#cb536-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> piePref.df) <span class="sc">+</span> </span>
<span id="cb536-2"><a href="thursday-september-15-2022.html#cb536-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pie)) <span class="sc">+</span></span>
<span id="cb536-3"><a href="thursday-september-15-2022.html#cb536-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Pie Preference&quot;</span>) <span class="sc">+</span> </span>
<span id="cb536-4"><a href="thursday-september-15-2022.html#cb536-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Number of Students&quot;</span>)</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-222-1.png" width="672" /></p>
<p>This is a good start. Improvements should be made.</p>
<p>First, the bar order is alphabetical from left to right. This is the default ordering for character vectors or for factor variables created from character vectors. It is much easier to make comparisons if frequency determines the order.</p>
<p>To change the order on the bar chart specify the order of the factor levels on the vector beer.</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="thursday-september-15-2022.html#cb537-1" aria-hidden="true" tabindex="-1"></a>pie <span class="ot">&lt;-</span> <span class="fu">factor</span>(pie, </span>
<span id="cb537-2"><a href="thursday-september-15-2022.html#cb537-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;coconut custard&quot;</span>, <span class="st">&quot;strawberry&quot;</span>, <span class="st">&quot;georgia peach&quot;</span>, <span class="st">&quot;chocolate cream&quot;</span>))</span>
<span id="cb537-3"><a href="thursday-september-15-2022.html#cb537-3" aria-hidden="true" tabindex="-1"></a>piePref.df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pie)</span></code></pre></div>
<p>Or use <code>forcats::fct_infreq()</code> <a href="https://forcats.tidyverse.org/reference/fct_inorder.html" class="uri">https://forcats.tidyverse.org/reference/fct_inorder.html</a></p>
<p>Now remake the bar chart.</p>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="thursday-september-15-2022.html#cb538-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> piePref.df) <span class="sc">+</span> </span>
<span id="cb538-2"><a href="thursday-september-15-2022.html#cb538-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(pie)) <span class="sc">+</span></span>
<span id="cb538-3"><a href="thursday-september-15-2022.html#cb538-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Pie Preference&quot;</span>) <span class="sc">+</span> </span>
<span id="cb538-4"><a href="thursday-september-15-2022.html#cb538-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Number of Students&quot;</span>)</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-224-1.png" width="672" /></p>
<p>Second, the vertical axis tic labels are fractions. Since the bar heights are counts (integers) the tic labels also should be integers.</p>
<p>To override this default you add a new y-axis layer. The layer is the function <code>scale_y_continuous()</code> where you indicate the lower and upper limits of the axis with the concatenate (<code>limits = c()</code>) function. Now remake the bar chart.</p>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="thursday-september-15-2022.html#cb539-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> piePref.df) <span class="sc">+</span> </span>
<span id="cb539-2"><a href="thursday-september-15-2022.html#cb539-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(pie)) <span class="sc">+</span></span>
<span id="cb539-3"><a href="thursday-september-15-2022.html#cb539-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Beer Preference&quot;</span>) <span class="sc">+</span> </span>
<span id="cb539-4"><a href="thursday-september-15-2022.html#cb539-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Number of Students&quot;</span>) <span class="sc">+</span></span>
<span id="cb539-5"><a href="thursday-september-15-2022.html#cb539-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>))</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-225-1.png" width="672" /></p>
<p>Now the chart is publishable. Options exist for changing the look of the plot for digital media include, colors, orientation, background, etc.</p>
<p>For example to change the bar color use the <code>fill =</code> argument in the function <code>geom_bar()</code>. To change the orientation of the bars use the layer function <code>coord_flip</code>, and to change the background use the layer function <code>theme_minimal()</code>. You make changes to the look of the plot with additional layers.</p>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb540-1"><a href="thursday-september-15-2022.html#cb540-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> piePref.df) <span class="sc">+</span> </span>
<span id="cb540-2"><a href="thursday-september-15-2022.html#cb540-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pie), <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb540-3"><a href="thursday-september-15-2022.html#cb540-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Pie Preference&quot;</span>) <span class="sc">+</span> </span>
<span id="cb540-4"><a href="thursday-september-15-2022.html#cb540-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Number of Students&quot;</span>) <span class="sc">+</span></span>
<span id="cb540-5"><a href="thursday-september-15-2022.html#cb540-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb540-6"><a href="thursday-september-15-2022.html#cb540-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb540-7"><a href="thursday-september-15-2022.html#cb540-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-226-1.png" width="672" /></p>
<p>Recall: the <code>fill =</code> is used on the variable named in the <code>aes()</code> function but it is specified outside the <code>aes()</code> function.</p>
<p>Available colors include</p>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="thursday-september-15-2022.html#cb541-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colors</span>()</span></code></pre></div>
<p>In the above example you manually reordered the levels in the factor vector <code>pie</code> according to preference. Let’s see how to do this automatically.</p>
<p>Consider storm intensity of tropical cyclones during 2017. First create two vectors one numeric containing the minimum pressures (millibars) and the other character containing the storm names.</p>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="thursday-september-15-2022.html#cb542-1" aria-hidden="true" tabindex="-1"></a>minP <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">990</span>, <span class="dv">1007</span>, <span class="dv">992</span>, <span class="dv">1007</span>, <span class="dv">1005</span>, <span class="dv">981</span>, <span class="dv">967</span>, <span class="dv">938</span>, <span class="dv">914</span>, <span class="dv">938</span>, <span class="dv">972</span>, <span class="dv">971</span>)</span>
<span id="cb542-2"><a href="thursday-september-15-2022.html#cb542-2" aria-hidden="true" tabindex="-1"></a>name <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Arlene&quot;</span>, <span class="st">&quot;Bret&quot;</span>, <span class="st">&quot;Cindy&quot;</span>, <span class="st">&quot;Don&quot;</span>, <span class="st">&quot;Emily&quot;</span>, <span class="st">&quot;Franklin&quot;</span>, <span class="st">&quot;Gert&quot;</span>, </span>
<span id="cb542-3"><a href="thursday-september-15-2022.html#cb542-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;Harvey&quot;</span>, <span class="st">&quot;Irma&quot;</span>, <span class="st">&quot;Jose&quot;</span>, <span class="st">&quot;Katia&quot;</span>, <span class="st">&quot;Lee&quot;</span>)</span></code></pre></div>
<p>The function <code>reorder()</code> takes a character vector as the first argument and returns an ordered factor with the order dictated by the numeric values in the second argument.</p>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="thursday-september-15-2022.html#cb543-1" aria-hidden="true" tabindex="-1"></a><span class="fu">reorder</span>(name, minP)</span></code></pre></div>
<pre><code>##  [1] Arlene   Bret     Cindy    Don      Emily    Franklin Gert     Harvey  
##  [9] Irma     Jose     Katia    Lee     
## attr(,&quot;scores&quot;)
##   Arlene     Bret    Cindy      Don    Emily Franklin     Gert   Harvey 
##      990     1007      992     1007     1005      981      967      938 
##     Irma     Jose    Katia      Lee 
##      914      938      972      971 
## 12 Levels: Irma Harvey Jose Gert Lee Katia Franklin Arlene Cindy Emily ... Don</code></pre>
<p>The vector <code>name</code> is in alphabetically order but the factor levels indicate the order of storms from lowest pressure (Irma) to highest pressure (Don).</p>
<p>Using the <code>mutate()</code> function you can add a column to a data frame where the column is an ordered factor.</p>
<p>Note that it is the difference in pressure (<code>deltaP</code> for short) between the air outside the tropical cyclone and the air in the center that causes the winds. Cyclones with a large pressure difference are stronger in terms of their wind speed.</p>
<p>Typically the air outside is about 1014 mb so you compute <code>deltaP</code> and then reorder the tropical cyclone names using this computed variable.</p>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="thursday-september-15-2022.html#cb545-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(name, minP) <span class="sc">|&gt;</span></span>
<span id="cb545-2"><a href="thursday-september-15-2022.html#cb545-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">deltaP =</span> <span class="dv">1014</span> <span class="sc">-</span> minP,</span>
<span id="cb545-3"><a href="thursday-september-15-2022.html#cb545-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">nameOrderedFactor =</span> <span class="fu">reorder</span>(name, deltaP))</span></code></pre></div>
<p>Finally you plot the bar chart. Since there is no tabulation of the values you use <code>geom_col()</code> instead of <code>geom_bar()</code>.</p>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="thursday-september-15-2022.html#cb546-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df) <span class="sc">+</span> </span>
<span id="cb546-2"><a href="thursday-september-15-2022.html#cb546-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> nameOrderedFactor, <span class="at">y =</span> deltaP)) <span class="sc">+</span></span>
<span id="cb546-3"><a href="thursday-september-15-2022.html#cb546-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Pressure Difference [mb]&quot;</span>) <span class="sc">+</span></span>
<span id="cb546-4"><a href="thursday-september-15-2022.html#cb546-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Atlantic Tropical Cyclones of 2017&quot;</span>) <span class="sc">+</span></span>
<span id="cb546-5"><a href="thursday-september-15-2022.html#cb546-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-231-1.png" width="672" /></p>
<p>Note: <code>geom_bar()</code> plots a bar chart AFTER tabulating a column. <code>geom_col()</code> plots a bar chart on a pre-tabulated column.</p>
<p>Let’s return to the weather data from Tallahassee.</p>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="thursday-september-15-2022.html#cb547-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">&quot;data/TLH_SOD1892.csv&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb547-2"><a href="thursday-september-15-2022.html#cb547-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(STATION <span class="sc">==</span> <span class="st">&quot;USW00093805&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb547-3"><a href="thursday-september-15-2022.html#cb547-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(DATE),</span>
<span id="cb547-4"><a href="thursday-september-15-2022.html#cb547-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Month =</span> lubridate<span class="sc">::</span><span class="fu">month</span>(DATE)) <span class="sc">|&gt;</span></span>
<span id="cb547-5"><a href="thursday-september-15-2022.html#cb547-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Year <span class="sc">&gt;=</span> <span class="dv">1980</span> <span class="sc">&amp;</span> Month <span class="sc">==</span> <span class="dv">9</span>) <span class="sc">|&gt;</span></span>
<span id="cb547-6"><a href="thursday-september-15-2022.html#cb547-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Year) <span class="sc">|&gt;</span></span>
<span id="cb547-7"><a href="thursday-september-15-2022.html#cb547-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">TotalPrecip =</span> <span class="fu">sum</span>(PRCP)) <span class="sc">|&gt;</span></span>
<span id="cb547-8"><a href="thursday-september-15-2022.html#cb547-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">reorder</span>(<span class="fu">as.factor</span>(Year), TotalPrecip))</span></code></pre></div>
<pre><code>## Rows: 47056 Columns: 13
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr   (2): STATION, NAME
## dbl  (10): LATITUDE, LONGITUDE, ELEVATION, PRCP, TAVG, TMAX, TMIN, WDF1, WSF...
## date  (1): DATE
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="thursday-september-15-2022.html#cb549-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df) <span class="sc">+</span> </span>
<span id="cb549-2"><a href="thursday-september-15-2022.html#cb549-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> TotalPrecip)) <span class="sc">+</span></span>
<span id="cb549-3"><a href="thursday-september-15-2022.html#cb549-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;September Rainfall [in]&quot;</span>) <span class="sc">+</span></span>
<span id="cb549-4"><a href="thursday-september-15-2022.html#cb549-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-232-1.png" width="672" /></p>
<p>Histogram</p>
<p>The histogram is similar to the bar chart except it uses bars to indicate frequency (or proportion) over an interval of continuous values. For instance, with continuous values the function <code>table()</code> is not useful.</p>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="thursday-september-15-2022.html#cb550-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">10</span>)</span>
<span id="cb550-2"><a href="thursday-september-15-2022.html#cb550-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(x)</span></code></pre></div>
<pre><code>## x
##    -1.6032276455739   -1.21105005355005  -0.930597500697453  -0.659731635004227 
##                   1                   1                   1                   1 
##  -0.638249710440162  -0.499239870677882 -0.0277773938058075   0.277103773302114 
##                   1                   1                   1                   1 
##   0.526728668221472   0.545780025214686 
##                   1                   1</code></pre>
<p>So neither is a bar plot.</p>
<p>A histogram is made as follows: First a collection of disjoint intervals, called bins, covering the range of data points is chosen. “Disjoint” means no overlap, so the intervals look like (a,b] or [a,b). The interval (a,b] means the interval contains all the values from a to b including b but not a, whereas the interval [a,b) means the interval contains all the values from a to b including a but not b.]. Greater than 3.98 (indicated by <code>(</code>) and less than or equal to 8.2 (indicated by <code>]</code>). And so on.</p>
<p>You include these cuts as a ordered factor variable to the original <code>cars</code> data frame.</p>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="thursday-september-15-2022.html#cb552-1" aria-hidden="true" tabindex="-1"></a>cars <span class="ot">&lt;-</span> cars <span class="sc">|&gt;</span></span>
<span id="cb552-2"><a href="thursday-september-15-2022.html#cb552-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">x_bins =</span> <span class="fu">cut</span>(speed, <span class="at">breaks =</span> <span class="dv">5</span>))</span></code></pre></div>
<p>You then map the <code>x_bins</code> variable to the x aesthetic and draw box plots.</p>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="thursday-september-15-2022.html#cb553-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> cars, </span>
<span id="cb553-2"><a href="thursday-september-15-2022.html#cb553-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x_bins, <span class="at">y =</span> dist)) <span class="sc">+</span> </span>
<span id="cb553-3"><a href="thursday-september-15-2022.html#cb553-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb553-4"><a href="thursday-september-15-2022.html#cb553-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Speed (mph)&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Breaking distance (ft)&quot;</span>)</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-530-1.png" width="672" /></p>
<p>By binning the explanatory variable you create sub-samples of the data. A sample of response values within a given interval of the explanatory variable. The number of intervals is the number of breaks specified by the <code>cut()</code> function.</p>
<p>Here you see evidence against the assumption of linearity. Further you see that the box size is increasing. That is the IQR range of breaking distance (depth of the box) is larger for faster moving cars. This creates doubt that the assumption of constant variance is valid.</p>
<p>What about the assumption of normality? Although the normality assumption about the residuals is that the <em>conditional</em> distribution of the residuals at each <span class="math inline">\(x_i\)</span> is adequately described by a normal distribution, in practice the residuals are examined together. The residuals are obtained by using the <code>resid()</code> function.</p>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="thursday-september-15-2022.html#cb554-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">resid</span>(model1)</span>
<span id="cb554-2"><a href="thursday-september-15-2022.html#cb554-2" aria-hidden="true" tabindex="-1"></a>res</span></code></pre></div>
<pre><code>##          1          2          3          4          5          6          7 
##   3.849460  11.849460  -5.947766  12.052234   2.119825  -7.812584  -3.744993 
##          8          9         10         11         12         13         14 
##   4.255007  12.255007  -8.677401   2.322599 -15.609810  -9.609810  -5.609810 
##         15         16         17         18         19         20         21 
##  -1.609810  -7.542219   0.457781   0.457781  12.457781 -11.474628  -1.474628 
##         22         23         24         25         26         27         28 
##  22.525372  42.525372 -21.407036 -15.407036  12.592964 -13.339445  -5.339445 
##         29         30         31         32         33         34         35 
## -17.271854  -9.271854   0.728146 -11.204263   2.795737  22.795737  30.795737 
##         36         37         38         39         40         41         42 
## -21.136672 -11.136672  10.863328 -29.069080 -13.069080  -9.069080  -5.069080 
##         43         44         45         46         47         48         49 
##   2.930920  -2.933898 -18.866307  -6.798715  15.201285  16.201285  43.201285 
##         50 
##   4.268876</code></pre>
<p>There are other extractor functions (like <code>coef()</code>) that output information from the model as vectors or matrices.</p>
<p>The <code>fortify()</code> function from the {ggplot2} package makes a data frame from the model object using several extractor functions.</p>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="thursday-september-15-2022.html#cb556-1" aria-hidden="true" tabindex="-1"></a>model.df <span class="ot">&lt;-</span> <span class="fu">fortify</span>(model1)</span>
<span id="cb556-2"><a href="thursday-september-15-2022.html#cb556-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(model.df)</span></code></pre></div>
<pre><code>##   dist speed       .hat   .sigma      .cooksd   .fitted    .resid  .stdresid
## 1    2     4 0.11486131 15.53088 0.0045923121 -1.849460  3.849460  0.2660415
## 2   10     4 0.11486131 15.43338 0.0435139907 -1.849460 11.849460  0.8189327
## 3    4     7 0.07150365 15.51624 0.0062023503  9.947766 -5.947766 -0.4013462
## 4   22     7 0.07150365 15.43489 0.0254673384  9.947766 12.052234  0.8132663
## 5   16     8 0.05997080 15.53907 0.0006446705 13.880175  2.119825  0.1421624
## 6   10     9 0.04989781 15.49830 0.0071319931 17.812584 -7.812584 -0.5211526</code></pre>
<p>The data frame resulting from the <code>fortify()</code> function has a column labeled <code>.resid</code> containing the vector of residuals. The residuals are the observed distance minus the predicted (fitted) distance (<code>dist</code> column minus <code>.fitted</code> column).</p>
<p>Create a histogram and density of the model’s residuals by typing</p>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="thursday-september-15-2022.html#cb558-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> model.df, </span>
<span id="cb558-2"><a href="thursday-september-15-2022.html#cb558-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(.resid)) <span class="sc">+</span></span>
<span id="cb558-3"><a href="thursday-september-15-2022.html#cb558-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb558-4"><a href="thursday-september-15-2022.html#cb558-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_freqpoly</span>(<span class="at">bins =</span> <span class="dv">8</span>)</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-533-1.png" width="672" /></p>
<p>You can see that the histogram is not symmetric. There are more values to the right of the central set of values than to the left. The validity of the normality assumption is therefore under question.</p>
<p>Since departures from normality can occur simply because of sampling variation, the question arises as to whether that apparent skewness (asymmetry) you see in this set of residuals is significantly larger than expected by chance.</p>
<p>One approach to visualizing the expected variation from a reference distribution is to add an uncertainty band on the density plot.</p>
<p>The <code>sm.density()</code> function from the {sm} package provides a way to plot the uncertainty band. The first argument is a vector of residuals and the argument <code>model = "Normal"</code> draws a band around a normal distribution centered on zero with a variance equal to the variance of the residuals.</p>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="thursday-september-15-2022.html#cb559-1" aria-hidden="true" tabindex="-1"></a>sm<span class="sc">::</span><span class="fu">sm.density</span>(res, <span class="at">model =</span> <span class="st">&quot;Normal&quot;</span>)</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-534-1.png" width="672" /></p>
<p>The black curve representing the residuals is shifted left relative to a normal density and goes outside the blue ribbon in the right tail indicating that the residuals may not be adequately described by a normal distribution although deviation from normality is small.</p>
<p>The blue ribbon is the uncertainty surrounding a normal density curve.</p>
<p>In summary, the linear regression model may not be adequate. The assumptions of linearity, equal variance, and normally distributed residuals are not entirely reasonable for these data.</p>
<p>What should you do? The relationship appears to be non-linear. So you use the square root of the breaking distance as the response variable instead.</p>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="thursday-september-15-2022.html#cb560-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> cars, </span>
<span id="cb560-2"><a href="thursday-september-15-2022.html#cb560-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> speed, <span class="at">y =</span> <span class="fu">sqrt</span>(dist))) <span class="sc">+</span> </span>
<span id="cb560-3"><a href="thursday-september-15-2022.html#cb560-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb560-4"><a href="thursday-september-15-2022.html#cb560-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb560-5"><a href="thursday-september-15-2022.html#cb560-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Speed (mph)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb560-6"><a href="thursday-september-15-2022.html#cb560-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">sqrt</span>(<span class="st">&quot;Break Distance (ft)&quot;</span>)))</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-535-1.png" width="672" /></p>
<p>Fit another model. First make a copy of the original data frame and add a column called <code>distSR</code>. Check the assumption of linearity.</p>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="thursday-september-15-2022.html#cb562-1" aria-hidden="true" tabindex="-1"></a>cars2 <span class="ot">&lt;-</span> cars</span>
<span id="cb562-2"><a href="thursday-september-15-2022.html#cb562-2" aria-hidden="true" tabindex="-1"></a>cars2<span class="sc">$</span>distSR <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(cars<span class="sc">$</span>dist)</span>
<span id="cb562-3"><a href="thursday-september-15-2022.html#cb562-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb562-4"><a href="thursday-september-15-2022.html#cb562-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> cars2, </span>
<span id="cb562-5"><a href="thursday-september-15-2022.html#cb562-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">cut</span>(speed, <span class="at">breaks =</span> <span class="dv">5</span>), <span class="at">y =</span> distSR)) <span class="sc">+</span> </span>
<span id="cb562-6"><a href="thursday-september-15-2022.html#cb562-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb562-7"><a href="thursday-september-15-2022.html#cb562-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Speed (mph)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb562-8"><a href="thursday-september-15-2022.html#cb562-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Square Root of Break Distance (ft)&quot;</span>)</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-536-1.png" width="672" /></p>
<p>It looks good.</p>
<p>Fit the new model and extract and make a histogram of the residuals.</p>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="thursday-september-15-2022.html#cb563-1" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(distSR <span class="sc">~</span> speed, <span class="at">data =</span> cars2)</span>
<span id="cb563-2"><a href="thursday-september-15-2022.html#cb563-2" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">resid</span>(model2)</span>
<span id="cb563-3"><a href="thursday-september-15-2022.html#cb563-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb563-4"><a href="thursday-september-15-2022.html#cb563-4" aria-hidden="true" tabindex="-1"></a>model2.df <span class="ot">=</span> <span class="fu">fortify</span>(model2)</span>
<span id="cb563-5"><a href="thursday-september-15-2022.html#cb563-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> model2.df, </span>
<span id="cb563-6"><a href="thursday-september-15-2022.html#cb563-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(.resid)) <span class="sc">+</span></span>
<span id="cb563-7"><a href="thursday-september-15-2022.html#cb563-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb563-8"><a href="thursday-september-15-2022.html#cb563-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_freqpoly</span>(<span class="at">bins =</span> <span class="dv">8</span>)</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-537-1.png" width="672" /></p>
<p>Distribution of residuals is still skewed but it is better. In fact now the black line is completely inside the uncertainty ribbon of a normal density plot.</p>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="thursday-september-15-2022.html#cb564-1" aria-hidden="true" tabindex="-1"></a>sm<span class="sc">::</span><span class="fu">sm.density</span>(res2, <span class="at">model =</span> <span class="st">&quot;Normal&quot;</span>)</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-538-1.png" width="672" /></p>
</div>
<div id="transforming-the-response-variable" class="section level2 unnumbered hasAnchor">
<h2>Transforming the response variable<a href="thursday-september-15-2022.html#transforming-the-response-variable" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The cars example uses a square-root transformation of the response variable. This is appropriate when the response variable has a physical connection to the explanatory variable (e.g., timber volume as a response variable to tree diameter at breast height).</p>
<ul>
<li><p>Limitations</p>
<ul>
<li>Cannot be applied to negative numbers</li>
<li>Transforms numbers &lt; 1 and &gt; 1 in different ways</li>
</ul></li>
</ul>
<p>A more common situation is to take logarithms (natural or common) of the response variable.</p>
<ul>
<li><p>Appropriate</p>
<ul>
<li>When the SD of the residuals is directly proportional to the fitted values (and not to some power of the fitted values)</li>
<li>When the relationship is close to exponential</li>
</ul></li>
<li><p>Limitations</p>
<ul>
<li>How to transform zero values? Add a constant such as 1 or 0.00001 or remove zero values from analysis (not recommended)</li>
</ul></li>
</ul>
<p>Family of transformations</p>
<ul>
<li>Box-Cox (Power) Transformation
<ul>
<li>More about this later</li>
</ul></li>
</ul>
<p>If your response variable is counts (e.g., the number of hurricanes in a season) then it is better to use a generalized linear regression model than to transform the counts to normality.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tuesday-september-13-2022.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="thursday-october-20-2022.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
