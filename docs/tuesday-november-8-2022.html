<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Tuesday, November 8, 2022 | GEO5156: Quantitative Geography</title>
  <meta name="description" content="Tuesday, November 8, 2022 | GEO5156: Quantitative Geography" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Tuesday, November 8, 2022 | GEO5156: Quantitative Geography" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="jelsner/QG-2022" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Tuesday, November 8, 2022 | GEO5156: Quantitative Geography" />
  
  
  

<meta name="author" content="James B. Elsner" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="thursday-november-3-2022.html"/>
<link rel="next" href="thursday-november-10-2022.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Quantitative Geography</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html"><i class="fa fa-check"></i>Syllabus</a>
<ul>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#geo5165c-quantitative-geography"><i class="fa fa-check"></i>GEO5165C: Quantitative Geography</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#contact-information"><i class="fa fa-check"></i>Contact information</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#course-description"><i class="fa fa-check"></i>Course description</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#grades"><i class="fa fa-check"></i>Grades</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#ethics"><i class="fa fa-check"></i>Ethics</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#schedule-subject-to-change-with-notice"><i class="fa fa-check"></i>Schedule (subject to change with notice)</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#deeper-dives"><i class="fa fa-check"></i>Deeper dives</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html"><i class="fa fa-check"></i>Tuesday, August 23, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#what-is-this-course"><i class="fa fa-check"></i>What is this course?</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#where-are-the-materials-for-this-course"><i class="fa fa-check"></i>Where are the materials for this course?</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#syllabus-1"><i class="fa fa-check"></i>Syllabus</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#getting-setup"><i class="fa fa-check"></i>Getting setup</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#rstudios-integrated-development-environment-ide"><i class="fa fa-check"></i>RStudioâ€™s integrated development environment (IDE)</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#example-tallahassee-daily-temperatures"><i class="fa fa-check"></i>Example: Tallahassee daily temperatures</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-august-25-2022.html"><a href="thursday-august-25-2022.html"><i class="fa fa-check"></i>Thursday, August 25, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-august-25-2022.html"><a href="thursday-august-25-2022.html#data-science"><i class="fa fa-check"></i>Data science</a></li>
<li class="chapter" data-level="" data-path="thursday-august-25-2022.html"><a href="thursday-august-25-2022.html#structure-of-markdown-files"><i class="fa fa-check"></i>Structure of markdown files</a></li>
<li class="chapter" data-level="" data-path="thursday-august-25-2022.html"><a href="thursday-august-25-2022.html#how-to-make-a-plot"><i class="fa fa-check"></i>How to make a plot</a></li>
<li class="chapter" data-level="" data-path="thursday-august-25-2022.html"><a href="thursday-august-25-2022.html#getting-started-using-r"><i class="fa fa-check"></i>Getting started using R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-august-30-2022.html"><a href="tuesday-august-30-2022.html"><i class="fa fa-check"></i>Tuesday, August 30, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-august-30-2022.html"><a href="tuesday-august-30-2022.html#graphing-examples"><i class="fa fa-check"></i>Graphing examples</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-30-2022.html"><a href="tuesday-august-30-2022.html#working-with-r"><i class="fa fa-check"></i>Working with R</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-30-2022.html"><a href="tuesday-august-30-2022.html#data-vectors"><i class="fa fa-check"></i>Data vectors</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-september-1-2022.html"><a href="thursday-september-1-2022.html"><i class="fa fa-check"></i>Thursday, September 1, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-september-1-2022.html"><a href="thursday-september-1-2022.html#sample-statistics"><i class="fa fa-check"></i>Sample statistics</a></li>
<li class="chapter" data-level="" data-path="thursday-september-1-2022.html"><a href="thursday-september-1-2022.html#structured-data"><i class="fa fa-check"></i>Structured data</a></li>
<li class="chapter" data-level="" data-path="thursday-september-1-2022.html"><a href="thursday-september-1-2022.html#tables-and-summaries"><i class="fa fa-check"></i>Tables and summaries</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-september-6-2022.html"><a href="tuesday-september-6-2022.html"><i class="fa fa-check"></i>Tuesday, September 6, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-september-6-2022.html"><a href="tuesday-september-6-2022.html#getting-your-data-into-r"><i class="fa fa-check"></i>Getting your data into R</a></li>
<li class="chapter" data-level="" data-path="tuesday-september-6-2022.html"><a href="tuesday-september-6-2022.html#data-frames"><i class="fa fa-check"></i>Data frames</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-september-8-2022.html"><a href="thursday-september-8-2022.html"><i class="fa fa-check"></i>Thursday, September 8, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-september-8-2022.html"><a href="thursday-september-8-2022.html#using-pipes"><i class="fa fa-check"></i>Using pipes</a></li>
<li class="chapter" data-level="" data-path="thursday-september-8-2022.html"><a href="thursday-september-8-2022.html#wrangling-data-frames"><i class="fa fa-check"></i>Wrangling data frames</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-september-13-2022.html"><a href="tuesday-september-13-2022.html"><i class="fa fa-check"></i>Tuesday, September 13, 2022</a>
<ul>
<li class="chapter" data-level="0.1" data-path="tuesday-september-13-2022.html"><a href="tuesday-september-13-2022.html#data-munging-examples"><i class="fa fa-check"></i><b>0.1</b> Data munging examples</a></li>
<li class="chapter" data-level="" data-path="tuesday-september-13-2022.html"><a href="tuesday-september-13-2022.html#putting-things-together"><i class="fa fa-check"></i>Putting things together</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-september-15-2022.html"><a href="thursday-september-15-2022.html"><i class="fa fa-check"></i>Thursday, September 15, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-september-15-2022.html"><a href="thursday-september-15-2022.html#data-visualization"><i class="fa fa-check"></i>Data visualization</a></li>
<li class="chapter" data-level="" data-path="thursday-september-15-2022.html"><a href="thursday-september-15-2022.html#transforming-the-response-variable"><i class="fa fa-check"></i>Transforming the response variable</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-october-20-2022.html"><a href="thursday-october-20-2022.html"><i class="fa fa-check"></i>Thursday, October 20, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-october-20-2022.html"><a href="thursday-october-20-2022.html#more-regression-examples"><i class="fa fa-check"></i>More regression examples</a></li>
<li class="chapter" data-level="" data-path="thursday-october-20-2022.html"><a href="thursday-october-20-2022.html#outliers"><i class="fa fa-check"></i>Outliers</a></li>
<li class="chapter" data-level="" data-path="thursday-october-20-2022.html"><a href="thursday-october-20-2022.html#simpsons-paradox"><i class="fa fa-check"></i>Simpsonâ€™s paradox</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html"><i class="fa fa-check"></i>Tuesday, October 25, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#a-regression-plane"><i class="fa fa-check"></i>A regression plane</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#fitting-a-multiple-variable-regression-model"><i class="fa fa-check"></i>Fitting a multiple variable regression model</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#should-you-remove-a-variable-from-the-model"><i class="fa fa-check"></i>Should you remove a variable from the model?</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#checking-on-the-model-assumptions"><i class="fa fa-check"></i>Checking on the model assumptions</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#using-the-model-to-make-predictions"><i class="fa fa-check"></i>Using the model to make predictions</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#collinearity"><i class="fa fa-check"></i>Collinearity</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#interactions"><i class="fa fa-check"></i>Interactions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-october-27-2022.html"><a href="thursday-october-27-2022.html"><i class="fa fa-check"></i>Thursday, October 27, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-october-27-2022.html"><a href="thursday-october-27-2022.html#removing-variables-from-a-regression-model"><i class="fa fa-check"></i>Removing variables from a regression model</a></li>
<li class="chapter" data-level="" data-path="thursday-october-27-2022.html"><a href="thursday-october-27-2022.html#the-stepwise-selection-procedure"><i class="fa fa-check"></i>The stepwise selection procedure</a></li>
<li class="chapter" data-level="" data-path="thursday-october-27-2022.html"><a href="thursday-october-27-2022.html#transforming-a-response-variable"><i class="fa fa-check"></i>Transforming a response variable</a></li>
<li class="chapter" data-level="" data-path="thursday-october-27-2022.html"><a href="thursday-october-27-2022.html#regression-trees"><i class="fa fa-check"></i>Regression trees</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-november-1-2022.html"><a href="tuesday-november-1-2022.html"><i class="fa fa-check"></i>Tuesday, November 1, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-november-1-2022.html"><a href="tuesday-november-1-2022.html#predictive-uncertainty-with-regression-trees"><i class="fa fa-check"></i>Predictive uncertainty with regression trees</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-1-2022.html"><a href="tuesday-november-1-2022.html#the-random-forest-algorithm"><i class="fa fa-check"></i>The random forest algorithm</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-1-2022.html"><a href="tuesday-november-1-2022.html#cross-validation"><i class="fa fa-check"></i>Cross validation</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-1-2022.html"><a href="tuesday-november-1-2022.html#classification-trees"><i class="fa fa-check"></i>Classification trees</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-november-3-2022.html"><a href="thursday-november-3-2022.html"><i class="fa fa-check"></i>Thursday, November 3, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-november-3-2022.html"><a href="thursday-november-3-2022.html#binary-outcomes-and-probabilities"><i class="fa fa-check"></i>Binary outcomes and probabilities</a></li>
<li class="chapter" data-level="" data-path="thursday-november-3-2022.html"><a href="thursday-november-3-2022.html#logistic-regression"><i class="fa fa-check"></i>Logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html"><i class="fa fa-check"></i>Tuesday, November 8, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html#quantifying-autocorrelation-in-spatial-data"><i class="fa fa-check"></i>Quantifying autocorrelation in spatial data</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html#spatial-data-as-polygon-areas"><i class="fa fa-check"></i>Spatial data as polygon areas</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html#nearest-neighbors"><i class="fa fa-check"></i>Nearest neighbors</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html#spatial-weights"><i class="fa fa-check"></i>Spatial weights</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html#morans-i"><i class="fa fa-check"></i>Moranâ€™s I</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html#spatial-lag-variable"><i class="fa fa-check"></i>Spatial lag variable</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-november-10-2022.html"><a href="thursday-november-10-2022.html"><i class="fa fa-check"></i>Thursday, November 10, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-november-10-2022.html"><a href="thursday-november-10-2022.html#statistical-significance-of-spatial-autocorrelation"><i class="fa fa-check"></i>Statistical significance of spatial autocorrelation</a></li>
<li class="chapter" data-level="" data-path="thursday-november-10-2022.html"><a href="thursday-november-10-2022.html#a-monte-carlo-approach-to-inference-about-spatial-autocorrelation"><i class="fa fa-check"></i>A Monte Carlo approach to inference about spatial autocorrelation</a></li>
<li class="chapter" data-level="" data-path="thursday-november-10-2022.html"><a href="thursday-november-10-2022.html#spatial-autocorrelation-in-model-residuals"><i class="fa fa-check"></i>Spatial autocorrelation in model residuals</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-november-15-2022.html"><a href="tuesday-november-15-2022.html"><i class="fa fa-check"></i>Tuesday, November 15, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-november-15-2022.html"><a href="tuesday-november-15-2022.html#bi-variate-spatial-autocorrelation"><i class="fa fa-check"></i>Bi-variate spatial autocorrelation</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-15-2022.html"><a href="tuesday-november-15-2022.html#local-autocorrelation"><i class="fa fa-check"></i>Local autocorrelation</a></li>
<li class="chapter" data-level="0.2" data-path="tuesday-november-15-2022.html"><a href="tuesday-november-15-2022.html#local-regression"><i class="fa fa-check"></i><b>0.2</b> Local regression</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-15-2022.html"><a href="tuesday-november-15-2022.html#spatial-weights-1"><i class="fa fa-check"></i>Spatial weights</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-november-17-2022.html"><a href="thursday-november-17-2022.html"><i class="fa fa-check"></i>Thursday, November 17, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-november-17-2022.html"><a href="thursday-november-17-2022.html#geographic-regression"><i class="fa fa-check"></i>Geographic regression</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GEO5156: Quantitative Geography</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tuesday-november-8-2022" class="section level1 unnumbered hasAnchor">
<h1>Tuesday, November 8, 2022<a href="tuesday-november-8-2022.html#tuesday-november-8-2022" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Today</p>
<p>Spatial autocorrelation</p>
<ul>
<li>Quantifying autocorrelation in spatial data</li>
<li>Spatial data as polygon areas</li>
<li>Nearest neighbors</li>
<li>Spatial weights</li>
<li>Moranâ€™s I</li>
<li>Spatial lag variable</li>
</ul>
<p>When your data set contains observations made across space (spatial data), the assumption of independent values is usually not valid. This is because nearby locations tend to have similar values.</p>
<p>Similarity in observations that are nearby arises from:</p>
<p>Association: whatever is causing an observation to have a certain value in one area causes the observation to have a similar value in areas nearby. Crime rates in nearby neighborhoods might tend to cluster due to similar factors such as economic status and the amount of policing. Non-infectious diseases (e.g., lung cancer) might have similar rates in neighborhoods close to an oil refinery.</p>
<p>Causality: something within an area directly influences outcomes within nearby areas. The broken window theory of crime suggests that poverty, lack of maintenance, and petty crime tends to breed more crime due to a perceived breakdown in civil order.</p>
<p>Interaction: the movement of people, goods or information creates relationships between nearby areas. Infectious diseases might spread from a source region thus increasing the disease rates in surrounding areas as the direct result of contact or movement of people between regions.</p>
<p>We quantify how similar nearby values tend to be through a metric called <em>spatial autocorrelation</em>. Statistical methods can quantify, and condition on, spatial autocorrelation but they are silent about itâ€™s physical cause.</p>
<p>Understanding the reason for spatial autocorrelation is important for causal inference because the causal mechanism might be statistically confounded by it. Divorce rates are high in states in the South but so to are the number of Waffle Houses.</p>
<p>Understanding the potential causes of spatial autocorrelation requires domain specific knowledge.</p>
<div id="quantifying-autocorrelation-in-spatial-data" class="section level2 unnumbered hasAnchor">
<h2>Quantifying autocorrelation in spatial data<a href="tuesday-november-8-2022.html#quantifying-autocorrelation-in-spatial-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When values are aggregated into spatial regions, autocorrelation is quantified by how similar a value in region <span class="math inline">\(i\)</span> is to the value in region <span class="math inline">\(j\)</span> and weighting this similarity by how â€˜closeâ€™ region <span class="math inline">\(i\)</span> is to region <span class="math inline">\(j\)</span>. Closer regions are given more weight.</p>
<p>High similarities with high weight (similar values close together) yield high values of spatial autocorrelation. Low similarities with high weight (dissimilar values close together) yield low values of spatial autocorrelation.</p>
<p>Let <span class="math inline">\(\hbox{sim}_{ij}\)</span> be a measure of similarity between values <span class="math inline">\(Y_i\)</span> and <span class="math inline">\(Y_j\)</span>, and let <span class="math inline">\(w_{ij}\)</span> be a set of weights inversely proportional to the distances between regions <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>, for all <span class="math inline">\(i\)</span>, <span class="math inline">\(j\)</span>.</p>
<p>Then a spatial autocorrelation index (SAI) will have the form
<span class="math display">\[
\hbox{SAI} = \frac{\sum_{i,j=1}^N w_{ij}\hbox{sim}_{ij}}{\sum_{i,j=1}^N w_{ij}}
\]</span></p>
<p>The set of weights is called a spatial weights matrix and <span class="math inline">\(N\)</span> is the number of observations. The spatial weights matrix <em>defines the neighbors</em> and the <em>strength of their relationship</em>.</p>
<p>The spatial unit of observation can be points or polygons. Temperatures measured by thermometers across the cities is an example of point observations. The number of people living within a census block is an example of polygon observations.</p>
</div>
<div id="spatial-data-as-polygon-areas" class="section level2 unnumbered hasAnchor">
<h2>Spatial data as polygon areas<a href="tuesday-november-8-2022.html#spatial-data-as-polygon-areas" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Consider crime data at the census tract level in the city of Columbus, Ohio. The data are available in a zipped folder containing ESRI shapefiles on my website. Here you use the <code>download.file()</code> function and then the <code>unzip()</code> function to get the data into our project folder.</p>
<div class="sourceCode" id="cb841"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb841-1"><a href="tuesday-november-8-2022.html#cb841-1" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;http://myweb.fsu.edu/jelsner/temp/data/columbus.zip&quot;</span></span>
<span id="cb841-2"><a href="tuesday-november-8-2022.html#cb841-2" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(url,</span>
<span id="cb841-3"><a href="tuesday-november-8-2022.html#cb841-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">destfile =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;columbus.zip&quot;</span>))</span>
<span id="cb841-4"><a href="tuesday-november-8-2022.html#cb841-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb841-5"><a href="tuesday-november-8-2022.html#cb841-5" aria-hidden="true" tabindex="-1"></a><span class="fu">unzip</span>(<span class="at">zipfile =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;columbus.zip&quot;</span>),</span>
<span id="cb841-6"><a href="tuesday-november-8-2022.html#cb841-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">exdir =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>))</span></code></pre></div>
<p>Then you use the <code>read_sf()</code> function from the {sf} package to get the data into your current session. You assign the spatial data frame the name <code>CC.sf</code>.</p>
<div class="sourceCode" id="cb842"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb842-1"><a href="tuesday-november-8-2022.html#cb842-1" aria-hidden="true" tabindex="-1"></a>CC.sf <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">read_sf</span>(<span class="at">dsn =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;columbus&quot;</span>), </span>
<span id="cb842-2"><a href="tuesday-november-8-2022.html#cb842-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">layer =</span> <span class="st">&quot;columbus&quot;</span>)</span></code></pre></div>
<p>The spatial data frame contains crime rates (residential burglaries and vehicle thefts per 1000 households) in the column labeled <code>CRIME</code>. There is one crime rate for each census tract polygon. The data frame also contains housing values and median household income in units of 1000 of dollars.</p>
<p>The object <code>CC.sf</code> behaves as a regular data frame but it is also has a simple feature class (<code>sf</code>) that indicates a column containing the geographic information.</p>
<div class="sourceCode" id="cb843"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb843-1"><a href="tuesday-november-8-2022.html#cb843-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(CC.sf)</span></code></pre></div>
<pre><code>## [1] &quot;sf&quot;         &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</code></pre>
<p>Simple features is an open standard from the Open Geospatial Consortium (OGC) for representing geographic information as a spatial data frame. Simple features condense geographic forms into a single <em>geometry class</em>. The standard is implemented in spatial databases (e.g., PostGIS), commercial GIS (e.g., ESRI) and forms the vector data basis for libraries such as <a href="http://www.gdal.org/">GDAL</a>.</p>
<p>Functions in the {sf} package can be used to manipulate vector geometry types including points, lines, polygons and their respective â€˜multiâ€™ versions (which group together features of the same type into a single feature). The geometry is a list column in the simple feature data frame with the label <code>geometry</code>.</p>
<p>To print the column names type</p>
<div class="sourceCode" id="cb845"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb845-1"><a href="tuesday-november-8-2022.html#cb845-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(CC.sf)</span></code></pre></div>
<pre><code>##  [1] &quot;AREA&quot;       &quot;PERIMETER&quot;  &quot;COLUMBUS_&quot;  &quot;COLUMBUS_I&quot; &quot;POLYID&quot;    
##  [6] &quot;NEIG&quot;       &quot;HOVAL&quot;      &quot;INC&quot;        &quot;CRIME&quot;      &quot;OPEN&quot;      
## [11] &quot;PLUMB&quot;      &quot;DISCBD&quot;     &quot;X&quot;          &quot;Y&quot;          &quot;NSA&quot;       
## [16] &quot;NSB&quot;        &quot;EW&quot;         &quot;CP&quot;         &quot;THOUS&quot;      &quot;NEIGNO&quot;    
## [21] &quot;geometry&quot;</code></pre>
<p>The first twenty columns in the spatial data frame contain observations (attributes) and the last column contains the geometry information associated with each observation (row). The <code>geometry</code> column contains the spatial coordinates in well-known text (WKT) format.</p>
<p>The {sf} package has a <code>plot()</code> method for viewing the geographic data on a map. For example to plot the census tract borders in the city of Columbus we apply the method to the geometry column of the spatial data frame.</p>
<div class="sourceCode" id="cb847"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb847-1"><a href="tuesday-november-8-2022.html#cb847-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(CC.sf<span class="sc">$</span>geometry)</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-677-1.png" width="672" /></p>
<p>The <code>sf</code> spatial objects behave as regular data frames. For example, the <code>summary()</code> method, gives an overview of the variables and the spatial information. Here you summarize the data in the <code>CRIME</code> column.</p>
<div class="sourceCode" id="cb848"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb848-1"><a href="tuesday-november-8-2022.html#cb848-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(CC.sf[<span class="st">&quot;CRIME&quot;</span>])</span></code></pre></div>
<pre><code>##      CRIME            geometry 
##  Min.   : 0.1783   POLYGON:49  
##  1st Qu.:20.0485   epsg:NA: 0  
##  Median :34.0008               
##  Mean   :35.1288               
##  3rd Qu.:48.5855               
##  Max.   :68.8920</code></pre>
<p>You see that the median crime rate is about 34 cases per 1000 households.</p>
<p>Although you selected the variable <code>CRIME</code> the output also includes a summary on the geometry column. Here the information tells you that there are 49 polygons (49 census tracts) and no coordinate information.</p>
<p>You can create choropleth maps from <code>sf</code> objects with the base <code>plot()</code> method (<code>plot.sf()</code>). For example, to create a choropleth map of the crime variable you subset on the variable name.</p>
<div class="sourceCode" id="cb850"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb850-1"><a href="tuesday-november-8-2022.html#cb850-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(CC.sf[<span class="st">&quot;CRIME&quot;</span>])</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-679-1.png" width="672" /></p>
<p>You can also make maps with functions from the {tmap} package.</p>
<div class="sourceCode" id="cb851"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb851-1"><a href="tuesday-november-8-2022.html#cb851-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb851-2"><a href="tuesday-november-8-2022.html#cb851-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb851-3"><a href="tuesday-november-8-2022.html#cb851-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(CC.sf) <span class="sc">+</span></span>
<span id="cb851-4"><a href="tuesday-november-8-2022.html#cb851-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">&quot;CRIME&quot;</span>,</span>
<span id="cb851-5"><a href="tuesday-november-8-2022.html#cb851-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb851-6"><a href="tuesday-november-8-2022.html#cb851-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">col =</span> <span class="st">&quot;gray70&quot;</span>) <span class="sc">+</span></span>
<span id="cb851-7"><a href="tuesday-november-8-2022.html#cb851-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">&quot;Burglary &amp; Vehicle Thefts</span><span class="sc">\n</span><span class="st">/1000 Households&quot;</span>,</span>
<span id="cb851-8"><a href="tuesday-november-8-2022.html#cb851-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Warning: Currect projection of shape CC.sf unknown. Long-lat (WGS84) is assumed.</code></pre>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-680-1.png" width="672" /></p>
<p>And with functions from the {ggplot2} package.</p>
<div class="sourceCode" id="cb853"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb853-1"><a href="tuesday-november-8-2022.html#cb853-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb853-2"><a href="tuesday-november-8-2022.html#cb853-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> CC.sf) <span class="sc">+</span> </span>
<span id="cb853-3"><a href="tuesday-november-8-2022.html#cb853-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> CRIME), <span class="at">col =</span> <span class="st">&quot;gray70&quot;</span>) <span class="sc">+</span></span>
<span id="cb853-4"><a href="tuesday-november-8-2022.html#cb853-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Burglary &amp; Vehicle Thefts/1000 Households&quot;</span>)</span></code></pre></div>
<p>The map shows that high crime areas tend to cluster. That is census tracts with high crime rates tend to be adjacent to other tracts with high rates.</p>
<p>Spatial autocorrelation quantifies the amount of clustering. To compute the spatial autocorrelation you first need to define a list of neighbors for each tract (each polygon).</p>
</div>
<div id="nearest-neighbors" class="section level2 unnumbered hasAnchor">
<h2>Nearest neighbors<a href="tuesday-november-8-2022.html#nearest-neighbors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You create a list of neighbors for each tract using the <code>poly2nb()</code> function from the {spdep} package.</p>
<div class="sourceCode" id="cb854"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb854-1"><a href="tuesday-november-8-2022.html#cb854-1" aria-hidden="true" tabindex="-1"></a>nbs <span class="ot">&lt;-</span> spdep<span class="sc">::</span><span class="fu">poly2nb</span>(CC.sf)</span>
<span id="cb854-2"><a href="tuesday-november-8-2022.html#cb854-2" aria-hidden="true" tabindex="-1"></a>nbs</span></code></pre></div>
<pre><code>## Neighbour list object:
## Number of regions: 49 
## Number of nonzero links: 236 
## Percentage nonzero weights: 9.829238 
## Average number of links: 4.816327</code></pre>
<p>See also the new package {sfdep}. <a href="https://sfdep.josiahparry.com/" class="uri">https://sfdep.josiahparry.com/</a></p>
<p>The function builds a list of neighbors for each polygon based on contiguity. Neighbors must share one or more boundary points. The default contiguity is defined as having at least one point in common (called queen contiguity). This is changed with the argument <code>queen = FALSE</code>.</p>
<p>There are 49 polygons (census tracts). Each polygon is bordered by at least one other polygon (each polygon is bordered by at least one polygon). The average number of neighboring polygons is 4.8. The total number of neighboring polygons over all tracts is 236. This represents 9.8% of all possible neighbors (if every polygon is a neighbor of itself and every other polygon 49 * 49).</p>
<p>You make a graph the neighbors with the <code>plot()</code> method. The arguments include the neighbor list object (<code>nbs</code>) and the location of the polygon centers, which are extracted from the simple feature data frame using the <code>st_centroid()</code>.</p>
<div class="sourceCode" id="cb856"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb856-1"><a href="tuesday-november-8-2022.html#cb856-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nbs, </span>
<span id="cb856-2"><a href="tuesday-november-8-2022.html#cb856-2" aria-hidden="true" tabindex="-1"></a>     sf<span class="sc">::</span><span class="fu">st_centroid</span>(CC.sf<span class="sc">$</span>geometry))</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-683-1.png" width="672" /></p>
<p>The graph is a network of nodes and links showing the contiguity (topology). Each node is a tract and each link indicates spatial contiguity. The graph makes it clear that tracts in the center of the city have more neighbors than tracts away from the center.</p>
<p>The number of links per node [link number distribution] is obtained with the <code>summary()</code> method applied to the neighborhood list object.</p>
<div class="sourceCode" id="cb857"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb857-1"><a href="tuesday-november-8-2022.html#cb857-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(nbs)</span></code></pre></div>
<pre><code>## Neighbour list object:
## Number of regions: 49 
## Number of nonzero links: 236 
## Percentage nonzero weights: 9.829238 
## Average number of links: 4.816327 
## Link number distribution:
## 
##  2  3  4  5  6  7  8  9 10 
##  5  9 12  5  9  3  4  1  1 
## 5 least connected regions:
## 1 6 42 46 47 with 2 links
## 1 most connected region:
## 20 with 10 links</code></pre>
<p>You print the neighboring tracts for the first two tracts using the double bracket notation.</p>
<div class="sourceCode" id="cb859"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb859-1"><a href="tuesday-november-8-2022.html#cb859-1" aria-hidden="true" tabindex="-1"></a>nbs[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>## [1] 2 3</code></pre>
<div class="sourceCode" id="cb861"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb861-1"><a href="tuesday-november-8-2022.html#cb861-1" aria-hidden="true" tabindex="-1"></a>nbs[[<span class="dv">2</span>]]</span></code></pre></div>
<pre><code>## [1] 1 3 4</code></pre>
<p>The first tract has two neighbors that include tracts 2 and 3. The neighbor numbers are stored as an integer vector. Tract 2 has three neighbors that include tracts 1, 3, and 4. Tract 5 has 8 neighbors and so on. The function <code>card()</code> tallies the number of neighbors by tract.</p>
<div class="sourceCode" id="cb863"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb863-1"><a href="tuesday-november-8-2022.html#cb863-1" aria-hidden="true" tabindex="-1"></a>spdep<span class="sc">::</span><span class="fu">card</span>(nbs)</span></code></pre></div>
<pre><code>##  [1]  2  3  4  4  8  2  4  6  8  4  5  6  4  6  6  8  3  4  3 10  3  6  3  7  8
## [26]  6  4  9  7  5  3  4  4  4  7  5  6  6  3  5  3  2  6  5  4  2  2  4  3</code></pre>
<p>Tract 5 has 8 neighbors.</p>
</div>
<div id="spatial-weights" class="section level2 unnumbered hasAnchor">
<h2>Spatial weights<a href="tuesday-november-8-2022.html#spatial-weights" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Next you add weights to the neighbor list object. The weights specifying how â€˜closeâ€™ each neighbor is. You do this with the <code>nb2listw()</code> function from the {spdep} package. The function turns the neighbor list object into a spatial weights object.</p>
<div class="sourceCode" id="cb865"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb865-1"><a href="tuesday-november-8-2022.html#cb865-1" aria-hidden="true" tabindex="-1"></a>wts <span class="ot">&lt;-</span> spdep<span class="sc">::</span><span class="fu">nb2listw</span>(nbs)</span>
<span id="cb865-2"><a href="tuesday-november-8-2022.html#cb865-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(wts)</span></code></pre></div>
<pre><code>## [1] &quot;listw&quot; &quot;nb&quot;</code></pre>
<p>This new <code>wts</code> object is a list with two elements. The first element (<code>listw</code>) is the weights matrix and the second element (<code>nb</code>) is the neighbor list object.</p>
<div class="sourceCode" id="cb867"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb867-1"><a href="tuesday-november-8-2022.html#cb867-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wts)</span></code></pre></div>
<pre><code>## Characteristics of weights list object:
## Neighbour list object:
## Number of regions: 49 
## Number of nonzero links: 236 
## Percentage nonzero weights: 9.829238 
## Average number of links: 4.816327 
## Link number distribution:
## 
##  2  3  4  5  6  7  8  9 10 
##  5  9 12  5  9  3  4  1  1 
## 5 least connected regions:
## 1 6 42 46 47 with 2 links
## 1 most connected region:
## 20 with 10 links
## 
## Weights style: W 
## Weights constants summary:
##    n   nn S0       S1       S2
## W 49 2401 49 22.75119 203.7091</code></pre>
<p>By default all neighboring tracts are assigned a weight equal to the inverse of the number of neighbors (<code>style = "W"</code>). For a tract with 5 neighbors each neighbor gets a weight of 1/5. The sum over all weights (<code>S0</code>) is the number of tracts.</p>
<p>To see the weights for the first two tracts type</p>
<div class="sourceCode" id="cb869"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb869-1"><a href="tuesday-november-8-2022.html#cb869-1" aria-hidden="true" tabindex="-1"></a>wts<span class="sc">$</span>weights[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.5 0.5
## 
## [[2]]
## [1] 0.3333333 0.3333333 0.3333333</code></pre>
<p>The <code>$weights</code> list is the spatial weights matrix.</p>
<p>To see the neighbors of the first two tracts type</p>
<div class="sourceCode" id="cb871"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb871-1"><a href="tuesday-november-8-2022.html#cb871-1" aria-hidden="true" tabindex="-1"></a>wts<span class="sc">$</span>neighbours[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span></code></pre></div>
<pre><code>## [[1]]
## [1] 2 3
## 
## [[2]]
## [1] 1 3 4</code></pre>
<p>Tract 1 has two neighbors (tract 2 &amp; 3) so each are given a weight of 1/2. Tract 2 has three neighbors (tract 1, 3, &amp; 4) so each are given a weight of 1/3.</p>
<p>With the weights matrix specified and saved as an object you are ready to quantify the amount of spatial autocorrelation.</p>
<p>Caution: Using contiguity as a indicator of closeness can result in areas having no neighbors; islands for example.</p>
<p>By default the <code>nb2listw()</code> function assumes each area has at least one neighbor. If this is not the case you need to specify how areas without neighbors are handled using the argument <code>zero.policy = TRUE</code>. This allows the weights list to be formed with zero-length vectors.</p>
<p>For example, consider the districts in Scotland.</p>
<div class="sourceCode" id="cb873"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb873-1"><a href="tuesday-november-8-2022.html#cb873-1" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;http://myweb.fsu.edu/jelsner/temp/data/scotlip.zip&quot;</span></span>
<span id="cb873-2"><a href="tuesday-november-8-2022.html#cb873-2" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(url,</span>
<span id="cb873-3"><a href="tuesday-november-8-2022.html#cb873-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">destfile =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;scotlip.zip&quot;</span>))</span>
<span id="cb873-4"><a href="tuesday-november-8-2022.html#cb873-4" aria-hidden="true" tabindex="-1"></a><span class="fu">unzip</span>(<span class="at">zipfile =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;scotlip.zip&quot;</span>),</span>
<span id="cb873-5"><a href="tuesday-november-8-2022.html#cb873-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">exdir =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>))</span>
<span id="cb873-6"><a href="tuesday-november-8-2022.html#cb873-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb873-7"><a href="tuesday-november-8-2022.html#cb873-7" aria-hidden="true" tabindex="-1"></a>SL.sf <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">read_sf</span>(<span class="at">dsn =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;scotlip&quot;</span>), </span>
<span id="cb873-8"><a href="tuesday-november-8-2022.html#cb873-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">layer =</span> <span class="st">&quot;scotlip&quot;</span>)</span>
<span id="cb873-9"><a href="tuesday-november-8-2022.html#cb873-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(SL.sf<span class="sc">$</span>geometry)</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-691-1.png" width="672" /></p>
<p>Here there are three island districts.</p>
<p>Create a list of neighbors.</p>
<div class="sourceCode" id="cb874"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb874-1"><a href="tuesday-november-8-2022.html#cb874-1" aria-hidden="true" tabindex="-1"></a>( nbs2 <span class="ot">&lt;-</span> spdep<span class="sc">::</span><span class="fu">poly2nb</span>(SL.sf) )</span></code></pre></div>
<pre><code>## Neighbour list object:
## Number of regions: 56 
## Number of nonzero links: 234 
## Percentage nonzero weights: 7.461735 
## Average number of links: 4.178571 
## 3 regions with no links:
## 6 8 11</code></pre>
<p>Three regions with no links.</p>
<p>Use the <code>nb2listw()</code> function with the argument <code>zero.policy = TRUE</code>. Otherwise you will get an error saying the empty neighbor sets are found.</p>
<div class="sourceCode" id="cb876"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb876-1"><a href="tuesday-november-8-2022.html#cb876-1" aria-hidden="true" tabindex="-1"></a>wts2 <span class="ot">&lt;-</span> spdep<span class="sc">::</span><span class="fu">nb2listw</span>(nbs2,</span>
<span id="cb876-2"><a href="tuesday-november-8-2022.html#cb876-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">zero.policy =</span> <span class="cn">TRUE</span>)</span>
<span id="cb876-3"><a href="tuesday-november-8-2022.html#cb876-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wts2<span class="sc">$</span>weights)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.3333333 0.3333333 0.3333333
## 
## [[2]]
## [1] 0.5 0.5
## 
## [[3]]
## [1] 1
## 
## [[4]]
## [1] 0.3333333 0.3333333 0.3333333
## 
## [[5]]
## [1] 0.3333333 0.3333333 0.3333333
## 
## [[6]]
## NULL</code></pre>
<p>Here we see that district 6 in Scotland has no neighbors.</p>
</div>
<div id="morans-i" class="section level2 unnumbered hasAnchor">
<h2>Moranâ€™s I<a href="tuesday-november-8-2022.html#morans-i" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Moranâ€™s I follows the basic form of spatial autocorrelation indexes where the similarity between regions <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> is proportional to the product of the deviations from the mean such that
<span class="math display">\[
\hbox{sim}_{ij} \propto (Y_i - \bar Y) (Y_j - \bar Y)
\]</span></p>
<p>where <span class="math inline">\(i\)</span> indexes the region (areal unit) and <span class="math inline">\(j\)</span> indexes the neighbors of <span class="math inline">\(i\)</span>. The value of <span class="math inline">\(\hbox{sim}_{ij}\)</span> is large when the <span class="math inline">\(Y\)</span> values in the product are on the same side of their respective means and small when they are on opposite sides of their respective means.</p>
<p>The formula for I is
<span class="math display">\[
\hbox{I} = \frac{N} {W} \frac {\sum_{i,j} w_{ij}(Y_i-\bar Y) (Y_j-\bar Y)} {\sum_{i} (Y_i-\bar Y)^2}
\]</span>
where <span class="math inline">\(N\)</span> is the number regions, <span class="math inline">\(w_{ij}\)</span> is the matrix of spatial weights, and <span class="math inline">\(W\)</span> is the sum over all weights.</p>
<p>Consider the following spatial grid of cells containing random values.</p>
<div class="sourceCode" id="cb878"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb878-1"><a href="tuesday-november-8-2022.html#cb878-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">6750</span>)</span>
<span id="cb878-2"><a href="tuesday-november-8-2022.html#cb878-2" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> spatstat.geom<span class="sc">::</span><span class="fu">ppp</span>(<span class="fu">runif</span>(<span class="dv">200</span>, <span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb878-3"><a href="tuesday-november-8-2022.html#cb878-3" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">runif</span>(<span class="dv">200</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb878-4"><a href="tuesday-november-8-2022.html#cb878-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(spatstat.geom<span class="sc">::</span><span class="fu">quadratcount</span>(Y), <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-694-1.png" width="672" /></p>
<p>The formula for I results in one value for the entire grid.</p>
<p>First consider a single cell on the grid (<span class="math inline">\(N\)</span> = 1). Here the middle cell (row 3, column 3). Let <span class="math inline">\(i\)</span> = 3 in the above formula and let <span class="math inline">\(j\)</span> index the cells touching the center cell in reading order starting with cell (2, 2), then cell (2, 3), etc.</p>
<p>Assume each neighbor is given a weight of 1/8 so <span class="math inline">\(W\)</span> = 1. Then the value of I for the single center cell is
I_{3, 3} = (6 - mean(y)) *
((8 - mean(y)) +
(3 - mean(y)) +
(9 - mean(y)) +
(12 - mean(y)) +
(10 - mean(y)) +
(10 - mean(y)) +
(9 - mean(y))) /
(6 - mean(y))^2)</p>
<div class="sourceCode" id="cb879"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb879-1"><a href="tuesday-november-8-2022.html#cb879-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">10</span>, <span class="dv">7</span>, <span class="dv">12</span>, <span class="dv">5</span>, <span class="dv">11</span>, <span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">9</span>, <span class="dv">12</span>, </span>
<span id="cb879-2"><a href="tuesday-november-8-2022.html#cb879-2" aria-hidden="true" tabindex="-1"></a>      <span class="dv">6</span>, <span class="dv">12</span>, <span class="dv">6</span>, <span class="dv">10</span>, <span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">9</span>, <span class="dv">7</span>, </span>
<span id="cb879-3"><a href="tuesday-november-8-2022.html#cb879-3" aria-hidden="true" tabindex="-1"></a>      <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">8</span>, <span class="dv">5</span>, <span class="dv">11</span>)</span>
<span id="cb879-4"><a href="tuesday-november-8-2022.html#cb879-4" aria-hidden="true" tabindex="-1"></a>yb <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span></code></pre></div>
<div class="sourceCode" id="cb880"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb880-1"><a href="tuesday-november-8-2022.html#cb880-1" aria-hidden="true" tabindex="-1"></a>Inum_i <span class="ot">&lt;-</span> (<span class="dv">6</span> <span class="sc">-</span> yb) <span class="sc">*</span> </span>
<span id="cb880-2"><a href="tuesday-november-8-2022.html#cb880-2" aria-hidden="true" tabindex="-1"></a>                 ((<span class="dv">8</span> <span class="sc">-</span> yb) <span class="sc">+</span> (<span class="dv">3</span> <span class="sc">-</span> yb) <span class="sc">+</span> (<span class="dv">9</span> <span class="sc">-</span> yb) <span class="sc">+</span> </span>
<span id="cb880-3"><a href="tuesday-november-8-2022.html#cb880-3" aria-hidden="true" tabindex="-1"></a>                  (<span class="dv">12</span> <span class="sc">-</span> yb) <span class="sc">+</span> (<span class="dv">10</span> <span class="sc">-</span> yb) <span class="sc">+</span> (<span class="dv">10</span> <span class="sc">-</span> yb) <span class="sc">+</span> </span>
<span id="cb880-4"><a href="tuesday-november-8-2022.html#cb880-4" aria-hidden="true" tabindex="-1"></a>                  (<span class="dv">10</span> <span class="sc">-</span> yb) <span class="sc">+</span> (<span class="dv">9</span> <span class="sc">-</span> yb))</span>
<span id="cb880-5"><a href="tuesday-november-8-2022.html#cb880-5" aria-hidden="true" tabindex="-1"></a>Iden_i <span class="ot">&lt;-</span> (<span class="dv">6</span> <span class="sc">-</span> yb)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb880-6"><a href="tuesday-november-8-2022.html#cb880-6" aria-hidden="true" tabindex="-1"></a>Inum_i<span class="sc">/</span>Iden_i</span></code></pre></div>
<pre><code>## [1] -3.5</code></pre>
<p>The I value of -3.5 indicates that the center cell which has a value less than the average over all 25 cells is surrounded by cells with values above the average.</p>
<p>Now repeat this calculation for every cell and then add all the results.</p>
<p>This is done with the <code>moran()</code> function from the {spdep} package. The first argument is the vector containing the values for which we are interested in determining the magnitude of the spatial autocorrelation and the second argument is the <code>listw</code> object.</p>
<p>We also need to specify the number of regions and the global sum of the weights <code>S0</code>. The latter is obtained from the <code>Szero()</code> function applied to the <code>listw</code> object.</p>
<p>Returning to the Columbus crime data here we let <code>m</code> be the number of census tracts and <code>s</code> be the sum of the weights.</p>
<div class="sourceCode" id="cb882"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb882-1"><a href="tuesday-november-8-2022.html#cb882-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">length</span>(CC.sf<span class="sc">$</span>CRIME)</span>
<span id="cb882-2"><a href="tuesday-november-8-2022.html#cb882-2" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> spdep<span class="sc">::</span><span class="fu">Szero</span>(wts)</span>
<span id="cb882-3"><a href="tuesday-november-8-2022.html#cb882-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb882-4"><a href="tuesday-november-8-2022.html#cb882-4" aria-hidden="true" tabindex="-1"></a>spdep<span class="sc">::</span><span class="fu">moran</span>(CC.sf<span class="sc">$</span>CRIME, </span>
<span id="cb882-5"><a href="tuesday-november-8-2022.html#cb882-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">listw =</span> wts, </span>
<span id="cb882-6"><a href="tuesday-november-8-2022.html#cb882-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">n =</span> m, </span>
<span id="cb882-7"><a href="tuesday-november-8-2022.html#cb882-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">S0 =</span> s)</span></code></pre></div>
<pre><code>## $I
## [1] 0.5001886
## 
## $K
## [1] 2.225946</code></pre>
<p>The function returns the Moranâ€™s I value and the kurtosis (K) of the distribution of crime values. Values for Moranâ€™s I range between -1 to +1. Positive values of Moranâ€™s I indicate clustering. The value of .5 for the crime rates indicates fairly high spatial autocorrelation. This is expected based on what you saw in the maps showing a clustering of crime.</p>
<p>Kurtosis is a statistic that indicates how â€˜peakedâ€™ the distribution of values is relative to a normal (bell-shaped) distribution. A normal distribution has a kurtosis of 3. If the kurtosis is too large or too small relative to a normal distribution (greater than about 4 or less than about 2) then any inference you make about clustering might be incorrect.</p>
<p>Another measure of the amount of spatial autocorrelation is the Gearyâ€™s C statistic. Gearyâ€™s C is computed as
<span class="math display">\[
\hbox{C} = \frac{(N-1) \sum_{i,j} w_{ij} (Y_i-Y_j)^2}{2 W \sum_{i}(Y_i-\bar Y)^2}
\]</span>
where <span class="math inline">\(W\)</span> is the sum over all weights (<span class="math inline">\(w_{ij}\)</span>) and <span class="math inline">\(N\)</span> is the number of areas.</p>
<p>The syntax of the <code>geary()</code> function is similar to the syntax of the <code>moran()</code> function except you also specify <code>n1</code> to be one minus the number of polygons.</p>
<div class="sourceCode" id="cb884"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb884-1"><a href="tuesday-november-8-2022.html#cb884-1" aria-hidden="true" tabindex="-1"></a>spdep<span class="sc">::</span><span class="fu">geary</span>(CC.sf<span class="sc">$</span>CRIME, </span>
<span id="cb884-2"><a href="tuesday-november-8-2022.html#cb884-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">listw =</span> wts,</span>
<span id="cb884-3"><a href="tuesday-november-8-2022.html#cb884-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">n =</span> m, </span>
<span id="cb884-4"><a href="tuesday-november-8-2022.html#cb884-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">S0 =</span> s, </span>
<span id="cb884-5"><a href="tuesday-november-8-2022.html#cb884-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">n1 =</span> m <span class="sc">-</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## $C
## [1] 0.5405282
## 
## $K
## [1] 2.225946</code></pre>
<p>Values for Gearyâ€™s C range from 0 to 2 with 1 indicating no spatial autocorrelation. Values less than 1 indicate positive autocorrelation. Both I and C are global measures of autocorrelation, but C is more sensitive to local variations in autocorrelation.</p>
<p>Rule of thumb: If the interpretation of Gearyâ€™s C is much different than the interpretation of Moranâ€™s I then consider computing local measures of spatial autocorrelation.</p>
</div>
<div id="spatial-lag-variable" class="section level2 unnumbered hasAnchor">
<h2>Spatial lag variable<a href="tuesday-november-8-2022.html#spatial-lag-variable" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Moranâ€™s I is the slope coefficient from a regression of the weighted average of the neighborhood values onto the observed values. The weighted average of neighborhood values is called the <em>spatial lag</em>.</p>
<p>Let <code>crime</code> be the set of crime values in each region. You create a spatial lag variable using the <code>lag.listw()</code> function. The first argument is the <code>listw</code> object and the second is the vector of crime values.</p>
<div class="sourceCode" id="cb886"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb886-1"><a href="tuesday-november-8-2022.html#cb886-1" aria-hidden="true" tabindex="-1"></a>crime <span class="ot">&lt;-</span> CC.sf<span class="sc">$</span>CRIME</span>
<span id="cb886-2"><a href="tuesday-november-8-2022.html#cb886-2" aria-hidden="true" tabindex="-1"></a>Wcrime <span class="ot">&lt;-</span> spdep<span class="sc">::</span><span class="fu">lag.listw</span>(wts, </span>
<span id="cb886-3"><a href="tuesday-november-8-2022.html#cb886-3" aria-hidden="true" tabindex="-1"></a>                           crime)</span></code></pre></div>
<p>For each value in the vector <code>crime</code> there is a corresponding value in the vector <code>Wcrime</code> representing the average crime over the neighboring regions.</p>
<p>Recall tract 1 had tract 2 and 3 as its only neighbors. So the following should return a <code>TRUE</code>.</p>
<div class="sourceCode" id="cb887"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb887-1"><a href="tuesday-november-8-2022.html#cb887-1" aria-hidden="true" tabindex="-1"></a>Wcrime[<span class="dv">1</span>] <span class="sc">==</span> (crime[<span class="dv">2</span>] <span class="sc">+</span> crime[<span class="dv">3</span>])<span class="sc">/</span><span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>A scatter plot of the neighborhood average crime rates versus the individual polygon crime rates in each shows there is a relationship.</p>
<div class="sourceCode" id="cb889"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb889-1"><a href="tuesday-november-8-2022.html#cb889-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb889-2"><a href="tuesday-november-8-2022.html#cb889-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb889-3"><a href="tuesday-november-8-2022.html#cb889-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(crime, Wcrime) <span class="sc">|&gt;</span></span>
<span id="cb889-4"><a href="tuesday-november-8-2022.html#cb889-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> crime, <span class="at">y =</span> Wcrime)) <span class="sc">+</span> </span>
<span id="cb889-5"><a href="tuesday-november-8-2022.html#cb889-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb889-6"><a href="tuesday-november-8-2022.html#cb889-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm) <span class="sc">+</span></span>
<span id="cb889-7"><a href="tuesday-november-8-2022.html#cb889-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">70</span>)) <span class="sc">+</span></span>
<span id="cb889-8"><a href="tuesday-november-8-2022.html#cb889-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">70</span>)) <span class="sc">+</span></span>
<span id="cb889-9"><a href="tuesday-november-8-2022.html#cb889-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Crime&quot;</span>) <span class="sc">+</span> </span>
<span id="cb889-10"><a href="tuesday-november-8-2022.html#cb889-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Average Crime in the Neighborhood&quot;</span>) <span class="sc">+</span></span>
<span id="cb889-11"><a href="tuesday-november-8-2022.html#cb889-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-701-1.png" width="672" /></p>
<p>The vertical axis contains the neighborhood average crime rate. The range of neighborhood averages is smaller than the range of individual polygon crime rates.</p>
<p>Tracts with low values of crime tend to be surrounded by tracts with low values of crime on average and tracts with high values of crime tend be surrounded by tracts with high values of crime. The slope is upward (positive).</p>
<p>The magnitude of the slope is the Moranâ€™s I value. To check this type</p>
<div class="sourceCode" id="cb891"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb891-1"><a href="tuesday-november-8-2022.html#cb891-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Wcrime <span class="sc">~</span> crime)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Wcrime ~ crime)
## 
## Coefficients:
## (Intercept)        crime  
##     17.4797       0.5002</code></pre>
<p>The coefficient on the <code>crime</code> variable in the simple linear regression is .5.</p>
<p>The scatter plot is a Moranâ€™s scatter plot.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="thursday-november-3-2022.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="thursday-november-10-2022.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
