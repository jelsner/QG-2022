<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Tuesday, October 11, 2022 | GEO5156: Quantitative Geography</title>
  <meta name="description" content="Tuesday, October 11, 2022 | GEO5156: Quantitative Geography" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Tuesday, October 11, 2022 | GEO5156: Quantitative Geography" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="jelsner/QG-2022" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Tuesday, October 11, 2022 | GEO5156: Quantitative Geography" />
  
  
  

<meta name="author" content="James B. Elsner" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="thursday-september-29-2022.html"/>
<link rel="next" href="tuesday-october-11-2022-1.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Quantitative Geography</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html"><i class="fa fa-check"></i>Syllabus</a>
<ul>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#geo5165c-quantitative-geography"><i class="fa fa-check"></i>GEO5165C: Quantitative Geography</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#contact-information"><i class="fa fa-check"></i>Contact information</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#course-description-and-expected-learning-outcomes"><i class="fa fa-check"></i>Course description and expected learning outcomes</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#grades-and-ethics"><i class="fa fa-check"></i>Grades and ethics</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#schedule-subject-to-change-with-notice"><i class="fa fa-check"></i>Schedule (subject to change with notice)</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#deeper-dives"><i class="fa fa-check"></i>Deeper dives</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html"><i class="fa fa-check"></i>Tuesday, August 23, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#what-is-this-course"><i class="fa fa-check"></i>What is this course?</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#where-are-the-materials-for-this-course"><i class="fa fa-check"></i>Where are the materials for this course?</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#get-the-syllabus"><i class="fa fa-check"></i>Get the syllabus</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#getting-setup"><i class="fa fa-check"></i>Getting setup</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#getting-to-know-rstudios-integrated-development-environment-ide"><i class="fa fa-check"></i>Getting to know RStudio’s integrated development environment (IDE)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-august-25-2022.html"><a href="thursday-august-25-2022.html"><i class="fa fa-check"></i>Thursday, August 25, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-august-25-2022.html"><a href="thursday-august-25-2022.html#data-science"><i class="fa fa-check"></i>Data science</a></li>
<li class="chapter" data-level="" data-path="thursday-august-25-2022.html"><a href="thursday-august-25-2022.html#structure-of-markdown-files"><i class="fa fa-check"></i>Structure of markdown files</a></li>
<li class="chapter" data-level="" data-path="thursday-august-25-2022.html"><a href="thursday-august-25-2022.html#how-to-make-a-plot"><i class="fa fa-check"></i>How to make a plot</a></li>
<li class="chapter" data-level="" data-path="thursday-august-25-2022.html"><a href="thursday-august-25-2022.html#getting-started-using-r"><i class="fa fa-check"></i>Getting started using R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-august-30-2022.html"><a href="tuesday-august-30-2022.html"><i class="fa fa-check"></i>Tuesday, August 30, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-august-30-2022.html"><a href="tuesday-august-30-2022.html#graphing-examples"><i class="fa fa-check"></i>Graphing examples</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-30-2022.html"><a href="tuesday-august-30-2022.html#introduction-to-working-with-base-r"><i class="fa fa-check"></i>Introduction to working with base R</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-30-2022.html"><a href="tuesday-august-30-2022.html#data-as-vectors"><i class="fa fa-check"></i>Data as vectors</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-september-1-2022.html"><a href="thursday-september-1-2022.html"><i class="fa fa-check"></i>Thursday, September 1, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-september-1-2022.html"><a href="thursday-september-1-2022.html#statistical-summaries-of-data"><i class="fa fa-check"></i>Statistical summaries of data</a></li>
<li class="chapter" data-level="" data-path="thursday-september-1-2022.html"><a href="thursday-september-1-2022.html#structured-data"><i class="fa fa-check"></i>Structured data</a></li>
<li class="chapter" data-level="" data-path="thursday-september-1-2022.html"><a href="thursday-september-1-2022.html#tables"><i class="fa fa-check"></i>Tables</a></li>
<li class="chapter" data-level="" data-path="thursday-september-1-2022.html"><a href="thursday-september-1-2022.html#assignment-1"><i class="fa fa-check"></i>Assignment #1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-september-6-2022.html"><a href="tuesday-september-6-2022.html"><i class="fa fa-check"></i>Tuesday, September 6, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-september-6-2022.html"><a href="tuesday-september-6-2022.html#getting-data-into-r"><i class="fa fa-check"></i>Getting data into R</a></li>
<li class="chapter" data-level="" data-path="tuesday-september-6-2022.html"><a href="tuesday-september-6-2022.html#data-frames"><i class="fa fa-check"></i>Data frames</a></li>
<li class="chapter" data-level="" data-path="tuesday-september-6-2022.html"><a href="tuesday-september-6-2022.html#piping-your-commands"><i class="fa fa-check"></i>Piping your commands</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-september-8-2022.html"><a href="thursday-september-8-2022.html"><i class="fa fa-check"></i>Thursday, September 8, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-september-8-2022.html"><a href="thursday-september-8-2022.html#data-transformation-with-dplyr"><i class="fa fa-check"></i>Data transformation with {dplyr}</a></li>
<li class="chapter" data-level="" data-path="thursday-september-8-2022.html"><a href="thursday-september-8-2022.html#from-data-import-to-final-plot"><i class="fa fa-check"></i>From data import to final plot</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-september-13-2022.html"><a href="tuesday-september-13-2022.html"><i class="fa fa-check"></i>Tuesday, September 13, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-september-13-2022.html"><a href="tuesday-september-13-2022.html#data-visualization"><i class="fa fa-check"></i>Data visualization</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-september-20-2022.html"><a href="tuesday-september-20-2022.html"><i class="fa fa-check"></i>Tuesday, September 20, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-september-20-2022.html"><a href="tuesday-september-20-2022.html#comparing-distributions"><i class="fa fa-check"></i>Comparing distributions</a></li>
<li class="chapter" data-level="" data-path="tuesday-september-20-2022.html"><a href="tuesday-september-20-2022.html#visualizing-uncertainty"><i class="fa fa-check"></i>Visualizing uncertainty</a></li>
<li class="chapter" data-level="" data-path="tuesday-september-20-2022.html"><a href="tuesday-september-20-2022.html#simple-feature-data-frames"><i class="fa fa-check"></i>Simple feature data frames</a></li>
<li class="chapter" data-level="" data-path="tuesday-september-20-2022.html"><a href="tuesday-september-20-2022.html#making-a-boundary-map"><i class="fa fa-check"></i>Making a boundary map</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-september-22-2022.html"><a href="thursday-september-22-2022.html"><i class="fa fa-check"></i>Thursday, September 22, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-september-22-2022.html"><a href="thursday-september-22-2022.html#adding-data-to-boundary-maps"><i class="fa fa-check"></i>Adding data to boundary maps</a></li>
<li class="chapter" data-level="" data-path="thursday-september-22-2022.html"><a href="thursday-september-22-2022.html#changing-projections"><i class="fa fa-check"></i>Changing projections</a></li>
<li class="chapter" data-level="" data-path="thursday-september-22-2022.html"><a href="thursday-september-22-2022.html#mapping-using-functions-from-tmap"><i class="fa fa-check"></i>Mapping using functions from tmap</a></li>
<li class="chapter" data-level="" data-path="thursday-september-22-2022.html"><a href="thursday-september-22-2022.html#making-an-interactive-map"><i class="fa fa-check"></i>Making an interactive map</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-october-4-2022.html"><a href="tuesday-october-4-2022.html"><i class="fa fa-check"></i>Tuesday, October 4, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-october-4-2022.html"><a href="tuesday-october-4-2022.html#extended-mapping-example-tornado-frequency"><i class="fa fa-check"></i>Extended mapping example: tornado frequency</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-4-2022.html"><a href="tuesday-october-4-2022.html#geo-computation-on-simple-feature-data-frames"><i class="fa fa-check"></i>Geo-computation on simple feature data frames</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-4-2022.html"><a href="tuesday-october-4-2022.html#making-raster-maps"><i class="fa fa-check"></i>Making raster maps</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-4-2022.html"><a href="tuesday-october-4-2022.html#spatial-density-maps"><i class="fa fa-check"></i>Spatial density maps</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-4-2022.html"><a href="tuesday-october-4-2022.html#assignment-3"><i class="fa fa-check"></i>Assignment #3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-september-29-2022.html"><a href="thursday-september-29-2022.html"><i class="fa fa-check"></i>Thursday, September 29, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-september-29-2022.html"><a href="thursday-september-29-2022.html#one-sample-test-for-the-value-of-the-population-mean"><i class="fa fa-check"></i>One-sample test for the value of the population mean</a></li>
<li class="chapter" data-level="" data-path="thursday-september-29-2022.html"><a href="thursday-september-29-2022.html#graphical-inference"><i class="fa fa-check"></i>Graphical inference</a></li>
<li class="chapter" data-level="" data-path="thursday-september-29-2022.html"><a href="thursday-september-29-2022.html#two-sample-test-for-a-difference-in-population-means"><i class="fa fa-check"></i>Two-sample test for a difference in population means</a></li>
<li class="chapter" data-level="" data-path="thursday-september-29-2022.html"><a href="thursday-september-29-2022.html#a-non-parameteric-test-for-difference-in-population-means"><i class="fa fa-check"></i>A non-parameteric test for difference in population means</a></li>
<li class="chapter" data-level="" data-path="thursday-september-29-2022.html"><a href="thursday-september-29-2022.html#paired-observations"><i class="fa fa-check"></i>Paired observations</a></li>
<li class="chapter" data-level="" data-path="thursday-september-29-2022.html"><a href="thursday-september-29-2022.html#chi-squared-test-for-independence"><i class="fa fa-check"></i>Chi-squared test for independence</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-october-11-2022.html"><a href="tuesday-october-11-2022.html"><i class="fa fa-check"></i>Tuesday, October 11, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-october-11-2022.html"><a href="tuesday-october-11-2022.html#distributions-as-building-blocks"><i class="fa fa-check"></i>Distributions as building blocks</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-11-2022.html"><a href="tuesday-october-11-2022.html#bayesian-computation"><i class="fa fa-check"></i>Bayesian computation</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-11-2022.html"><a href="tuesday-october-11-2022.html#real-world-example-from-wildlife-management"><i class="fa fa-check"></i>Real world example from wildlife management</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-11-2022.html"><a href="tuesday-october-11-2022.html#why-use-bayesian-models"><i class="fa fa-check"></i>Why use Bayesian models?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-october-11-2022-1.html"><a href="tuesday-october-11-2022-1.html"><i class="fa fa-check"></i>Tuesday, October 11, 2022</a></li>
<li class="chapter" data-level="" data-path="thursday-october-13-2022.html"><a href="thursday-october-13-2022.html"><i class="fa fa-check"></i>Thursday, October 13, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-october-13-2022.html"><a href="thursday-october-13-2022.html#linear-regression-a-t-test-by-another-name"><i class="fa fa-check"></i>Linear regression: A t test by another name</a></li>
<li class="chapter" data-level="" data-path="thursday-october-13-2022.html"><a href="thursday-october-13-2022.html#motivation-for-the-regression-model"><i class="fa fa-check"></i>Motivation for the regression model</a></li>
<li class="chapter" data-level="" data-path="thursday-october-13-2022.html"><a href="thursday-october-13-2022.html#making-predictions-with-the-regression-model"><i class="fa fa-check"></i>Making predictions with the regression model</a></li>
<li class="chapter" data-level="" data-path="thursday-october-13-2022.html"><a href="thursday-october-13-2022.html#uncertainty-about-the-regression-model-coefficients"><i class="fa fa-check"></i>Uncertainty about the regression model coefficients</a></li>
<li class="chapter" data-level="" data-path="thursday-october-13-2022.html"><a href="thursday-october-13-2022.html#bootstrapping-the-uncertainty"><i class="fa fa-check"></i>Bootstrapping the uncertainty</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-october-18-2022.html"><a href="tuesday-october-18-2022.html"><i class="fa fa-check"></i>Tuesday, October 18, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-october-18-2022.html"><a href="tuesday-october-18-2022.html#uncertainty-about-a-particular-predicted-value"><i class="fa fa-check"></i>Uncertainty about a particular predicted value</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-18-2022.html"><a href="tuesday-october-18-2022.html#model-adequacy"><i class="fa fa-check"></i>Model Adequacy</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-18-2022.html"><a href="tuesday-october-18-2022.html#transforming-the-response-variable"><i class="fa fa-check"></i>Transforming the response variable</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-october-20-2022.html"><a href="thursday-october-20-2022.html"><i class="fa fa-check"></i>Thursday, October 20, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-october-20-2022.html"><a href="thursday-october-20-2022.html#more-regression-examples"><i class="fa fa-check"></i>More regression examples</a></li>
<li class="chapter" data-level="" data-path="thursday-october-20-2022.html"><a href="thursday-october-20-2022.html#outliers"><i class="fa fa-check"></i>Outliers</a></li>
<li class="chapter" data-level="" data-path="thursday-october-20-2022.html"><a href="thursday-october-20-2022.html#simpsons-paradox"><i class="fa fa-check"></i>Simpson’s paradox</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html"><i class="fa fa-check"></i>Tuesday, October 25, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#a-regression-plane"><i class="fa fa-check"></i>A regression plane</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#fitting-a-multiple-variable-regression-model"><i class="fa fa-check"></i>Fitting a multiple variable regression model</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#should-you-remove-a-variable-from-the-model"><i class="fa fa-check"></i>Should you remove a variable from the model?</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#checking-on-the-model-assumptions"><i class="fa fa-check"></i>Checking on the model assumptions</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#using-the-model-to-make-predictions"><i class="fa fa-check"></i>Using the model to make predictions</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#collinearity"><i class="fa fa-check"></i>Collinearity</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#interactions"><i class="fa fa-check"></i>Interactions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-october-27-2022.html"><a href="thursday-october-27-2022.html"><i class="fa fa-check"></i>Thursday, October 27, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-october-27-2022.html"><a href="thursday-october-27-2022.html#removing-variables-from-a-regression-model"><i class="fa fa-check"></i>Removing variables from a regression model</a></li>
<li class="chapter" data-level="" data-path="thursday-october-27-2022.html"><a href="thursday-october-27-2022.html#the-stepwise-selection-procedure"><i class="fa fa-check"></i>The stepwise selection procedure</a></li>
<li class="chapter" data-level="" data-path="thursday-october-27-2022.html"><a href="thursday-october-27-2022.html#transforming-a-response-variable"><i class="fa fa-check"></i>Transforming a response variable</a></li>
<li class="chapter" data-level="" data-path="thursday-october-27-2022.html"><a href="thursday-october-27-2022.html#regression-trees"><i class="fa fa-check"></i>Regression trees</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-november-1-2022.html"><a href="tuesday-november-1-2022.html"><i class="fa fa-check"></i>Tuesday, November 1, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-november-1-2022.html"><a href="tuesday-november-1-2022.html#predictive-uncertainty-with-regression-trees"><i class="fa fa-check"></i>Predictive uncertainty with regression trees</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-1-2022.html"><a href="tuesday-november-1-2022.html#the-random-forest-algorithm"><i class="fa fa-check"></i>The random forest algorithm</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-1-2022.html"><a href="tuesday-november-1-2022.html#cross-validation"><i class="fa fa-check"></i>Cross validation</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-1-2022.html"><a href="tuesday-november-1-2022.html#classification-trees"><i class="fa fa-check"></i>Classification trees</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-november-3-2022.html"><a href="thursday-november-3-2022.html"><i class="fa fa-check"></i>Thursday, November 3, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-november-3-2022.html"><a href="thursday-november-3-2022.html#binary-outcomes-and-probabilities"><i class="fa fa-check"></i>Binary outcomes and probabilities</a></li>
<li class="chapter" data-level="" data-path="thursday-november-3-2022.html"><a href="thursday-november-3-2022.html#logistic-regression"><i class="fa fa-check"></i>Logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html"><i class="fa fa-check"></i>Tuesday, November 8, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html#quantifying-autocorrelation-in-spatial-data"><i class="fa fa-check"></i>Quantifying autocorrelation in spatial data</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html#spatial-data-as-polygon-areas"><i class="fa fa-check"></i>Spatial data as polygon areas</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html#nearest-neighbors"><i class="fa fa-check"></i>Nearest neighbors</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html#spatial-weights"><i class="fa fa-check"></i>Spatial weights</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html#morans-i"><i class="fa fa-check"></i>Moran’s I</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html#spatial-lag-variable"><i class="fa fa-check"></i>Spatial lag variable</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-november-10-2022.html"><a href="thursday-november-10-2022.html"><i class="fa fa-check"></i>Thursday, November 10, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-november-10-2022.html"><a href="thursday-november-10-2022.html#statistical-significance-of-spatial-autocorrelation"><i class="fa fa-check"></i>Statistical significance of spatial autocorrelation</a></li>
<li class="chapter" data-level="" data-path="thursday-november-10-2022.html"><a href="thursday-november-10-2022.html#a-monte-carlo-approach-to-inference-about-spatial-autocorrelation"><i class="fa fa-check"></i>A Monte Carlo approach to inference about spatial autocorrelation</a></li>
<li class="chapter" data-level="" data-path="thursday-november-10-2022.html"><a href="thursday-november-10-2022.html#spatial-autocorrelation-in-model-residuals"><i class="fa fa-check"></i>Spatial autocorrelation in model residuals</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-november-15-2022.html"><a href="tuesday-november-15-2022.html"><i class="fa fa-check"></i>Tuesday, November 15, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-november-15-2022.html"><a href="tuesday-november-15-2022.html#bi-variate-spatial-autocorrelation"><i class="fa fa-check"></i>Bi-variate spatial autocorrelation</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-15-2022.html"><a href="tuesday-november-15-2022.html#local-autocorrelation"><i class="fa fa-check"></i>Local autocorrelation</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-15-2022.html"><a href="tuesday-november-15-2022.html#local-regression"><i class="fa fa-check"></i>Local regression</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-15-2022.html"><a href="tuesday-november-15-2022.html#spatial-weights-1"><i class="fa fa-check"></i>Spatial weights</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-november-17-2022.html"><a href="thursday-november-17-2022.html"><i class="fa fa-check"></i>Thursday, November 17, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-november-17-2022.html"><a href="thursday-november-17-2022.html#geographic-regression"><i class="fa fa-check"></i>Geographic regression</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GEO5156: Quantitative Geography</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tuesday-october-11-2022" class="section level1 unnumbered hasAnchor">
<h1>Tuesday, October 11, 2022<a href="tuesday-october-11-2022.html#tuesday-october-11-2022" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Assignment #4, Due October 13 at 6 p.m. posted on Canvas</p>
<p>Today</p>
<p>Bayesian data analysis</p>
<ul>
<li>Distributions as building blocks</li>
<li>Bayesian computation</li>
<li>Real world example from wildlife management</li>
<li>Why use Bayesian models?</li>
</ul>
<div id="distributions-as-building-blocks" class="section level2 unnumbered hasAnchor">
<h2>Distributions as building blocks<a href="tuesday-october-11-2022.html#distributions-as-building-blocks" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Bayesian methods are used in applications ranging from predicting elections to directing self-driving cars. They are particularly important in applications where uncertainty needs to be quantified, and where there are various sources of information available on the subject of interest.</p>
<p>Bayesian methods are not routinely taught in school. While there is an increasing number of excellent resources online, if you google “Bayesian” you get lots of links to philosophical discussions about subjective vs objective methods, discourses on the differences and relative merits of frequentist vs Bayesian methods, discussions on <span class="math inline">\(p\)</span>-values vs subjective probabilities, etc.</p>
<p>With this introduction you will (1) be able to identify the important components of a Bayesian data analysis, and (2) be able to interpret and explain the components.</p>
<p>First you need to appreciate is the concept of a distribution and be familiar with common types of distributions. A distribution is like a Lego brick. It can be stacked together with other Lego bricks to create a large variety of models.</p>
<p>A distribution describes which values of a variable are common and which are less so. Averages taken from samples follow the bell-shaped normal distribution, for example. Two-thirds of all averages are within one standard deviations of the overall mean. Averages greater than three standard deviations from the mean are rare.</p>
<p>Formally, the normal distribution is defined by the following (probability) density function (pdf), where <span class="math inline">\(\mu\)</span> is the population mean and <span class="math inline">\(\sigma^2\)</span> is the variance.
<span class="math display">\[
f(y) = \frac{1}{\sigma \sqrt{2\pi}} e^{\frac{-(y-\mu)^2}{2\sigma^2}}
\]</span></p>
<p>For any value <span class="math inline">\(y\)</span>, the equation tells you what the density value <span class="math inline">\(f(y)\)</span> will be given <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>. Function values are largest when <span class="math inline">\(y\)</span> is close to <span class="math inline">\(\mu\)</span>. Note: <span class="math inline">\(e\)</span> is the base of the natural logarithm (2.71828…).</p>
<p>Fortunately you do not need to know this formula. You just need to understand its shape.</p>
<p>If a variable <span class="math inline">\(Y\)</span> is described by a normal distribution, then you write:
<span class="math display">\[
Y \sim N(\mu, \sigma^2)
\]</span></p>
<p>In particular, the normal distribution with <span class="math inline">\(\mu\)</span> = 0 and <span class="math inline">\(\sigma\)</span> = 1 is called the standard normal distribution, and is denoted as <span class="math inline">\(N(0,1)\)</span>. It’s shape is graphed as follows.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="tuesday-october-11-2022.html#cb1-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">length =</span> <span class="dv">101</span>)</span>
<span id="cb1-2"><a href="tuesday-october-11-2022.html#cb1-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb1-3"><a href="tuesday-october-11-2022.html#cb1-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, y)</span>
<span id="cb1-4"><a href="tuesday-october-11-2022.html#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="tuesday-october-11-2022.html#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-6"><a href="tuesday-october-11-2022.html#cb1-6" aria-hidden="true" tabindex="-1"></a>( p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb1-7"><a href="tuesday-october-11-2022.html#cb1-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_line</span>() )</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>Assume that test scores of an exam fit normal distributions. And that the mean test score is 72, and the standard deviation is 15.2. What is our best estimate for the percentage of all students that will score at least 84 on the exam?</p>
<p>Solution: You use the <code>pnorm()</code> function (density of the normal distribution) with argument mean equal to 72 and the argument standard deviation (<code>sd</code>) 15.2. Since you are looking for the percentage of students scoring AT LEAST 84, you are interested in the upper (right) tail of the normal distribution.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="tuesday-october-11-2022.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="at">q =</span> <span class="dv">84</span>, </span>
<span id="cb2-2"><a href="tuesday-october-11-2022.html#cb2-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean =</span> <span class="dv">72</span>, </span>
<span id="cb2-3"><a href="tuesday-october-11-2022.html#cb2-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">sd =</span> <span class="fl">15.2</span>, </span>
<span id="cb2-4"><a href="tuesday-october-11-2022.html#cb2-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.2149176</code></pre>
<p>The percentage of all students scoring at least 84 on the exam will be 21.5%.</p>
<p>Effectively, the information contained in the sample of data is reduced to a distribution with only two parameters. This represents a model for the data.</p>
<p>If the mean or standard deviation are changed, the curve changes but it remains a normal distribution (shape remains the same).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="tuesday-october-11-2022.html#cb4-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="fl">1.5</span>)</span>
<span id="cb4-2"><a href="tuesday-october-11-2022.html#cb4-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, y)</span>
<span id="cb4-3"><a href="tuesday-october-11-2022.html#cb4-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> df2, </span>
<span id="cb4-4"><a href="tuesday-october-11-2022.html#cb4-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>The two curves on the plot are members of a distributional family all having the same shape.</p>
<p>The uniform distribution is one in which all intervals of the same width are equally likely. It has two parameters <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span> where <span class="math inline">\(a\)</span> &lt; <span class="math inline">\(b\)</span> defining the end points.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="tuesday-october-11-2022.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  [1] 1.522263 2.466030 1.882633 2.675937 1.693433 2.458071 1.125551 2.874510
##  [9] 1.055481 2.999162</code></pre>
<p>The shape is described as flat.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="tuesday-october-11-2022.html#cb7-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">101</span>)</span>
<span id="cb7-2"><a href="tuesday-october-11-2022.html#cb7-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">dunif</span>(x, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">3</span>)</span>
<span id="cb7-3"><a href="tuesday-october-11-2022.html#cb7-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, y)</span>
<span id="cb7-4"><a href="tuesday-october-11-2022.html#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb7-5"><a href="tuesday-october-11-2022.html#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb7-6"><a href="tuesday-october-11-2022.html#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>The uniform distribution implies that all values are equally likely to occur. This contrasts with the normal distribution where values near the mean are more likely than those farther from it.</p>
<p>The uniform distribution used in the Bayesian context describes the situation in which you are maximally ‘non-committed.’ In other words, there is no reason to prefer one value over another between the minimum and the maximum.</p>
<p>Think of voters who are not committed to either candidate A or B. If these are the only two choices then maximally non-committed implies that they are just as likely to vote for A as they are to vote for B. Now imagine an infinite number of candidates. Then you have a uniform distribution.</p>
<p>A parametric model, like the uniform or Gaussian, is a family of distributions described using just a few parameters. Key idea: Bayesian models are built from parametric models.</p>
</div>
<div id="bayesian-computation" class="section level2 unnumbered hasAnchor">
<h2>Bayesian computation<a href="tuesday-october-11-2022.html#bayesian-computation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Bayesian models are ‘generative.’ If you know the parameters then you can generate data: Parameters (<span class="math inline">\(\mu\)</span>, <span class="math inline">\(\theta\)</span>, <span class="math inline">\(\sigma\)</span>) –&gt; generative model –&gt; data (5, 3, 4, 0, 1, …): Going from parameters to data is called <em>Monte Carlo simulation</em>.</p>
<p>Example: If you assume that the rate of hurricanes in the United States is 1.7 hurricanes/year (<span class="math inline">\(\lambda\)</span>) and you assume the generative model is the Poisson distribution then you generate data using</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="tuesday-october-11-2022.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rpois</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">lambda =</span> <span class="fl">1.7</span>)</span></code></pre></div>
<pre><code>##   [1] 0 0 5 1 5 1 2 1 2 2 1 2 0 1 2 1 2 2 1 3 3 2 3 2 3 5 1 0 1 2 2 2 2 1 4 5 3
##  [38] 2 2 1 2 2 1 2 1 2 0 2 1 1 1 2 1 1 2 4 1 1 0 1 2 1 2 1 2 2 0 3 0 1 3 2 2 2
##  [75] 0 2 4 2 0 3 2 0 1 0 3 2 0 1 1 2 1 4 4 2 1 2 2 2 4 0</code></pre>
<p>Alternatively if you assume the rate of hurricanes is described by a gamma distribution with shape parameter = 3.5 and scale parameter = .5 then you generate data using</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="tuesday-october-11-2022.html#cb10-1" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">shape =</span> <span class="fl">3.5</span>, <span class="at">scale =</span> .<span class="dv">5</span>)</span>
<span id="cb10-2"><a href="tuesday-october-11-2022.html#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rpois</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">lambda =</span> lambda)</span></code></pre></div>
<pre><code>##   [1] 3 2 0 3 2 2 1 1 1 3 2 2 3 1 0 3 1 2 2 0 0 2 5 1 0 0 3 0 3 1 2 3 0 2 1 0 0
##  [38] 0 0 2 0 4 1 3 1 0 0 0 0 2 1 2 2 0 1 2 4 3 1 1 0 0 0 2 3 1 1 7 1 2 1 1 0 2
##  [75] 3 1 1 1 0 0 0 8 0 1 0 2 0 0 2 3 3 2 1 3 1 2 0 5 1 1</code></pre>
<p>In this case you first generate a bunch of <span class="math inline">\(\lambda\)</span>s from a gamma distribution and then for each <span class="math inline">\(\lambda\)</span> you generate a count.</p>
<p>If you know the data then you can estimate the parameters: data (5, 3, 4, 0, 1, …) –&gt; generative model –&gt; Parameters (<span class="math inline">\(\mu\)</span>, <span class="math inline">\(\theta\)</span>, <span class="math inline">\(\sigma\)</span>): Going from data to parameters is called <em>Bayesian data analysis</em>.</p>
<p>Example: How many blue marbles?</p>
<p>Consider an example from <em>Statistical Rethinking</em> (McElreth 2016). You have a bag containing four marbles. Each marble is either blue (B) or white (W). You don’t know how many blue marbles are in the bag.</p>
<p>It could be either 0, 1, 2, 3, or 4. Only five possibilities. It can’t be 5, 6, or 3.2.</p>
<p>Your goal is to figure out the likely number of blue marbles given the evidence (data). What is the likely number before you have further evidence?</p>
<p>You gather evidence (collect data) by drawing a sequence of three marbles. The marbles are pulled from the bag, one at a time, then returned to the bag, and the bag is shaken before drawing another.</p>
<p>Say you draw the sequence [B W B]. How many ways are their to produce this draw?</p>
<p>If you conjecture that the bag contains 0 blue marbles, then how many ways could you have gotten [B W B]? Simple: zero.</p>
<p>If you conjecture that the bag contains 1 blue and 3 white marbles (B W W W) then how many ways could you have gotten [B W B]? Starting from left to right in our sequence [B W B] you see there is only 1 way to get a blue, 3 ways to get a white, and again only 1 way to get a blue. You multiply these ways together 1 x 3 x 1 = 3 to get the total number of ways to get [B W B] GIVEN that the bag contains one blue and four white marbles (B W W W).</p>
<p>If you conjecture that the bag contains 2 blue and 2 white marbles (B B W W) then how many ways could you have gotten [B W B]? Starting from left to right in our sequence [B W B] you see there is 2 ways to get a blue, 2 ways to get a white, and again 2 ways to get a blue. You multiply these ways together 2 x 2 x 2 = 8 to get the total number of ways to get [B W B] GIVEN that the bag contains two blue and two white marbles (B B W W).</p>
<p>Here is the full table of ways to produce that draw given each possible bag composition.</p>
<table>
<thead>
<tr class="header">
<th>conjecture</th>
<th>ways to produce [B W B]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(W W W W)</td>
<td>0 x 4 x 0 = 0</td>
</tr>
<tr class="even">
<td>(B W W W)</td>
<td>1 x 3 x 1 = 3</td>
</tr>
<tr class="odd">
<td>(B B W W)</td>
<td>2 x 2 x 2 = 8</td>
</tr>
<tr class="even">
<td>(B B B W)</td>
<td>3 x 1 x 3 = 9</td>
</tr>
<tr class="odd">
<td>(B B B B)</td>
<td>4 x 0 x 4 = 0</td>
</tr>
</tbody>
</table>
<p>So what is the most likely number of blue marbles now?</p>
<p>What happens when you draw another marble? You update the counts. How? You multiply the prior counts by the new count. The old counts act as your prior counts.</p>
<p>Here is an example after drawing an additional blue marble [B].</p>
<table>
<thead>
<tr class="header">
<th>conjecture</th>
<th>ways to produce [B]</th>
<th>previous counts</th>
<th>new count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(W W W W)</td>
<td>0</td>
<td>0</td>
<td>0 x 0 = 0</td>
</tr>
<tr class="even">
<td>(B W W W)</td>
<td>1</td>
<td>3</td>
<td>1 x 3 = 3</td>
</tr>
<tr class="odd">
<td>(B B W W)</td>
<td>2</td>
<td>8</td>
<td>2 x 8 = 16</td>
</tr>
<tr class="even">
<td>(B B B W)</td>
<td>3</td>
<td>9</td>
<td>3 x 9 = 27</td>
</tr>
<tr class="odd">
<td>(B B B B)</td>
<td>4</td>
<td>0</td>
<td>0 x 4 = 0</td>
</tr>
</tbody>
</table>
<p>Now, out of the five possibilities concerning the frequency of blue and white marbles in the bag, the conjecture of three blues and one white has pulled further into the lead.</p>
<p>Logically, what you have done is expressed as: Plausibility of (B W W W) after seeing [B] is proportional to the ways (B W W W) can produce [B] X prior plausibility of (B W W W).</p>
<p>But these are just counts and plausibilities; you want probabilities. To make this change first let’s define <span class="math inline">\(p\)</span> as proportion of blue marbles in the bag and <span class="math inline">\(D_{new}\)</span> as the data.</p>
<p>You now have: Plausibility of <span class="math inline">\(p\)</span> after <span class="math inline">\(D_{new}\)</span> is proportional to the ways <span class="math inline">\(p\)</span> can produce <span class="math inline">\(D_{new}\)</span> X prior plausibility of <span class="math inline">\(p\)</span>.</p>
<p>You standardize the plausibility so that the sum of the plausibilities over all conjectures equals one. To standardize, you add all the ways to produce [B W B], one for each <span class="math inline">\(p\)</span>, then divide each way by this sum.</p>
<p>For example there is three ways to produce [B W B] if the bag contains (B W W W), eights ways to produce [B W B] if the bag contains (B B W W) and nine ways to produce [B W B] if the bag contains (B B B W) 3 + 8 + 9 = 20. 3/20 = .15, 8/20 = .4, and 9/20 = .45.</p>
<table>
<thead>
<tr class="header">
<th>possible combinations</th>
<th><span class="math inline">\(p\)</span></th>
<th>ways to produce data</th>
<th>probability</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(W W W W)</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>(B W W W)</td>
<td>.25</td>
<td>3</td>
<td>.15</td>
</tr>
<tr class="odd">
<td>(B B W W)</td>
<td>.5</td>
<td>8</td>
<td>.40</td>
</tr>
<tr class="even">
<td>(B B B W)</td>
<td>.75</td>
<td>9</td>
<td>.45</td>
</tr>
<tr class="odd">
<td>(B B B B)</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>This process is equivalent to: Plausibility of <span class="math inline">\(p\)</span> after new data <span class="math inline">\(D_{new}\)</span> = (ways <span class="math inline">\(p\)</span> can produce <span class="math inline">\(D_{new}\)</span> X prior plausibility <span class="math inline">\(p\)</span>) / sum of plausibilities.</p>
<p>All these calculations correspond to quantities in applied probability theory.</p>
<ul>
<li>The conjectured proportion of blue marbles, <span class="math inline">\(p\)</span>, is called a <em>parameter</em>.</li>
<li>The relative number of ways that <span class="math inline">\(p\)</span> can produce the data is called the <em>likelihood</em>.</li>
<li>The prior plausibility of a specific <span class="math inline">\(p\)</span> is called the <em>prior probability</em>.</li>
<li>The updated plausibility of any specific <span class="math inline">\(p\)</span> is called the <em>posterior probability</em>.</li>
</ul>
<p>Example: What percentage of the globe is covered by water?</p>
<p>Imagine a globe of the world. You want to know how much of the globe is water. Your strategy is to throw the globe up, catch it, and note the surface (water or land) under the right index finger. Suppose you do this globe tossing 9 times.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="tuesday-october-11-2022.html#cb12-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">toss =</span> <span class="fu">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;w&quot;</span>))</span></code></pre></div>
<p>On the first toss your finger touches water, on the next toss it touches land, etc.</p>
<p>You then rephrase in terms of trials and the cumulative counts of water which you denote as the number of success (<code>n_success</code>).</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="tuesday-october-11-2022.html#cb13-1" aria-hidden="true" tabindex="-1"></a>( d <span class="ot">&lt;-</span> d <span class="sc">|&gt;</span> </span>
<span id="cb13-2"><a href="tuesday-october-11-2022.html#cb13-2" aria-hidden="true" tabindex="-1"></a> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">n_trials  =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>,</span>
<span id="cb13-3"><a href="tuesday-october-11-2022.html#cb13-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">n_success =</span> <span class="fu">cumsum</span>(toss <span class="sc">==</span> <span class="st">&quot;w&quot;</span>)) )</span></code></pre></div>
<pre><code>##   toss n_trials n_success
## 1    w        1         1
## 2    l        2         1
## 3    w        3         2
## 4    w        4         3
## 5    w        5         4
## 6    l        6         4
## 7    w        7         5
## 8    l        8         5
## 9    w        9         6</code></pre>
<p>To get the logic machine started you need to make assumptions. These assumptions constitute the model. An ideal loop for designing a Bayesian model has three steps</p>
<ol style="list-style-type: decimal">
<li>Data story
<ul>
<li>Describe aspects of the underlying reality as well as the sampling process.</li>
<li>Then translate into a formal probability model.</li>
</ul></li>
</ol>
<p>Framework for interpretation. Helps with finding additional questions that must be answered because hypotheses are often vague.</p>
<ol start="2" style="list-style-type: decimal">
<li>Update
<ul>
<li>Bayesian models begin with a set of plausibilities assigned to each possibility called the <em>prior</em>.</li>
<li>Update those plausibilities based on the data to give <em>posterior</em> plausibility.</li>
</ul></li>
<li>Evaluate
<ul>
<li>Certainty is no guarantee that the model is good or accurate.</li>
<li>Critique the model.</li>
<li>Check model’s adequacy for some purpose, or in light of stuff you don’t know.</li>
</ul></li>
</ol>
<p>How did the data come to be? Describe aspects of the underlying reality as well as the sampling process, sufficient enough for specifying an algorithm to simulate new data. Write out the data story for this activity.</p>
<p>A Bayesian model begins with one set of plausibilities assigned to each possible result, the prior plausibilities. These values are then updated in light of data to produce posterior plausibilities. This process is called <code>Bayesian updating</code>.</p>
<p>Here is the code for our proportion of water example.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="tuesday-october-11-2022.html#cb15-1" aria-hidden="true" tabindex="-1"></a>sequence_length <span class="ot">&lt;-</span> <span class="dv">50</span>   <span class="co"># how many points to calculate probability for</span></span>
<span id="cb15-2"><a href="tuesday-october-11-2022.html#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="tuesday-october-11-2022.html#cb15-3" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb15-4"><a href="tuesday-october-11-2022.html#cb15-4" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">expand</span>(n_trials, </span>
<span id="cb15-5"><a href="tuesday-october-11-2022.html#cb15-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_water =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> sequence_length)) <span class="sc">|&gt;</span> </span>
<span id="cb15-6"><a href="tuesday-october-11-2022.html#cb15-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(d, <span class="at">by =</span> <span class="st">&quot;n_trials&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-7"><a href="tuesday-october-11-2022.html#cb15-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(p_water) <span class="sc">|&gt;</span> </span>
<span id="cb15-8"><a href="tuesday-october-11-2022.html#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lag is the *previous* value</span></span>
<span id="cb15-9"><a href="tuesday-october-11-2022.html#cb15-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lagged_n_success =</span> dplyr<span class="sc">::</span><span class="fu">lag</span>(n_success, <span class="at">k =</span> <span class="dv">1</span>), </span>
<span id="cb15-10"><a href="tuesday-october-11-2022.html#cb15-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">lagged_n_trials  =</span> dplyr<span class="sc">::</span><span class="fu">lag</span>(n_trials,  <span class="at">k =</span> <span class="dv">1</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-11"><a href="tuesday-october-11-2022.html#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># if first time, flat prior. </span></span>
<span id="cb15-12"><a href="tuesday-october-11-2022.html#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># otherwise use previous posterior as new prior.</span></span>
<span id="cb15-13"><a href="tuesday-october-11-2022.html#cb15-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb15-14"><a href="tuesday-october-11-2022.html#cb15-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">prior =</span> <span class="fu">ifelse</span>(n_trials <span class="sc">==</span> <span class="dv">1</span>, </span>
<span id="cb15-15"><a href="tuesday-october-11-2022.html#cb15-15" aria-hidden="true" tabindex="-1"></a>                               .<span class="dv">5</span>,</span>
<span id="cb15-16"><a href="tuesday-october-11-2022.html#cb15-16" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">dbinom</span>(<span class="at">x =</span> lagged_n_success, </span>
<span id="cb15-17"><a href="tuesday-october-11-2022.html#cb15-17" aria-hidden="true" tabindex="-1"></a>                               <span class="at">size =</span> lagged_n_trials, </span>
<span id="cb15-18"><a href="tuesday-october-11-2022.html#cb15-18" aria-hidden="true" tabindex="-1"></a>                               <span class="at">prob =</span> p_water)),</span>
<span id="cb15-19"><a href="tuesday-october-11-2022.html#cb15-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">strip =</span> stringr<span class="sc">::</span><span class="fu">str_c</span>(<span class="st">&quot;n = &quot;</span>, n_trials), <span class="co"># which draw is it?</span></span>
<span id="cb15-20"><a href="tuesday-october-11-2022.html#cb15-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">likelihood =</span> <span class="fu">dbinom</span>(<span class="at">x =</span> n_success, </span>
<span id="cb15-21"><a href="tuesday-october-11-2022.html#cb15-21" aria-hidden="true" tabindex="-1"></a>                             <span class="at">size =</span> n_trials, </span>
<span id="cb15-22"><a href="tuesday-october-11-2022.html#cb15-22" aria-hidden="true" tabindex="-1"></a>                             <span class="at">prob =</span> p_water)) <span class="sc">|&gt;</span> <span class="co"># calculate likelihood for current draw</span></span>
<span id="cb15-23"><a href="tuesday-october-11-2022.html#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># normalize the prior and the likelihood, making them probabilities </span></span>
<span id="cb15-24"><a href="tuesday-october-11-2022.html#cb15-24" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(n_trials) <span class="sc">|&gt;</span> </span>
<span id="cb15-25"><a href="tuesday-october-11-2022.html#cb15-25" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">prior =</span> prior <span class="sc">/</span> <span class="fu">sum</span>(prior),</span>
<span id="cb15-26"><a href="tuesday-october-11-2022.html#cb15-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">likelihood =</span> likelihood <span class="sc">/</span> <span class="fu">sum</span>(likelihood)) <span class="sc">|&gt;</span>   </span>
<span id="cb15-27"><a href="tuesday-october-11-2022.html#cb15-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> p_water)) <span class="sc">+</span></span>
<span id="cb15-28"><a href="tuesday-october-11-2022.html#cb15-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> prior), <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb15-29"><a href="tuesday-october-11-2022.html#cb15-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> likelihood)) <span class="sc">+</span></span>
<span id="cb15-30"><a href="tuesday-october-11-2022.html#cb15-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;proportion water&quot;</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb15-31"><a href="tuesday-october-11-2022.html#cb15-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;probability&quot;</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb15-32"><a href="tuesday-october-11-2022.html#cb15-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>strip, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-33"><a href="tuesday-october-11-2022.html#cb15-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>Look at the upper left panel. The dashed horizontal line is your prior probability before gathering any data. It codifies your lack of knowledge about the proportion of water by stating that it is equally likely to be any proportion (value between 0 and 1).</p>
<p>The solid line indicates the probabilities after you observe ‘water’ (“w”) on our first trial (n = 1). The highest probability is that the entire globe is water and the lowest probability (0) is that there is no water so the line slopes from lower left to upper right.</p>
<p>The next panel (n = 2) shows what happens to this diagonal line (now shown as dashed because it is now the prior) after you observe ‘land’ (“l”) on your second trial. The highest probability is now .5 with lowest probabilities (0) for both the case of no water and no land. In the next panel (n = 3) you see that the probability distribution shifts again after observing ‘water’ on your third trial.</p>
<p>As more and more data are collected the difference between the prior (previous) and posterior (current) diminishes. Note that these Bayesian estimates are valid and can be interpreted for any sample size. This is in contrast to interpretations around a minimum number of samples in non-Bayesian contexts. In non-Bayesian contexts, statistical inference is justified by behavior at large samples sizes (this is called ‘asymptotic behavior’).</p>
<p>You get answers by counting things rather than by solving equations.</p>
</div>
<div id="real-world-example-from-wildlife-management" class="section level2 unnumbered hasAnchor">
<h2>Real world example from wildlife management<a href="tuesday-october-11-2022.html#real-world-example-from-wildlife-management" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A common problem in wildlife management is the estimation of a species abundance. For example: Start by catching and marking 20 fish. Then after some time catch another 20 fish and count how many of them have a mark. Suppose that out of the 20 fish caught 5 are marked. How many fish are in the lake?</p>
<p>Parameter = Number of fish in the lake (the unknown that you want to estimate)
Generative Model: First mark 20 fish and release them back into the lake, then recapture 20 fish and count how many are marked.</p>
<p>Data: Five of the 20 fish were marked.</p>
<p>Here is what you will do to answer the question how many fish are in the lake.</p>
<ol style="list-style-type: decimal">
<li>Draw a random sample from the prior distribution on the parameter.</li>
<li>Plug in each sampled value (draw) into the generative model to get a vector of ‘fake’ data. For example: If the number of fish in the lake is 80 you might get four marked fish on our recapture sample. If the number of fish is only 30, you might get 13 marked fish on our sample, etc. That makes sense, right?</li>
<li>Keep only those parameter values that generated the data that was actually observed (5 out of the 20 sampled).</li>
</ol>
<p>Let’s see this in action with code. Draw a large (<code>M = 100000</code>) sample from the prior distribution (discrete uniform) on the parameter representing the number of fish in the lake (<code>priorNF</code>). Here you use the <code>sample()</code> function on a vector of counts between 21 and 250.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="tuesday-october-11-2022.html#cb16-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb16-2"><a href="tuesday-october-11-2022.html#cb16-2" aria-hidden="true" tabindex="-1"></a>priorNF <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">21</span><span class="sc">:</span><span class="dv">250</span>, <span class="at">size =</span> M, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-3"><a href="tuesday-october-11-2022.html#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(priorNF, <span class="at">n =</span> <span class="dv">20</span>)</span></code></pre></div>
<pre><code>##  [1]  48 221  84  76 112 249 209 126 115 162 230 137 164 143  87  47 210  88 168
## [20] 135</code></pre>
<p>The result is a vector of length <code>M</code> containing counts with values between 21 and 250. What is the shape on the distribution of values?</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="tuesday-october-11-2022.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">table</span>(priorNF))</span></code></pre></div>
<pre><code>## priorNF
##  21  22  23  24  25  26 
## 465 451 438 423 431 440</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="tuesday-october-11-2022.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(<span class="fu">table</span>(priorNF))</span></code></pre></div>
<pre><code>## priorNF
## 245 246 247 248 249 250 
## 404 414 424 433 425 431</code></pre>
<p>Plot a histogram of the parameter values.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="tuesday-october-11-2022.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb22-2"><a href="tuesday-october-11-2022.html#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="tuesday-october-11-2022.html#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">as.data.frame</span>(priorNF), </span>
<span id="cb22-4"><a href="tuesday-october-11-2022.html#cb22-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(priorNF)) <span class="sc">+</span></span>
<span id="cb22-5"><a href="tuesday-october-11-2022.html#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">10</span>, <span class="at">boundary =</span> <span class="dv">20</span>, </span>
<span id="cb22-6"><a href="tuesday-october-11-2022.html#cb22-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;salmon&quot;</span>) <span class="sc">+</span></span>
<span id="cb22-7"><a href="tuesday-october-11-2022.html#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Number of Fish in the Lake&quot;</span>) <span class="sc">+</span></span>
<span id="cb22-8"><a href="tuesday-october-11-2022.html#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="at">label =</span> <span class="st">&quot;Prior distribution on the number of fish in the lake&quot;</span>) <span class="sc">+</span></span>
<span id="cb22-9"><a href="tuesday-october-11-2022.html#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>Uniform distribution. This is how you should start if you have no knowledge about how many fish are in the lake. You are maximally non-committal to any particular count.</p>
<p>Next you define the generative model. Here you create a function that takes a value for the unknown parameter (number of fish in the lake) as input and returns a data value. The data value is the number of tagged fish on recapture.</p>
<p>Suppose for example that the number of fish in the lake is in fact 63. Then you set up a vector of length 63 where 20 are labeled as marked and 63 - 20 = 43 are labeled as not marked.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="tuesday-october-11-2022.html#cb23-1" aria-hidden="true" tabindex="-1"></a>fish <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="fu">c</span>(<span class="dv">63</span> <span class="sc">-</span> <span class="dv">20</span>, <span class="dv">20</span>))</span>
<span id="cb23-2"><a href="tuesday-october-11-2022.html#cb23-2" aria-hidden="true" tabindex="-1"></a>fish</span></code></pre></div>
<pre><code>##  [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
## [39] 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</code></pre>
<p>Then you take a sample of size 20 without replacement (this is equivalent to catching 20 fish in a lake with 63 fish of which twenty of them are marked) from this vector and add the sampled values. This value represents the number of fish caught that were marked.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="tuesday-october-11-2022.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">sample</span>(fish, <span class="at">size =</span> <span class="dv">20</span>))</span></code></pre></div>
<pre><code>## [1] 8</code></pre>
<p>Sample and sum again.</p>
<p>Let’s save 1000 of these and then make a histogram. The <code>for(){}</code> function is used to create a loop over this process of sampling and summing. Here it says to repeat the sample and sum 1000 times. <code>j</code> is used as a ‘dummy’ indexing the set of integers between 1 and 1000. Each time you get a sum <code>nM</code> you include it as an element in the vector <code>nMarked</code>.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="tuesday-october-11-2022.html#cb27-1" aria-hidden="true" tabindex="-1"></a>nMarked <span class="ot">&lt;-</span> <span class="fu">numeric</span>()</span>
<span id="cb27-2"><a href="tuesday-october-11-2022.html#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb27-3"><a href="tuesday-october-11-2022.html#cb27-3" aria-hidden="true" tabindex="-1"></a>  nM <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">sample</span>(fish, <span class="dv">20</span>))</span>
<span id="cb27-4"><a href="tuesday-october-11-2022.html#cb27-4" aria-hidden="true" tabindex="-1"></a>  nMarked <span class="ot">&lt;-</span> <span class="fu">c</span>(nMarked, nM)</span>
<span id="cb27-5"><a href="tuesday-october-11-2022.html#cb27-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-6"><a href="tuesday-october-11-2022.html#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="tuesday-october-11-2022.html#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">as.data.frame</span>(nMarked), </span>
<span id="cb27-8"><a href="tuesday-october-11-2022.html#cb27-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(nMarked)) <span class="sc">+</span></span>
<span id="cb27-9"><a href="tuesday-october-11-2022.html#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span>.<span class="dv">5</span>, <span class="fl">12.5</span>, <span class="dv">1</span>),</span>
<span id="cb27-10"><a href="tuesday-october-11-2022.html#cb27-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;salmon&quot;</span>) <span class="sc">+</span></span>
<span id="cb27-11"><a href="tuesday-october-11-2022.html#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Number of Recaptured Fish&quot;</span>) <span class="sc">+</span></span>
<span id="cb27-12"><a href="tuesday-october-11-2022.html#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="at">label =</span> <span class="st">&quot;Conditional likelihood on the number of recaptured fish&quot;</span>) <span class="sc">+</span></span>
<span id="cb27-13"><a href="tuesday-october-11-2022.html#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>This tells us that <em>IF</em> the number of fish in the lake is 63, the <em>most likely</em> number of marked recaptures would be either 6 or 7.</p>
<p>But what if the number of fish in the lake is 64 or 74, or any other number? That is exactly what you want to estimate. So you create a function from your sampling code.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="tuesday-october-11-2022.html#cb28-1" aria-hidden="true" tabindex="-1"></a>pickFish <span class="ot">&lt;-</span> <span class="cf">function</span>(priorNF){</span>
<span id="cb28-2"><a href="tuesday-october-11-2022.html#cb28-2" aria-hidden="true" tabindex="-1"></a>  fish <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="fu">c</span>(priorNF <span class="sc">-</span> <span class="dv">20</span>, <span class="dv">20</span>))</span>
<span id="cb28-3"><a href="tuesday-october-11-2022.html#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="fu">sample</span>(fish, <span class="dv">20</span>))</span>
<span id="cb28-4"><a href="tuesday-october-11-2022.html#cb28-4" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
<p>The <code>function()</code> function takes as it’s single input the prior guess at the number of fish in the lake. The two lines of code between the left <code>{</code> and the right <code>}</code> samples and sums. The only thing returned by the function is the number of marked fish on recapture. The function is assigned to the object you call <code>pickFish()</code>.</p>
<p>To apply the function include a guess at the number of fish in the lake.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="tuesday-october-11-2022.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pickFish</span>(<span class="dv">104</span>)</span></code></pre></div>
<pre><code>## [1] 7</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="tuesday-october-11-2022.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pickFish</span>(priorNF[<span class="dv">10</span>])</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<p>Now you can simulate the data. The data are the number of marked fish on the recapture given a parameter value. The parameter values come from the prior distribution. You start by ‘initializing’ the object <code>nMarked</code>.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="tuesday-october-11-2022.html#cb33-1" aria-hidden="true" tabindex="-1"></a>nMarked <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb33-2"><a href="tuesday-october-11-2022.html#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M) {</span>
<span id="cb33-3"><a href="tuesday-october-11-2022.html#cb33-3" aria-hidden="true" tabindex="-1"></a>  nMarked[i] <span class="ot">&lt;-</span> <span class="fu">pickFish</span>(priorNF[i])</span>
<span id="cb33-4"><a href="tuesday-october-11-2022.html#cb33-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-5"><a href="tuesday-october-11-2022.html#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(nMarked)</span></code></pre></div>
<pre><code>## [1] 11  3  5  6  4  2</code></pre>
<p>The <code>for</code> loop uses the <code>pickFish()</code> function for each count in the prior and there are <code>M</code> of them. The output of applying the function is saved, element by element, in the vector <code>nMarked</code>.</p>
<p>Finally, you <em>keep</em> only those parameter values that resulted in the data you actually observed (5 marked fish re-caught) and plot those as a histogram.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="tuesday-october-11-2022.html#cb35-1" aria-hidden="true" tabindex="-1"></a>postNF <span class="ot">&lt;-</span> priorNF[nMarked <span class="sc">==</span> <span class="dv">5</span>]</span>
<span id="cb35-2"><a href="tuesday-october-11-2022.html#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">as.data.frame</span>(postNF), </span>
<span id="cb35-3"><a href="tuesday-october-11-2022.html#cb35-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(postNF)) <span class="sc">+</span></span>
<span id="cb35-4"><a href="tuesday-october-11-2022.html#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">10</span>, <span class="at">boundary =</span> <span class="dv">20</span>, </span>
<span id="cb35-5"><a href="tuesday-october-11-2022.html#cb35-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;salmon&quot;</span>) <span class="sc">+</span></span>
<span id="cb35-6"><a href="tuesday-october-11-2022.html#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Number of Fish in the Lake&quot;</span>) <span class="sc">+</span></span>
<span id="cb35-7"><a href="tuesday-october-11-2022.html#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="at">label =</span> <span class="st">&quot;Posterior distribution on the number of fish in the lake&quot;</span>) <span class="sc">+</span></span>
<span id="cb35-8"><a href="tuesday-october-11-2022.html#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>The result is a distribution on the unknown parameter (number of fish in the lake). It is called the posterior distribution. It shows us how many times the particular value of number of fish in the lake results in 5 out of 20 marked on recapture.</p>
<p>It tells us that it is unlikely there are more than 200 or less than 50 fish in the lake.</p>
<p>For insight, put the prior and posterior values into a data frame.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="tuesday-october-11-2022.html#cb36-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Distribution =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;(A) Prior Distribution&quot;</span>, </span>
<span id="cb36-2"><a href="tuesday-october-11-2022.html#cb36-2" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">&quot;(B) Posterior Distribution&quot;</span>), </span>
<span id="cb36-3"><a href="tuesday-october-11-2022.html#cb36-3" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">c</span>(M, <span class="fu">length</span>(postNF))), </span>
<span id="cb36-4"><a href="tuesday-october-11-2022.html#cb36-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Values =</span> <span class="fu">c</span>(priorNF, postNF))</span>
<span id="cb36-5"><a href="tuesday-october-11-2022.html#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code>##             Distribution Values
## 1 (A) Prior Distribution     48
## 2 (A) Prior Distribution    221
## 3 (A) Prior Distribution     84
## 4 (A) Prior Distribution     76
## 5 (A) Prior Distribution    112
## 6 (A) Prior Distribution    249</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="tuesday-october-11-2022.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(df)</span></code></pre></div>
<pre><code>##                      Distribution Values
## 108142 (B) Posterior Distribution     97
## 108143 (B) Posterior Distribution    191
## 108144 (B) Posterior Distribution     72
## 108145 (B) Posterior Distribution     76
## 108146 (B) Posterior Distribution    147
## 108147 (B) Posterior Distribution     92</code></pre>
<p>Then plot the prior and posterior distributions side by side.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="tuesday-october-11-2022.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, </span>
<span id="cb40-2"><a href="tuesday-october-11-2022.html#cb40-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Values)) <span class="sc">+</span></span>
<span id="cb40-3"><a href="tuesday-october-11-2022.html#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> (..density..) <span class="sc">*</span> <span class="dv">20</span>), </span>
<span id="cb40-4"><a href="tuesday-october-11-2022.html#cb40-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">binwidth =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb40-5"><a href="tuesday-october-11-2022.html#cb40-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;salmon&quot;</span>) <span class="sc">+</span></span>
<span id="cb40-6"><a href="tuesday-october-11-2022.html#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">250</span>)) <span class="sc">+</span></span>
<span id="cb40-7"><a href="tuesday-october-11-2022.html#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Distribution, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb40-8"><a href="tuesday-october-11-2022.html#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Number of Fish in the Lake&quot;</span>) <span class="sc">+</span></span>
<span id="cb40-9"><a href="tuesday-october-11-2022.html#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Probability&quot;</span>) <span class="sc">+</span></span>
<span id="cb40-10"><a href="tuesday-october-11-2022.html#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="at">label =</span> <span class="st">&quot;How many fish are there in the lake?&quot;</span>) <span class="sc">+</span></span>
<span id="cb40-11"><a href="tuesday-october-11-2022.html#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 4 rows containing missing values (geom_bar).</code></pre>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>As an answer to the question how many fish are in the lake, you start by thinking that there is no preference for any number between 20 and 250. That uniform uncertainty is the prior. It is quantified as a uniform distribution.</p>
<p>Then, after collecting data and combining the information with the prior, the uncertainty is reduced. The reduction in uncertainty is seen in the posterior distribution.</p>
<p>The most likely value for the number of fish in the lake is somewhere between 70 and 120 as seen by location of the tallest bar in the histogram. There is a 50% chance that the number of fish in the lake is between 78 and 132. This is obtained by using the <code>quantile()</code> function on the posterior values stored in <code>postNF</code>.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="tuesday-october-11-2022.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(postNF, <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">25</span>, .<span class="dv">75</span>))</span></code></pre></div>
<pre><code>## 25% 75% 
##  77 132</code></pre>
<p>If you want to be 95% certain of the correct answer to the question then you increase the interval to</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="tuesday-october-11-2022.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(postNF, <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>))</span></code></pre></div>
<pre><code>##  2.5% 97.5% 
##    54   219</code></pre>
<p>If you need to make a single best guess you take the median of the posterior.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="tuesday-october-11-2022.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(postNF)</span></code></pre></div>
<pre><code>## [1] 100</code></pre>
<p>Let’s look at the bars centered on the value of 100 fish. You start with the prior. The probability that there are 100 fish (more precisely between 90 &amp; 110 fish) in the lake before you mark and recapture is .09 (9%). You write this as</p>
<p>P(100 fish) = 9%</p>
<p>After observing 5 marked fish in 20 on the recapture the probability increases to 20%. You write this as</p>
<p>P(100 fish | 5 marked recaptured) = 20%</p>
<p>Combining the prior with data results in the posterior. P(<span class="math inline">\(\theta\)</span> | D) <span class="math inline">\(\propto\)</span> P(<span class="math inline">\(\theta\)</span>) <span class="math inline">\(\times\)</span> P(D | <span class="math inline">\(\theta\)</span>): Bayes Theorem.</p>
<p>In this example you used a capture-recapture model with one parameter. But the general method works on any generative model and with any number of parameters.</p>
<p>The specific computational method (approximate Bayes calculation: ABC) you used only works in rare cases.</p>
</div>
<div id="why-use-bayesian-models" class="section level2 unnumbered hasAnchor">
<h2>Why use Bayesian models?<a href="tuesday-october-11-2022.html#why-use-bayesian-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You can build more flexible models. You can use models to answer specific questions in a natural way. For example, what is the probability that the number of fish in the lake exceeds 200?</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="tuesday-october-11-2022.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(postNF <span class="sc">&gt;</span> <span class="dv">200</span>)<span class="sc">/</span><span class="fu">length</span>(postNF) <span class="sc">*</span> <span class="dv">100</span></span></code></pre></div>
<pre><code>## [1] 4.602921</code></pre>
<p>Less the 5% chance. Note: There is no reference null hypothesis or <span class="math inline">\(p\)</span>-value.</p>
<p>Suppose you get some additional data. Let’s say you catch another sample of fish from the lake and find that 6 are marked. You can use your posterior distribution as the new prior distribution.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="tuesday-october-11-2022.html#cb50-1" aria-hidden="true" tabindex="-1"></a>nMarked <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb50-2"><a href="tuesday-october-11-2022.html#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(postNF)) {</span>
<span id="cb50-3"><a href="tuesday-october-11-2022.html#cb50-3" aria-hidden="true" tabindex="-1"></a>  nMarked[i] <span class="ot">&lt;-</span> <span class="fu">pickFish</span>(postNF[i])</span>
<span id="cb50-4"><a href="tuesday-october-11-2022.html#cb50-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-5"><a href="tuesday-october-11-2022.html#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="tuesday-october-11-2022.html#cb50-6" aria-hidden="true" tabindex="-1"></a>post2NF <span class="ot">&lt;-</span> postNF[nMarked <span class="sc">==</span> <span class="dv">6</span>]</span></code></pre></div>
<p>Again put the prior and posterior in a single data frame and plot.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="tuesday-october-11-2022.html#cb51-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Distribution =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;(A) Prior Distribution&quot;</span>, <span class="st">&quot;(B) Posterior Distribution&quot;</span>), </span>
<span id="cb51-2"><a href="tuesday-october-11-2022.html#cb51-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">c</span>(<span class="fu">length</span>(postNF), <span class="fu">length</span>(post2NF))), </span>
<span id="cb51-3"><a href="tuesday-october-11-2022.html#cb51-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Values =</span> <span class="fu">c</span>(postNF, post2NF))</span>
<span id="cb51-4"><a href="tuesday-october-11-2022.html#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, </span>
<span id="cb51-5"><a href="tuesday-october-11-2022.html#cb51-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Values)) <span class="sc">+</span></span>
<span id="cb51-6"><a href="tuesday-october-11-2022.html#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> (..density..) <span class="sc">*</span> <span class="dv">20</span>), </span>
<span id="cb51-7"><a href="tuesday-october-11-2022.html#cb51-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">binwidth =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb51-8"><a href="tuesday-october-11-2022.html#cb51-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;salmon&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-9"><a href="tuesday-october-11-2022.html#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">250</span>)) <span class="sc">+</span></span>
<span id="cb51-10"><a href="tuesday-october-11-2022.html#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Distribution, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb51-11"><a href="tuesday-october-11-2022.html#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Number of Fish in the Lake&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-12"><a href="tuesday-october-11-2022.html#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Probability&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-13"><a href="tuesday-october-11-2022.html#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="at">label =</span> <span class="st">&quot;How many fish are there in the lake?&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-14"><a href="tuesday-october-11-2022.html#cb51-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 4 rows containing missing values (geom_bar).</code></pre>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<p>The new data pushes the posterior median toward a lower count relative to the posterior median from the original model. It also considerably reduces the uncertainty. Given this model, the probability that there are more than 200 fish in the lake is about .1%, down from 5%.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="tuesday-october-11-2022.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(post2NF)</span></code></pre></div>
<pre><code>## [1] 79</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="tuesday-october-11-2022.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(post2NF <span class="sc">&gt;</span> <span class="dv">200</span>)<span class="sc">/</span><span class="fu">length</span>(post2NF) <span class="sc">*</span> <span class="dv">100</span></span></code></pre></div>
<pre><code>## [1] 0</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="thursday-september-29-2022.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tuesday-october-11-2022-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
