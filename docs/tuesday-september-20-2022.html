<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Tuesday, September 20, 2022 | GEO5156: Quantitative Geography</title>
  <meta name="description" content="Tuesday, September 20, 2022 | GEO5156: Quantitative Geography" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Tuesday, September 20, 2022 | GEO5156: Quantitative Geography" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="jelsner/QG-2022" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Tuesday, September 20, 2022 | GEO5156: Quantitative Geography" />
  
  
  

<meta name="author" content="James B. Elsner" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tuesday-september-13-2022.html"/>
<link rel="next" href="thursday-september-22-2022.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Quantitative Geography</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html"><i class="fa fa-check"></i>Syllabus</a>
<ul>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#geo5165c-quantitative-geography"><i class="fa fa-check"></i>GEO5165C: Quantitative Geography</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#contact-information"><i class="fa fa-check"></i>Contact information</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#course-description-and-expected-learning-outcomes"><i class="fa fa-check"></i>Course description and expected learning outcomes</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#grades-and-ethics"><i class="fa fa-check"></i>Grades and ethics</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#schedule-subject-to-change-with-notice"><i class="fa fa-check"></i>Schedule (subject to change with notice)</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#deeper-dives"><i class="fa fa-check"></i>Deeper dives</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html"><i class="fa fa-check"></i>Tuesday, August 23, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#what-is-this-course"><i class="fa fa-check"></i>What is this course?</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#where-are-the-materials-for-this-course"><i class="fa fa-check"></i>Where are the materials for this course?</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#get-the-syllabus"><i class="fa fa-check"></i>Get the syllabus</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#getting-setup"><i class="fa fa-check"></i>Getting setup</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#getting-to-know-rstudios-integrated-development-environment-ide"><i class="fa fa-check"></i>Getting to know RStudio’s integrated development environment (IDE)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-august-25-2022.html"><a href="thursday-august-25-2022.html"><i class="fa fa-check"></i>Thursday, August 25, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-august-25-2022.html"><a href="thursday-august-25-2022.html#data-science"><i class="fa fa-check"></i>Data science</a></li>
<li class="chapter" data-level="" data-path="thursday-august-25-2022.html"><a href="thursday-august-25-2022.html#structure-of-markdown-files"><i class="fa fa-check"></i>Structure of markdown files</a></li>
<li class="chapter" data-level="" data-path="thursday-august-25-2022.html"><a href="thursday-august-25-2022.html#how-to-make-a-plot"><i class="fa fa-check"></i>How to make a plot</a></li>
<li class="chapter" data-level="" data-path="thursday-august-25-2022.html"><a href="thursday-august-25-2022.html#getting-started-using-r"><i class="fa fa-check"></i>Getting started using R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-august-30-2022.html"><a href="tuesday-august-30-2022.html"><i class="fa fa-check"></i>Tuesday, August 30, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-august-30-2022.html"><a href="tuesday-august-30-2022.html#graphing-examples"><i class="fa fa-check"></i>Graphing examples</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-30-2022.html"><a href="tuesday-august-30-2022.html#introduction-to-working-with-base-r"><i class="fa fa-check"></i>Introduction to working with base R</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-30-2022.html"><a href="tuesday-august-30-2022.html#data-as-vectors"><i class="fa fa-check"></i>Data as vectors</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-september-1-2022.html"><a href="thursday-september-1-2022.html"><i class="fa fa-check"></i>Thursday, September 1, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-september-1-2022.html"><a href="thursday-september-1-2022.html#statistical-summaries-of-data"><i class="fa fa-check"></i>Statistical summaries of data</a></li>
<li class="chapter" data-level="" data-path="thursday-september-1-2022.html"><a href="thursday-september-1-2022.html#structured-data"><i class="fa fa-check"></i>Structured data</a></li>
<li class="chapter" data-level="" data-path="thursday-september-1-2022.html"><a href="thursday-september-1-2022.html#tables"><i class="fa fa-check"></i>Tables</a></li>
<li class="chapter" data-level="" data-path="thursday-september-1-2022.html"><a href="thursday-september-1-2022.html#assignment-1"><i class="fa fa-check"></i>Assignment #1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-september-6-2022.html"><a href="tuesday-september-6-2022.html"><i class="fa fa-check"></i>Tuesday, September 6, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-september-6-2022.html"><a href="tuesday-september-6-2022.html#getting-data-into-r"><i class="fa fa-check"></i>Getting data into R</a></li>
<li class="chapter" data-level="" data-path="tuesday-september-6-2022.html"><a href="tuesday-september-6-2022.html#data-frames"><i class="fa fa-check"></i>Data frames</a></li>
<li class="chapter" data-level="" data-path="tuesday-september-6-2022.html"><a href="tuesday-september-6-2022.html#piping-your-commands"><i class="fa fa-check"></i>Piping your commands</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-september-8-2022.html"><a href="thursday-september-8-2022.html"><i class="fa fa-check"></i>Thursday, September 8, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-september-8-2022.html"><a href="thursday-september-8-2022.html#data-transformation-with-dplyr"><i class="fa fa-check"></i>Data transformation with {dplyr}</a></li>
<li class="chapter" data-level="" data-path="thursday-september-8-2022.html"><a href="thursday-september-8-2022.html#from-data-import-to-final-plot"><i class="fa fa-check"></i>From data import to final plot</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-september-13-2022.html"><a href="tuesday-september-13-2022.html"><i class="fa fa-check"></i>Tuesday, September 13, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-september-13-2022.html"><a href="tuesday-september-13-2022.html#data-visualization"><i class="fa fa-check"></i>Data visualization</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-september-20-2022.html"><a href="tuesday-september-20-2022.html"><i class="fa fa-check"></i>Tuesday, September 20, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-september-20-2022.html"><a href="tuesday-september-20-2022.html#comparing-distributions"><i class="fa fa-check"></i>Comparing distributions</a></li>
<li class="chapter" data-level="" data-path="tuesday-september-20-2022.html"><a href="tuesday-september-20-2022.html#visualizing-uncertainty"><i class="fa fa-check"></i>Visualizing uncertainty</a></li>
<li class="chapter" data-level="" data-path="tuesday-september-20-2022.html"><a href="tuesday-september-20-2022.html#simple-feature-data-frames"><i class="fa fa-check"></i>Simple feature data frames</a></li>
<li class="chapter" data-level="" data-path="tuesday-september-20-2022.html"><a href="tuesday-september-20-2022.html#making-a-boundary-map"><i class="fa fa-check"></i>Making a boundary map</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-september-22-2022.html"><a href="thursday-september-22-2022.html"><i class="fa fa-check"></i>Thursday, September 22, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-september-22-2022.html"><a href="thursday-september-22-2022.html#simple-feature-data-frames-1"><i class="fa fa-check"></i>Simple feature data frames</a></li>
<li class="chapter" data-level="" data-path="thursday-september-22-2022.html"><a href="thursday-september-22-2022.html#making-a-boundary-map-1"><i class="fa fa-check"></i>Making a boundary map</a></li>
<li class="chapter" data-level="" data-path="thursday-september-22-2022.html"><a href="thursday-september-22-2022.html#inset-maps"><i class="fa fa-check"></i>Inset maps</a></li>
<li class="chapter" data-level="" data-path="thursday-september-22-2022.html"><a href="thursday-september-22-2022.html#map-projections"><i class="fa fa-check"></i>Map projections</a></li>
<li class="chapter" data-level="" data-path="thursday-september-22-2022.html"><a href="thursday-september-22-2022.html#bivariate-maps"><i class="fa fa-check"></i>Bivariate maps</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-september-27-2022.html"><a href="tuesday-september-27-2022.html"><i class="fa fa-check"></i>Tuesday, September 27, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-september-27-2022.html"><a href="tuesday-september-27-2022.html#making-maps-using-functions-from-the-tmap-package"><i class="fa fa-check"></i>Making maps using functions from the {tmap} package</a></li>
<li class="chapter" data-level="" data-path="tuesday-september-27-2022.html"><a href="tuesday-september-27-2022.html#calculations-using-the-geometry-simple-feature-column"><i class="fa fa-check"></i>Calculations using the geometry simple feature column</a></li>
<li class="chapter" data-level="" data-path="tuesday-september-27-2022.html"><a href="tuesday-september-27-2022.html#making-raster-maps"><i class="fa fa-check"></i>Making raster maps</a></li>
<li class="chapter" data-level="" data-path="tuesday-september-27-2022.html"><a href="tuesday-september-27-2022.html#spatial-density-maps-extra-material"><i class="fa fa-check"></i>Spatial density maps (extra material)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-september-29-2022.html"><a href="thursday-september-29-2022.html"><i class="fa fa-check"></i>Thursday, September 29, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-september-29-2022.html"><a href="thursday-september-29-2022.html#one-sample-test-of-the-population-mean"><i class="fa fa-check"></i>One-sample test of the population mean</a></li>
<li class="chapter" data-level="" data-path="thursday-september-29-2022.html"><a href="thursday-september-29-2022.html#about-p-values"><i class="fa fa-check"></i>About p-values</a></li>
<li class="chapter" data-level="" data-path="thursday-september-29-2022.html"><a href="thursday-september-29-2022.html#graphical-inference"><i class="fa fa-check"></i>Graphical inference</a></li>
<li class="chapter" data-level="" data-path="thursday-september-29-2022.html"><a href="thursday-september-29-2022.html#two-sample-test-for-the-difference-in-population-means"><i class="fa fa-check"></i>Two-sample test for the difference in population means</a></li>
<li class="chapter" data-level="" data-path="thursday-september-29-2022.html"><a href="thursday-september-29-2022.html#test-of-equal-variance"><i class="fa fa-check"></i>Test of equal variance</a></li>
<li class="chapter" data-level="" data-path="thursday-september-29-2022.html"><a href="thursday-september-29-2022.html#wilcoxon-mann-whitney-u-non-parameteric-test-of-difference-in-means"><i class="fa fa-check"></i>Wilcoxon (Mann-Whitney U) non-parameteric test of difference in means</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-october-4-2022.html"><a href="tuesday-october-4-2022.html"><i class="fa fa-check"></i>Tuesday, October 4, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-october-4-2022.html"><a href="tuesday-october-4-2022.html#paired-observations"><i class="fa fa-check"></i>Paired observations</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-4-2022.html"><a href="tuesday-october-4-2022.html#chi-squared-test-for-independence"><i class="fa fa-check"></i>Chi-squared test for independence</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-october-6-2022.html"><a href="thursday-october-6-2022.html"><i class="fa fa-check"></i>Thursday, October 6, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-october-6-2022.html"><a href="thursday-october-6-2022.html#bayesian-data-analysis"><i class="fa fa-check"></i>Bayesian data analysis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-october-11-2022.html"><a href="tuesday-october-11-2022.html"><i class="fa fa-check"></i>Tuesday, October 11, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-october-11-2022.html"><a href="tuesday-october-11-2022.html#more-examples-of-bayesian-data-analyses"><i class="fa fa-check"></i>More examples of Bayesian data analyses</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-october-13-2022.html"><a href="thursday-october-13-2022.html"><i class="fa fa-check"></i>Thursday, October 13, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-october-13-2022.html"><a href="thursday-october-13-2022.html#linear-regression-a-t-test-by-another-name"><i class="fa fa-check"></i>Linear regression: A t test by another name</a></li>
<li class="chapter" data-level="" data-path="thursday-october-13-2022.html"><a href="thursday-october-13-2022.html#motivation-for-the-regression-model"><i class="fa fa-check"></i>Motivation for the regression model</a></li>
<li class="chapter" data-level="" data-path="thursday-october-13-2022.html"><a href="thursday-october-13-2022.html#making-predictions-with-the-regression-model"><i class="fa fa-check"></i>Making predictions with the regression model</a></li>
<li class="chapter" data-level="" data-path="thursday-october-13-2022.html"><a href="thursday-october-13-2022.html#uncertainty-about-the-regression-model-coefficients"><i class="fa fa-check"></i>Uncertainty about the regression model coefficients</a></li>
<li class="chapter" data-level="" data-path="thursday-october-13-2022.html"><a href="thursday-october-13-2022.html#bootstrapping-the-uncertainty"><i class="fa fa-check"></i>Bootstrapping the uncertainty</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-october-18-2022.html"><a href="tuesday-october-18-2022.html"><i class="fa fa-check"></i>Tuesday, October 18, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-october-18-2022.html"><a href="tuesday-october-18-2022.html#uncertainty-about-a-particular-predicted-value"><i class="fa fa-check"></i>Uncertainty about a particular predicted value</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-18-2022.html"><a href="tuesday-october-18-2022.html#model-adequacy"><i class="fa fa-check"></i>Model Adequacy</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-18-2022.html"><a href="tuesday-october-18-2022.html#transforming-the-response-variable"><i class="fa fa-check"></i>Transforming the response variable</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-october-20-2022.html"><a href="thursday-october-20-2022.html"><i class="fa fa-check"></i>Thursday, October 20, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-october-20-2022.html"><a href="thursday-october-20-2022.html#more-regression-examples"><i class="fa fa-check"></i>More regression examples</a></li>
<li class="chapter" data-level="" data-path="thursday-october-20-2022.html"><a href="thursday-october-20-2022.html#outliers"><i class="fa fa-check"></i>Outliers</a></li>
<li class="chapter" data-level="" data-path="thursday-october-20-2022.html"><a href="thursday-october-20-2022.html#simpsons-paradox"><i class="fa fa-check"></i>Simpson’s paradox</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html"><i class="fa fa-check"></i>Tuesday, October 25, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#a-regression-plane"><i class="fa fa-check"></i>A regression plane</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#fitting-a-multiple-variable-regression-model"><i class="fa fa-check"></i>Fitting a multiple variable regression model</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#should-you-remove-a-variable-from-the-model"><i class="fa fa-check"></i>Should you remove a variable from the model?</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#checking-on-the-model-assumptions"><i class="fa fa-check"></i>Checking on the model assumptions</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#using-the-model-to-make-predictions"><i class="fa fa-check"></i>Using the model to make predictions</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#collinearity"><i class="fa fa-check"></i>Collinearity</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#interactions"><i class="fa fa-check"></i>Interactions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-october-27-2022.html"><a href="thursday-october-27-2022.html"><i class="fa fa-check"></i>Thursday, October 27, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-october-27-2022.html"><a href="thursday-october-27-2022.html#removing-variables-from-a-regression-model"><i class="fa fa-check"></i>Removing variables from a regression model</a></li>
<li class="chapter" data-level="" data-path="thursday-october-27-2022.html"><a href="thursday-october-27-2022.html#the-stepwise-selection-procedure"><i class="fa fa-check"></i>The stepwise selection procedure</a></li>
<li class="chapter" data-level="" data-path="thursday-october-27-2022.html"><a href="thursday-october-27-2022.html#transforming-a-response-variable"><i class="fa fa-check"></i>Transforming a response variable</a></li>
<li class="chapter" data-level="" data-path="thursday-october-27-2022.html"><a href="thursday-october-27-2022.html#regression-trees"><i class="fa fa-check"></i>Regression trees</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-november-1-2022.html"><a href="tuesday-november-1-2022.html"><i class="fa fa-check"></i>Tuesday, November 1, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-november-1-2022.html"><a href="tuesday-november-1-2022.html#predictive-uncertainty-with-regression-trees"><i class="fa fa-check"></i>Predictive uncertainty with regression trees</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-1-2022.html"><a href="tuesday-november-1-2022.html#the-random-forest-algorithm"><i class="fa fa-check"></i>The random forest algorithm</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-1-2022.html"><a href="tuesday-november-1-2022.html#cross-validation"><i class="fa fa-check"></i>Cross validation</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-1-2022.html"><a href="tuesday-november-1-2022.html#classification-trees"><i class="fa fa-check"></i>Classification trees</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-november-3-2022.html"><a href="thursday-november-3-2022.html"><i class="fa fa-check"></i>Thursday, November 3, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-november-3-2022.html"><a href="thursday-november-3-2022.html#binary-outcomes-and-probabilities"><i class="fa fa-check"></i>Binary outcomes and probabilities</a></li>
<li class="chapter" data-level="" data-path="thursday-november-3-2022.html"><a href="thursday-november-3-2022.html#logistic-regression"><i class="fa fa-check"></i>Logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html"><i class="fa fa-check"></i>Tuesday, November 8, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html#quantifying-autocorrelation-in-spatial-data"><i class="fa fa-check"></i>Quantifying autocorrelation in spatial data</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html#spatial-data-as-polygon-areas"><i class="fa fa-check"></i>Spatial data as polygon areas</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html#nearest-neighbors"><i class="fa fa-check"></i>Nearest neighbors</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html#spatial-weights"><i class="fa fa-check"></i>Spatial weights</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html#morans-i"><i class="fa fa-check"></i>Moran’s I</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html#spatial-lag-variable"><i class="fa fa-check"></i>Spatial lag variable</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-november-10-2022.html"><a href="thursday-november-10-2022.html"><i class="fa fa-check"></i>Thursday, November 10, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-november-10-2022.html"><a href="thursday-november-10-2022.html#statistical-significance-of-spatial-autocorrelation"><i class="fa fa-check"></i>Statistical significance of spatial autocorrelation</a></li>
<li class="chapter" data-level="" data-path="thursday-november-10-2022.html"><a href="thursday-november-10-2022.html#a-monte-carlo-approach-to-inference-about-spatial-autocorrelation"><i class="fa fa-check"></i>A Monte Carlo approach to inference about spatial autocorrelation</a></li>
<li class="chapter" data-level="" data-path="thursday-november-10-2022.html"><a href="thursday-november-10-2022.html#spatial-autocorrelation-in-model-residuals"><i class="fa fa-check"></i>Spatial autocorrelation in model residuals</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-november-15-2022.html"><a href="tuesday-november-15-2022.html"><i class="fa fa-check"></i>Tuesday, November 15, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-november-15-2022.html"><a href="tuesday-november-15-2022.html#bi-variate-spatial-autocorrelation"><i class="fa fa-check"></i>Bi-variate spatial autocorrelation</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-15-2022.html"><a href="tuesday-november-15-2022.html#local-autocorrelation"><i class="fa fa-check"></i>Local autocorrelation</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-15-2022.html"><a href="tuesday-november-15-2022.html#local-regression"><i class="fa fa-check"></i>Local regression</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-15-2022.html"><a href="tuesday-november-15-2022.html#spatial-weights-1"><i class="fa fa-check"></i>Spatial weights</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-november-17-2022.html"><a href="thursday-november-17-2022.html"><i class="fa fa-check"></i>Thursday, November 17, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-november-17-2022.html"><a href="thursday-november-17-2022.html#geographic-regression"><i class="fa fa-check"></i>Geographic regression</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GEO5156: Quantitative Geography</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tuesday-september-20-2022" class="section level1 unnumbered hasAnchor">
<h1>Tuesday, September 20, 2022<a href="tuesday-september-20-2022.html#tuesday-september-20-2022" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Today</p>
<ul>
<li>Comparing distributions</li>
<li>Visualizing uncertainty</li>
<li>Simple feature data frames</li>
<li>Making a boundary map</li>
</ul>
<div id="comparing-distributions" class="section level2 unnumbered hasAnchor">
<h2>Comparing distributions<a href="tuesday-september-20-2022.html#comparing-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Consider again the Florida rainfall data. Import the data and apply the missing value label to any value that is recorded as -9.900.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="tuesday-september-20-2022.html#cb1-1" aria-hidden="true" tabindex="-1"></a>loc <span class="ot">&lt;-</span> <span class="st">&quot;http://myweb.fsu.edu/jelsner/temp/data/FLprecip.txt&quot;</span></span>
<span id="cb1-2"><a href="tuesday-september-20-2022.html#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="tuesday-september-20-2022.html#cb1-3" aria-hidden="true" tabindex="-1"></a>FLp.df <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_table</span>(loc, </span>
<span id="cb1-4"><a href="tuesday-september-20-2022.html#cb1-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">na =</span> <span class="st">&quot;-9.900&quot;</span>)</span></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   Year = col_double(),
##   Jan = col_double(),
##   Feb = col_double(),
##   Mar = col_double(),
##   Apr = col_double(),
##   May = col_double(),
##   Jun = col_double(),
##   Jul = col_double(),
##   Aug = col_double(),
##   Sep = col_double(),
##   Oct = col_double(),
##   Nov = col_double(),
##   Dec = col_double()
## )</code></pre>
<p>Then use <code>ggplot()</code> and <code>geom_histogram()</code> functions to make a histogram of rainfall during March and add a label on the horizontal axis (x-axis). Here you assign the plot to an object called <code>p1</code>.</p>
<p>A list object is created in your environment, but nothing is plotted until you type the object name.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="tuesday-september-20-2022.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-2"><a href="tuesday-september-20-2022.html#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="tuesday-september-20-2022.html#cb3-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> FLp.df) <span class="sc">+</span></span>
<span id="cb3-4"><a href="tuesday-september-20-2022.html#cb3-4" aria-hidden="true" tabindex="-1"></a>             <span class="fu">geom_histogram</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Mar), </span>
<span id="cb3-5"><a href="tuesday-september-20-2022.html#cb3-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">bins =</span> <span class="dv">11</span>, </span>
<span id="cb3-6"><a href="tuesday-september-20-2022.html#cb3-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fill =</span> <span class="st">&quot;green3&quot;</span>,</span>
<span id="cb3-7"><a href="tuesday-september-20-2022.html#cb3-7" aria-hidden="true" tabindex="-1"></a>                                <span class="at">col =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb3-8"><a href="tuesday-september-20-2022.html#cb3-8" aria-hidden="true" tabindex="-1"></a>             <span class="fu">xlab</span>(<span class="st">&quot;March Rainfall in Florida (in)&quot;</span>) </span>
<span id="cb3-9"><a href="tuesday-september-20-2022.html#cb3-9" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>The histogram shows the shape of the distribution. The distribution contains all 118 years of March rainfall. Most years have rainfall values between 2 and 4 inches. A few years have values that exceed 7.5 inches.</p>
<p>The average, median, and standard deviations can be obtained using {dplyr} functions.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="tuesday-september-20-2022.html#cb4-1" aria-hidden="true" tabindex="-1"></a>FLp.df <span class="sc">|&gt;</span></span>
<span id="cb4-2"><a href="tuesday-september-20-2022.html#cb4-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Mar) <span class="sc">|&gt;</span></span>
<span id="cb4-3"><a href="tuesday-september-20-2022.html#cb4-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">avg =</span> <span class="fu">mean</span>(Mar),</span>
<span id="cb4-4"><a href="tuesday-september-20-2022.html#cb4-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">med =</span> <span class="fu">median</span>(Mar),</span>
<span id="cb4-5"><a href="tuesday-september-20-2022.html#cb4-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sd =</span> <span class="fu">sd</span>(Mar),</span>
<span id="cb4-6"><a href="tuesday-september-20-2022.html#cb4-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">min =</span> <span class="fu">min</span>(Mar),</span>
<span id="cb4-7"><a href="tuesday-september-20-2022.html#cb4-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">max =</span> <span class="fu">max</span>(Mar))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 5
##     avg   med    sd   min   max
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1  3.66  3.35  1.95 0.496  8.70</code></pre>
<p>The average is larger than the median and the histogram is not symmetric. That is, the number of cases with with low rainfall exceeds the number of cases with heavy rainfall.</p>
<p>The histogram helps describe the statistical <em>distribution</em> of the values. Data from samples often form similar patterns. These patterns are known as ‘distributions’, because they describe how the data are ‘distributed’ across the range of possible values.</p>
<p>To see this you can generate values from various standard distributions and then make a histogram. These standard distributions are used in statistical analysis as reference distributions. This means that they allow researchers to compare data and groups of samples more easily.</p>
<p>For instance you generate values from a normal (Gaussian distribution) with the <code>rnorm()</code> function by specifying the mean (<code>mean =</code>) and the standard deviation (<code>sd =</code>). It is also known as the bell curve, because of its shape, and the Gaussian distribution after the mathematician Carl F Gauss, who first described it.</p>
<p>Here you do this using the mean and standard deviation from the rainfall values. Since there are 118 March rainfall values (one for each year) you set <code>n = 118</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="tuesday-september-20-2022.html#cb6-1" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">118</span>, </span>
<span id="cb6-2"><a href="tuesday-september-20-2022.html#cb6-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean =</span> <span class="fl">3.65</span>, </span>
<span id="cb6-3"><a href="tuesday-september-20-2022.html#cb6-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fl">1.95</span>)</span>
<span id="cb6-4"><a href="tuesday-september-20-2022.html#cb6-4" aria-hidden="true" tabindex="-1"></a>nd</span></code></pre></div>
<pre><code>##   [1]  4.46605055  5.06390495  4.96230010  5.56020564  8.40585726  3.56353223
##   [7]  3.70648413  3.90410861  4.98646540  4.07477130  6.72289460  2.95528683
##  [13]  4.30071467  2.54055533  2.74475510  4.60297433  5.39444024  4.02550891
##  [19]  3.77998944  5.75823770  1.51099497  4.30035832  2.02575249  0.40054164
##  [25]  3.39571724  2.54399152  6.05595397  3.72123125  2.77994942  3.63695069
##  [31]  1.40565498  2.54935235  3.32105821  6.12874764  1.41765499  4.43621796
##  [37]  0.50473553  2.71922033  4.90628835  4.99125923  4.40826790  7.66385170
##  [43]  4.49326187 -0.05083542  7.14046349  1.43924254  2.47345493  0.24333819
##  [49]  3.99101210  5.64757230  4.85134232  5.34458679 -1.16445482  2.25615245
##  [55]  5.22299392  4.07468083  0.52140306  3.24344142  0.05601952  3.76489091
##  [61]  3.50193564  3.96314874  3.38342410  4.07320950  7.14348167  2.03368273
##  [67]  4.52673464  4.35849310  4.96845149  7.27427479  4.00806367  1.64419039
##  [73]  6.23006995  0.10706398  4.01923515  5.13204412  2.99742123  4.23175822
##  [79]  4.18986388  3.79013087  4.80795094  4.66218847  8.99859200  4.28945534
##  [85]  1.83023488  2.51897344  0.05979132  1.15857118  5.87786254  3.75728704
##  [91]  1.38590721  2.66011150  5.17919933  5.56172281  3.13884609  4.09655354
##  [97]  2.39208007  3.64124704  5.91084104  1.92020014  2.79904079  2.05148319
## [103]  2.47985102  1.84389126  6.30478657  3.93291082  3.95318543  5.45292177
## [109]  4.66472825  2.74289581  3.37985506  3.83782139  7.60240214  2.67527177
## [115]  3.08427532  8.06339492  7.35943058  3.02810973</code></pre>
<p>Collectively these values look quite a bit like the actual rainfall. Let’s make a histogram from these 118 values and assign it to <code>p2</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="tuesday-september-20-2022.html#cb8-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(nd)</span>
<span id="cb8-2"><a href="tuesday-september-20-2022.html#cb8-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df) <span class="sc">+</span></span>
<span id="cb8-3"><a href="tuesday-september-20-2022.html#cb8-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_histogram</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> nd), </span>
<span id="cb8-4"><a href="tuesday-september-20-2022.html#cb8-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">bins =</span> <span class="dv">11</span>, </span>
<span id="cb8-5"><a href="tuesday-september-20-2022.html#cb8-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">col =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-6"><a href="tuesday-september-20-2022.html#cb8-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">xlab</span>(<span class="st">&quot;Gaussian Distribution&quot;</span>)</span>
<span id="cb8-7"><a href="tuesday-september-20-2022.html#cb8-7" aria-hidden="true" tabindex="-1"></a>p2</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Let’s do the same for a set of values from a uniform distribution and from a gamma distribution.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="tuesday-september-20-2022.html#cb9-1" aria-hidden="true" tabindex="-1"></a>ud <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">118</span>,</span>
<span id="cb9-2"><a href="tuesday-september-20-2022.html#cb9-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">min =</span> .<span class="dv">5</span>, </span>
<span id="cb9-3"><a href="tuesday-september-20-2022.html#cb9-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">max =</span> <span class="fl">8.7</span>)</span>
<span id="cb9-4"><a href="tuesday-september-20-2022.html#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="tuesday-september-20-2022.html#cb9-5" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df) <span class="sc">+</span></span>
<span id="cb9-6"><a href="tuesday-september-20-2022.html#cb9-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_histogram</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> ud), </span>
<span id="cb9-7"><a href="tuesday-september-20-2022.html#cb9-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">bins =</span> <span class="dv">11</span>, </span>
<span id="cb9-8"><a href="tuesday-september-20-2022.html#cb9-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">col =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-9"><a href="tuesday-september-20-2022.html#cb9-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">xlab</span>(<span class="st">&quot;Uniform Distribution&quot;</span>)</span>
<span id="cb9-10"><a href="tuesday-september-20-2022.html#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="tuesday-september-20-2022.html#cb9-11" aria-hidden="true" tabindex="-1"></a>gd <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="at">n =</span> <span class="dv">118</span>, </span>
<span id="cb9-12"><a href="tuesday-september-20-2022.html#cb9-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="fl">3.2</span>,</span>
<span id="cb9-13"><a href="tuesday-september-20-2022.html#cb9-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">rate =</span> .<span class="dv">9</span>)</span>
<span id="cb9-14"><a href="tuesday-september-20-2022.html#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="tuesday-september-20-2022.html#cb9-15" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df) <span class="sc">+</span></span>
<span id="cb9-16"><a href="tuesday-september-20-2022.html#cb9-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_histogram</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> gd), </span>
<span id="cb9-17"><a href="tuesday-september-20-2022.html#cb9-17" aria-hidden="true" tabindex="-1"></a>                       <span class="at">bins =</span> <span class="dv">11</span>, </span>
<span id="cb9-18"><a href="tuesday-september-20-2022.html#cb9-18" aria-hidden="true" tabindex="-1"></a>                       <span class="at">col =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-19"><a href="tuesday-september-20-2022.html#cb9-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">xlab</span>(<span class="st">&quot;Gamma Distribution&quot;</span>)</span></code></pre></div>
<p>Now put all four plots on a single graph. You do this with the {patchwork} package.</p>
<p>The package gives operators like <code>+</code> and <code>/</code> different meanings when applied to ggplot objects.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="tuesday-september-20-2022.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb10-2"><a href="tuesday-september-20-2022.html#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="tuesday-september-20-2022.html#cb10-3" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">+</span> p2) <span class="sc">/</span> (p3 <span class="sc">+</span> p4)</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>What distribution best matches the shape of the March rainfall values?</p>
<p>Standard distributions share a number of characteristics.</p>
<ul>
<li><p>A clear mathematical definition. Their shape reflects just a few parameters, such as mean and standard deviation (for the normal distribution) or variance (for the chi-squared distribution).</p></li>
<li><p>Established theoretical properties. We know a lot about these distributions (for example, the normal curve is symmetrical).</p></li>
<li><p>They are good estimations for real data. In a sample of real-world data, it is impossible to get an exact normal distribution. However, these distributions are good approximations of real data.</p></li>
</ul>
<p>A box plot graphically illustrates summary statistics. The summary statistics include the minimum value, the maximum value, the 1st &amp; 3rd quartile values, and the median value.</p>
<p>Perhaps the most import scientific graph is the scatter plot which shows the relationship between two numeric variables. It plots the values of one variable against the values of the other as points <span class="math inline">\((x_i, y_i)\)</span> in a Cartesian plane.</p>
<p>For example, to show the relationship between April and September values of rainfall you type</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="tuesday-september-20-2022.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(FLp.df) <span class="sc">+</span> </span>
<span id="cb11-2"><a href="tuesday-september-20-2022.html#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Apr, <span class="at">y =</span> Sep)) <span class="sc">+</span> </span>
<span id="cb11-3"><a href="tuesday-september-20-2022.html#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;April Rainfall (in)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb11-4"><a href="tuesday-september-20-2022.html#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;September Rainfall (in)&quot;</span>)</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>The plot shows that dry Aprils tend to be followed by dry Septembers and wet Aprils tend to be followed by wet Septembers.</p>
<p>There is a direct (or positive) relationship between the two variables although the points are scattered widely indicating the relationship is loose.</p>
<p>If your goal is to model the relationship, you plot the dependent variable (the variable you are interested in modeling) on the vertical axis.</p>
<p>Here you put the September values on the vertical axis since a predictive model would use April values to predict September values because April comes before September in the calendar year.</p>
<p>If the points have a natural ordering then you use the <code>geom_line()</code> function. For example, to plot the September Rainfall values as a time series type</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="tuesday-september-20-2022.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(FLp.df) <span class="sc">+</span> </span>
<span id="cb12-2"><a href="tuesday-september-20-2022.html#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Sep)) <span class="sc">+</span> </span>
<span id="cb12-3"><a href="tuesday-september-20-2022.html#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Year&quot;</span>) <span class="sc">+</span> </span>
<span id="cb12-4"><a href="tuesday-september-20-2022.html#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;September Rainfall (in)&quot;</span>)</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Rainfall values fluctuate from one September to the next, but there does not appear to be a long-term trend. With time series data it is better to connect the values with lines rather than use points unless values are missing.</p>
<p>Create a plot of the May values of the North Atlantic oscillation (NAO) with Year on the horizontal axis. Add appropriate axis labels.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="tuesday-september-20-2022.html#cb13-1" aria-hidden="true" tabindex="-1"></a>loc <span class="ot">&lt;-</span> <span class="st">&quot;http://myweb.fsu.edu/jelsner/temp/data/NAO.txt&quot;</span></span>
<span id="cb13-2"><a href="tuesday-september-20-2022.html#cb13-2" aria-hidden="true" tabindex="-1"></a>NAO.df <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_table</span>(<span class="at">file =</span> loc)</span>
<span id="cb13-3"><a href="tuesday-september-20-2022.html#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(NAO.df, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> May)) <span class="sc">+</span> </span>
<span id="cb13-4"><a href="tuesday-september-20-2022.html#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb13-5"><a href="tuesday-september-20-2022.html#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Year&quot;</span>) <span class="sc">+</span> </span>
<span id="cb13-6"><a href="tuesday-september-20-2022.html#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;North Atlantic Oscillation (s.d.)&quot;</span>)</span></code></pre></div>
<p>Let’s return to the <code>mpg</code> data frame. The data frame contains different automobiles by who made it, the model, engine size, mileage, class, etc.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="tuesday-september-20-2022.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mpg)</span></code></pre></div>
<pre><code>##  [1] &quot;manufacturer&quot; &quot;model&quot;        &quot;displ&quot;        &quot;year&quot;         &quot;cyl&quot;         
##  [6] &quot;trans&quot;        &quot;drv&quot;          &quot;cty&quot;          &quot;hwy&quot;          &quot;fl&quot;          
## [11] &quot;class&quot;</code></pre>
<p>Let’s start with a scatter plot showing highway mileage on the vertical axis and engine size on the horizontal axis.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="tuesday-september-20-2022.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span></span>
<span id="cb16-2"><a href="tuesday-september-20-2022.html#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy), </span>
<span id="cb16-3"><a href="tuesday-september-20-2022.html#cb16-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>You add a third variable, like <code>class</code>, to a two dimensional scatterplot by mapping it to an aesthetic. An aesthetic is a visual property of the objects in our plot. Aesthetics include things like the size, the shape, or the color of our points. You can display a point in different ways by changing the levels of its aesthetic properties (e.g., changing the level by size, color, type).</p>
<p>For example, you map the colors of our points to the <code>class</code> variable to reveal the class of each car.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="tuesday-september-20-2022.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb17-2"><a href="tuesday-september-20-2022.html#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, </span>
<span id="cb17-3"><a href="tuesday-september-20-2022.html#cb17-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">y =</span> hwy, </span>
<span id="cb17-4"><a href="tuesday-september-20-2022.html#cb17-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">color =</span> class))</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>To map an aesthetic to a variable, associate the name of the aesthetic to the name of the variable inside <code>aes()</code>. Note in the previous plot <code>color =</code> was specified outside <code>aes()</code>.</p>
<p><code>ggplot()</code> will automatically assign a unique level of the aesthetic (here a unique color) to each unique value of the variable, a process known as scaling. <code>ggplot()</code> will also add a legend that explains which levels correspond to which values.</p>
<p>The colors show that many of the unusual points are two-seater cars. Sports cars have large engines like SUVs and pickup trucks, but small bodies like midsize and compact cars, which improves their gas mileage.</p>
<p>One way to add additional variables is with aesthetics. Another way, particularly useful for categorical variables, is to split the plot into facets, subplots that each display one subset of the data.</p>
<p>To facet a plot by a single variable, use <code>facet_wrap()</code>. The first argument of <code>facet_wrap()</code> should be a formula, which you create with <code>~</code> (tilde) followed by a variable name (here ‘formula’ is the name of a data structure in R, not a synonym for ‘equation’). The variable that you pass to <code>facet_wrap()</code> should be discrete.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="tuesday-september-20-2022.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb18-2"><a href="tuesday-september-20-2022.html#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb18-3"><a href="tuesday-september-20-2022.html#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> class, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>To facet a plot on the combination of two variables, add <code>facet_grid()</code> to the plot call. The first argument of <code>facet_grid()</code> is also a formula. This time the formula should contain two variable names separated by a <code>~</code> with the first variable named varying in the vertical direction and the second varying in the horizontal direction.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="tuesday-september-20-2022.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb19-2"><a href="tuesday-september-20-2022.html#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb19-3"><a href="tuesday-september-20-2022.html#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(drv <span class="sc">~</span> cyl)</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>Here <code>drv</code> refers to the drive train: front-wheel (<code>f</code>), rear-wheel (<code>r</code>) or 4-wheel (<code>4</code>).</p>
<p>Example: Palmer penguins</p>
<p>Let’s return to the penguins data set. You import it as a data frame using <code>readr::read_csv()</code> function.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="tuesday-september-20-2022.html#cb20-1" aria-hidden="true" tabindex="-1"></a>loc <span class="ot">&lt;-</span> <span class="st">&quot;https://raw.githubusercontent.com/allisonhorst/palmerpenguins/master/inst/extdata/penguins.csv&quot;</span></span>
<span id="cb20-2"><a href="tuesday-september-20-2022.html#cb20-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(loc)</span></code></pre></div>
<pre><code>## Rows: 344 Columns: 8
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (3): species, island, sex
## dbl (5): bill_length_mm, bill_depth_mm, flipper_length_mm, body_mass_g, year
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="tuesday-september-20-2022.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(penguins)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 8
##   species island    bill_length_mm bill_depth_mm flipper_l…¹ body_…² sex    year
##   &lt;chr&gt;   &lt;chr&gt;              &lt;dbl&gt;         &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
## 1 Adelie  Torgersen           39.1          18.7         181    3750 male   2007
## 2 Adelie  Torgersen           39.5          17.4         186    3800 fema…  2007
## 3 Adelie  Torgersen           40.3          18           195    3250 fema…  2007
## 4 Adelie  Torgersen           NA            NA            NA      NA &lt;NA&gt;   2007
## 5 Adelie  Torgersen           36.7          19.3         193    3450 fema…  2007
## 6 Adelie  Torgersen           39.3          20.6         190    3650 male   2007
## # … with abbreviated variable names ¹​flipper_length_mm, ²​body_mass_g</code></pre>
<p>Here you will visualize the relationship between <code>flipper_length_mm</code> and <code>body_mass_g</code> with respect to each species.</p>
<p><a href="https://towardsdatascience.com/penguins-dataset-overview-iris-alternative-9453bb8c8d95" class="uri">https://towardsdatascience.com/penguins-dataset-overview-iris-alternative-9453bb8c8d95</a></p>
<p>Start by creating a scatter plot with flipper length on the horizontal axis and body mass on the vertical axis.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="tuesday-september-20-2022.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins) <span class="sc">+</span></span>
<span id="cb24-2"><a href="tuesday-september-20-2022.html#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> flipper_length_mm, <span class="at">y =</span> body_mass_g))</span></code></pre></div>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>Next, make the color and shape of the points correspond to the species type. Use the colors “darkorange”, “purple”, “cyan4”.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="tuesday-september-20-2022.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins) <span class="sc">+</span></span>
<span id="cb26-2"><a href="tuesday-september-20-2022.html#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> flipper_length_mm, </span>
<span id="cb26-3"><a href="tuesday-september-20-2022.html#cb26-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> body_mass_g, </span>
<span id="cb26-4"><a href="tuesday-september-20-2022.html#cb26-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> species,</span>
<span id="cb26-5"><a href="tuesday-september-20-2022.html#cb26-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> species)) <span class="sc">+</span></span>
<span id="cb26-6"><a href="tuesday-september-20-2022.html#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;purple&quot;</span>, <span class="st">&quot;cyan4&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>Finally, separate the scatter plots by island.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="tuesday-september-20-2022.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins) <span class="sc">+</span></span>
<span id="cb28-2"><a href="tuesday-september-20-2022.html#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> flipper_length_mm, </span>
<span id="cb28-3"><a href="tuesday-september-20-2022.html#cb28-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> body_mass_g, </span>
<span id="cb28-4"><a href="tuesday-september-20-2022.html#cb28-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> species,</span>
<span id="cb28-5"><a href="tuesday-september-20-2022.html#cb28-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> species)) <span class="sc">+</span></span>
<span id="cb28-6"><a href="tuesday-september-20-2022.html#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;purple&quot;</span>, <span class="st">&quot;cyan4&quot;</span>)) <span class="sc">+</span></span>
<span id="cb28-7"><a href="tuesday-september-20-2022.html#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> island)</span></code></pre></div>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>An expository graph</p>
<p>Adding labels and titles turns an exploratory graph into an expository graph. Consider again the <code>mpg</code> dataset and plot highway mileage (<code>hwy</code>) as a function of engine size (<code>displ</code>) with the color of the point layer given by automobile class (<code>class</code>).</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="tuesday-september-20-2022.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, </span>
<span id="cb30-2"><a href="tuesday-september-20-2022.html#cb30-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb30-3"><a href="tuesday-september-20-2022.html#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> class)) <span class="sc">+</span></span>
<span id="cb30-4"><a href="tuesday-september-20-2022.html#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb30-5"><a href="tuesday-september-20-2022.html#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Fuel efficiency generally decreases with engine size&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>The graph title should summarize the main finding. Avoid titles that just describe what the plot is, e.g. “A scatter plot of engine displacement vs. fuel economy”. If you need to add more text use subtitles and captions.</p>
<ul>
<li><code>subtitle =</code> adds additional detail in a smaller font beneath the title.</li>
<li><code>caption =</code> adds text at the bottom right of the plot, often used to describe the source of the data.</li>
</ul>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="tuesday-september-20-2022.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg, </span>
<span id="cb32-2"><a href="tuesday-september-20-2022.html#cb32-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb32-3"><a href="tuesday-september-20-2022.html#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> class)) <span class="sc">+</span></span>
<span id="cb32-4"><a href="tuesday-september-20-2022.html#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb32-5"><a href="tuesday-september-20-2022.html#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Fuel efficiency generally decreases with engine size&quot;</span>,</span>
<span id="cb32-6"><a href="tuesday-september-20-2022.html#cb32-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Two seaters (sports cars) are an exception because of their light weight&quot;</span>,</span>
<span id="cb32-7"><a href="tuesday-september-20-2022.html#cb32-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Data are from fueleconomy.gov&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>Exporting your graph</p>
<p>When you knit to HTML and a plot is produced it gets output as a png file in our project directory.</p>
<p>You can use the Export button under the Plots tab.</p>
<p>Or you can export the file directly using R code. Here the file gets put into our working directory.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="tuesday-september-20-2022.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="at">file =</span> <span class="st">&quot;Test.png&quot;</span>)</span>
<span id="cb34-2"><a href="tuesday-september-20-2022.html#cb34-2" aria-hidden="true" tabindex="-1"></a>p1</span>
<span id="cb34-3"><a href="tuesday-september-20-2022.html#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p>Note that the function <code>png()</code> opens the device and the function <code>dev.off()</code> closes it.</p>
<p>You list the files in your working directory with the command <code>dir()</code>.</p>
</div>
<div id="visualizing-uncertainty" class="section level2 unnumbered hasAnchor">
<h2>Visualizing uncertainty<a href="tuesday-september-20-2022.html#visualizing-uncertainty" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The {ggdist} package provides a flexible set of {ggplot2} <code>geoms</code> and <code>stats</code> designed for visualizing distributions and uncertainty.</p>
<p>The functions are designed for frequentist and Bayesian uncertainty visualization, taking the view that uncertainty visualization can be unified through the perspective of distribution visualization.</p>
<p>With frequentist models you visualize confidence distributions or bootstrap distributions. For Bayesian models, you visualize probability distributions.</p>
<p>As one example, consider again the Palmer penguins. Here you filter to keep only the Chinstrap penguins.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="tuesday-september-20-2022.html#cb35-1" aria-hidden="true" tabindex="-1"></a>( Chinstrap.df <span class="ot">&lt;-</span> penguins <span class="sc">|&gt;</span></span>
<span id="cb35-2"><a href="tuesday-september-20-2022.html#cb35-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">&quot;Chinstrap&quot;</span>) )</span></code></pre></div>
<pre><code>## # A tibble: 68 × 8
##    species   island bill_length_mm bill_depth_mm flipper_l…¹ body_…² sex    year
##    &lt;chr&gt;     &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
##  1 Chinstrap Dream            46.5          17.9         192    3500 fema…  2007
##  2 Chinstrap Dream            50            19.5         196    3900 male   2007
##  3 Chinstrap Dream            51.3          19.2         193    3650 male   2007
##  4 Chinstrap Dream            45.4          18.7         188    3525 fema…  2007
##  5 Chinstrap Dream            52.7          19.8         197    3725 male   2007
##  6 Chinstrap Dream            45.2          17.8         198    3950 fema…  2007
##  7 Chinstrap Dream            46.1          18.2         178    3250 fema…  2007
##  8 Chinstrap Dream            51.3          18.2         197    3750 male   2007
##  9 Chinstrap Dream            46            18.9         195    4150 fema…  2007
## 10 Chinstrap Dream            51.3          19.9         198    3700 male   2007
## # … with 58 more rows, and abbreviated variable names ¹​flipper_length_mm,
## #   ²​body_mass_g
## # ℹ Use `print(n = ...)` to see more rows</code></pre>
<p>You compute the average and standard deviation of body mass conditional on sex.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="tuesday-september-20-2022.html#cb37-1" aria-hidden="true" tabindex="-1"></a>Chinstrap.df <span class="sc">|&gt;</span></span>
<span id="cb37-2"><a href="tuesday-september-20-2022.html#cb37-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(sex) <span class="sc">|&gt;</span></span>
<span id="cb37-3"><a href="tuesday-september-20-2022.html#cb37-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">avg =</span> <span class="fu">mean</span>(body_mass_g),</span>
<span id="cb37-4"><a href="tuesday-september-20-2022.html#cb37-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sd =</span> <span class="fu">sd</span>(body_mass_g))</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   sex      avg    sd
##   &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;
## 1 female 3527.  285.
## 2 male   3939.  362.</code></pre>
<p>On average male penguins are heavier but there is some variation. There is more variation among the males than among the females.</p>
<p>While useful, these statistics do not give information about the shape of the distribution and how those shapes compare in distributional space.</p>
<p>A plot showing the body mass values conditional on sex is a good start. Here you first remove cases where the sex of the penguin is missing and then plot the body mass variable along the horizontal axis using a point layer with a transparency (alpha) level set to .5.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="tuesday-september-20-2022.html#cb39-1" aria-hidden="true" tabindex="-1"></a>Chinstrap.df <span class="sc">|&gt;</span></span>
<span id="cb39-2"><a href="tuesday-september-20-2022.html#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> sex, <span class="at">x =</span> body_mass_g)) <span class="sc">+</span></span>
<span id="cb39-3"><a href="tuesday-september-20-2022.html#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> .<span class="dv">5</span>) </span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>The plot shows that some of the heaviest penguins are male and some of the lightest penguins are female there is considerable overlap in the values.</p>
<p>To make the visualization even more informative you can use functions from the {ggdist} package. Here you substitute the <code>ggdist::stat_halfeye()</code> for <code>geom_point()</code>.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="tuesday-september-20-2022.html#cb40-1" aria-hidden="true" tabindex="-1"></a>Chinstrap.df <span class="sc">|&gt;</span></span>
<span id="cb40-2"><a href="tuesday-september-20-2022.html#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> sex, <span class="at">x =</span> body_mass_g)) <span class="sc">+</span></span>
<span id="cb40-3"><a href="tuesday-september-20-2022.html#cb40-3" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>()</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>The result is a plot showing the location of the respective average values (black dot) along with the 66th (thick line) and 95th percentile intervals (thin line).</p>
<p>Also displayed are the density plots in gray.</p>
<p>Another example showing quantile intervals.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="tuesday-september-20-2022.html#cb41-1" aria-hidden="true" tabindex="-1"></a>Chinstrap.df <span class="sc">|&gt;</span></span>
<span id="cb41-2"><a href="tuesday-september-20-2022.html#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> sex, <span class="at">x =</span> body_mass_g)) <span class="sc">+</span></span>
<span id="cb41-3"><a href="tuesday-september-20-2022.html#cb41-3" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_interval</span>()</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>The half intervals (.5) do not overlap.</p>
<p>More information on using functions from the {ggdist} package for visualizing uncertainty is available from <a href="https://mjskay.github.io/ggdist/" class="uri">https://mjskay.github.io/ggdist/</a></p>
</div>
<div id="simple-feature-data-frames" class="section level2 unnumbered hasAnchor">
<h2>Simple feature data frames<a href="tuesday-september-20-2022.html#simple-feature-data-frames" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Geographic visualization of data is important to geographers and environmental scientists. There are many tools for geo visualization from full-scale GIS applications such as ArcGIS and QGIS to web-based tools like Google maps.</p>
<p>Using code to make maps (instead of point and click) has the benefit of transparency and reproducibility.</p>
<p>Simple features (simple feature access) refers to a standard that describes how objects in the real world are represented in computers. Emphasis is on the spatial geometry of the objects.</p>
<p>The standard also describes how such objects are stored in and retrieved from databases, and which geometrical operations are defined for them.</p>
<p>The simple feature standard is implemented in spatial databases (such as PostGIS), commercial GIS (e.g., ESRI ArcGIS). R has an implementation in the {sf} package.</p>
<p>One type of spatial data file is called a <em>shapefile</em>. As an example, the U.S. census information at the state and territory level in a file called <code>cb_2018_us_state_5m.shp</code>. <a href="https://www.census.gov/geographies/mapping-files/time-series/geo/carto-boundary-file.html" class="uri">https://www.census.gov/geographies/mapping-files/time-series/geo/carto-boundary-file.html</a></p>
<p>A shapefile encodes points, lines, and polygons in geographic space, and is actually a set of files. Shapefiles appear with a <code>.shp</code> extension and with accompanying files ending in <code>.dbf</code> and <code>.prj</code>.</p>
<ul>
<li><code>.shp</code> stores the geographic coordinates of the geographic features (e.g. country, state, county)</li>
<li><code>.dbf</code> stores data associated with the geographic features (e.g. unemployment rates)</li>
<li><code>.prj</code> stores information about the projection of the coordinates in the shapefile</li>
</ul>
<p>To get a shapefile into R all the files need to be in the same folder (directory).</p>
<p>As an example, you import the census data with the <code>sf::st_read()</code> function from the {sf} package. You assign to the object <code>USA.sf</code> the contents of the spatial data frame.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="tuesday-september-20-2022.html#cb42-1" aria-hidden="true" tabindex="-1"></a>USA.sf <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_read</span>(<span class="at">dsn =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;cb_2018_us_state_5m&quot;</span>))</span></code></pre></div>
<pre><code>## Reading layer `cb_2018_us_state_5m&#39; from data source 
##   `/Users/jameselsner/Desktop/ClassNotes/QG-2022/data/cb_2018_us_state_5m&#39; 
##   using driver `ESRI Shapefile&#39;
## Simple feature collection with 56 features and 9 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -179.1473 ymin: -14.55255 xmax: 179.7785 ymax: 71.35256
## Geodetic CRS:  NAD83</code></pre>
<p>The output includes information about the file. The object shows up in your environment as a data frame with 56 observations and 10 variables.</p>
<p>Each observation is either a state or territory.</p>
<p>The <code>class()</code> function tells you the type of data frame and the <code>names()</code> function list the variable names.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="tuesday-september-20-2022.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(USA.sf)</span></code></pre></div>
<pre><code>## [1] &quot;sf&quot;         &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="tuesday-september-20-2022.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(USA.sf)</span></code></pre></div>
<pre><code>##  [1] &quot;STATEFP&quot;  &quot;STATENS&quot;  &quot;AFFGEOID&quot; &quot;GEOID&quot;    &quot;STUSPS&quot;   &quot;NAME&quot;    
##  [7] &quot;LSAD&quot;     &quot;ALAND&quot;    &quot;AWATER&quot;   &quot;geometry&quot;</code></pre>
<p>The file is a simple feature (<code>sf</code>) data frame (<code>data.frame</code>). This means it behaves like a data frame but it also contains information about where the observations are located.</p>
<p>The first several columns serve as identifiers. The variable <code>ALAND</code> is the land area (square meters) and the <code>AWATER</code> is the water area (sq. m).</p>
<p>The last column labeled <code>geometry</code> contains information about location stored as a ‘feature’. The function <code>sf::st_geometry()</code> list the first 5 geometries.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="tuesday-september-20-2022.html#cb48-1" aria-hidden="true" tabindex="-1"></a>sf<span class="sc">::</span><span class="fu">st_geometry</span>(USA.sf)</span></code></pre></div>
<pre><code>## Geometry set for 56 features 
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -179.1473 ymin: -14.55255 xmax: 179.7785 ymax: 71.35256
## Geodetic CRS:  NAD83
## First 5 geometries:</code></pre>
<pre><code>## MULTIPOLYGON (((-104.0535 41.15726, -104.0527 4...</code></pre>
<pre><code>## MULTIPOLYGON (((-122.3283 48.02134, -122.3217 4...</code></pre>
<pre><code>## MULTIPOLYGON (((-109.0502 31.48, -109.0498 31.4...</code></pre>
<pre><code>## MULTIPOLYGON (((-104.0577 44.99743, -104.0502 4...</code></pre>
<pre><code>## MULTIPOLYGON (((-106.6455 31.89867, -106.6408 3...</code></pre>
<p>The geometry type in this case is <code>MULTIPOLYGON</code>.</p>
<p>A feature is an object in the real world. Often features will consist of a set of features. For instance, a tree is a feature but a set of trees in a forest is itself a feature. The trees are represented as points while the forest boundary as a polygon.</p>
<p>Features have a geometry describing where on Earth the feature is located. They also have attributes, which describe other properties of the feature.</p>
</div>
<div id="making-a-boundary-map" class="section level2 unnumbered hasAnchor">
<h2>Making a boundary map<a href="tuesday-september-20-2022.html#making-a-boundary-map" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The functions in the {ggplot2} package work with simple feature data frames to generate maps using the same grammar.</p>
<p>The important function is <code>geom_sf()</code>. This function draws the geometries.</p>
<p>For example, to draw a map showing the state and territorial boundaries first use <code>ggplot()</code> with the data argument specifying the simple feature data frame <code>USA.sf</code> and then add the <code>geom_sf()</code> function as a layer with the <code>+</code> symbol.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="tuesday-september-20-2022.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb55-2"><a href="tuesday-september-20-2022.html#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="tuesday-september-20-2022.html#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> USA.sf) <span class="sc">+</span></span>
<span id="cb55-4"><a href="tuesday-september-20-2022.html#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>()</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<p>Note: you don’t need the <code>mapping = aes()</code> function. The mapping is assumed based on the fact that there is a <code>geometry</code> column in the simple feature data frame.</p>
<p>The <code>geom_sf()</code> function maps the east-west coordinate to the <code>x</code> aesthetic and the north-south coordinate to the <code>y</code> aesthetic.</p>
<p>The map is not very informative. Let’s zoom into the contiguous states.</p>
<p>What states/territories are there in the data frame <code>USA.sf</code>?</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="tuesday-september-20-2022.html#cb56-1" aria-hidden="true" tabindex="-1"></a>USA.sf<span class="sc">$</span>NAME</span></code></pre></div>
<pre><code>##  [1] &quot;Nebraska&quot;                                    
##  [2] &quot;Washington&quot;                                  
##  [3] &quot;New Mexico&quot;                                  
##  [4] &quot;South Dakota&quot;                                
##  [5] &quot;Texas&quot;                                       
##  [6] &quot;California&quot;                                  
##  [7] &quot;Kentucky&quot;                                    
##  [8] &quot;Ohio&quot;                                        
##  [9] &quot;Alabama&quot;                                     
## [10] &quot;Georgia&quot;                                     
## [11] &quot;Wisconsin&quot;                                   
## [12] &quot;Oregon&quot;                                      
## [13] &quot;Pennsylvania&quot;                                
## [14] &quot;Mississippi&quot;                                 
## [15] &quot;Missouri&quot;                                    
## [16] &quot;North Carolina&quot;                              
## [17] &quot;Oklahoma&quot;                                    
## [18] &quot;West Virginia&quot;                               
## [19] &quot;New York&quot;                                    
## [20] &quot;Indiana&quot;                                     
## [21] &quot;Kansas&quot;                                      
## [22] &quot;Idaho&quot;                                       
## [23] &quot;Nevada&quot;                                      
## [24] &quot;Vermont&quot;                                     
## [25] &quot;Montana&quot;                                     
## [26] &quot;Minnesota&quot;                                   
## [27] &quot;North Dakota&quot;                                
## [28] &quot;Hawaii&quot;                                      
## [29] &quot;Arizona&quot;                                     
## [30] &quot;Delaware&quot;                                    
## [31] &quot;Rhode Island&quot;                                
## [32] &quot;Colorado&quot;                                    
## [33] &quot;Utah&quot;                                        
## [34] &quot;Virginia&quot;                                    
## [35] &quot;Wyoming&quot;                                     
## [36] &quot;Louisiana&quot;                                   
## [37] &quot;Michigan&quot;                                    
## [38] &quot;Massachusetts&quot;                               
## [39] &quot;Florida&quot;                                     
## [40] &quot;United States Virgin Islands&quot;                
## [41] &quot;Connecticut&quot;                                 
## [42] &quot;New Jersey&quot;                                  
## [43] &quot;Maryland&quot;                                    
## [44] &quot;South Carolina&quot;                              
## [45] &quot;Maine&quot;                                       
## [46] &quot;New Hampshire&quot;                               
## [47] &quot;District of Columbia&quot;                        
## [48] &quot;Guam&quot;                                        
## [49] &quot;Commonwealth of the Northern Mariana Islands&quot;
## [50] &quot;American Samoa&quot;                              
## [51] &quot;Iowa&quot;                                        
## [52] &quot;Puerto Rico&quot;                                 
## [53] &quot;Arkansas&quot;                                    
## [54] &quot;Tennessee&quot;                                   
## [55] &quot;Illinois&quot;                                    
## [56] &quot;Alaska&quot;</code></pre>
<p>To zoom in you keep only rows corresponding to states (in the lower 48) from the simple feature data frame.</p>
<p>Recall to pick out rows in a data frame you use the <code>dplyr::filter()</code> function from the {dplyr} package.</p>
<p>First you need to get a list of all the states you want to keep. The <code>state.name</code> vector object contains all 50 state names. This is like the <code>month.abb</code> vector you saw earlier.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="tuesday-september-20-2022.html#cb58-1" aria-hidden="true" tabindex="-1"></a>state.name</span></code></pre></div>
<pre><code>##  [1] &quot;Alabama&quot;        &quot;Alaska&quot;         &quot;Arizona&quot;        &quot;Arkansas&quot;      
##  [5] &quot;California&quot;     &quot;Colorado&quot;       &quot;Connecticut&quot;    &quot;Delaware&quot;      
##  [9] &quot;Florida&quot;        &quot;Georgia&quot;        &quot;Hawaii&quot;         &quot;Idaho&quot;         
## [13] &quot;Illinois&quot;       &quot;Indiana&quot;        &quot;Iowa&quot;           &quot;Kansas&quot;        
## [17] &quot;Kentucky&quot;       &quot;Louisiana&quot;      &quot;Maine&quot;          &quot;Maryland&quot;      
## [21] &quot;Massachusetts&quot;  &quot;Michigan&quot;       &quot;Minnesota&quot;      &quot;Mississippi&quot;   
## [25] &quot;Missouri&quot;       &quot;Montana&quot;        &quot;Nebraska&quot;       &quot;Nevada&quot;        
## [29] &quot;New Hampshire&quot;  &quot;New Jersey&quot;     &quot;New Mexico&quot;     &quot;New York&quot;      
## [33] &quot;North Carolina&quot; &quot;North Dakota&quot;   &quot;Ohio&quot;           &quot;Oklahoma&quot;      
## [37] &quot;Oregon&quot;         &quot;Pennsylvania&quot;   &quot;Rhode Island&quot;   &quot;South Carolina&quot;
## [41] &quot;South Dakota&quot;   &quot;Tennessee&quot;      &quot;Texas&quot;          &quot;Utah&quot;          
## [45] &quot;Vermont&quot;        &quot;Virginia&quot;       &quot;Washington&quot;     &quot;West Virginia&quot; 
## [49] &quot;Wisconsin&quot;      &quot;Wyoming&quot;</code></pre>
<p>Let’s remove the rows corresponding to the names <code>"Alaska"</code> and <code>"Hawaii"</code>. These are elements 2 and 11 so you create a new vector object called <code>sn</code> containing only the names of the lower 48.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="tuesday-september-20-2022.html#cb60-1" aria-hidden="true" tabindex="-1"></a>sn <span class="ot">&lt;-</span> state.name[<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">11</span>)]</span>
<span id="cb60-2"><a href="tuesday-september-20-2022.html#cb60-2" aria-hidden="true" tabindex="-1"></a>sn</span></code></pre></div>
<pre><code>##  [1] &quot;Alabama&quot;        &quot;Arizona&quot;        &quot;Arkansas&quot;       &quot;California&quot;    
##  [5] &quot;Colorado&quot;       &quot;Connecticut&quot;    &quot;Delaware&quot;       &quot;Florida&quot;       
##  [9] &quot;Georgia&quot;        &quot;Idaho&quot;          &quot;Illinois&quot;       &quot;Indiana&quot;       
## [13] &quot;Iowa&quot;           &quot;Kansas&quot;         &quot;Kentucky&quot;       &quot;Louisiana&quot;     
## [17] &quot;Maine&quot;          &quot;Maryland&quot;       &quot;Massachusetts&quot;  &quot;Michigan&quot;      
## [21] &quot;Minnesota&quot;      &quot;Mississippi&quot;    &quot;Missouri&quot;       &quot;Montana&quot;       
## [25] &quot;Nebraska&quot;       &quot;Nevada&quot;         &quot;New Hampshire&quot;  &quot;New Jersey&quot;    
## [29] &quot;New Mexico&quot;     &quot;New York&quot;       &quot;North Carolina&quot; &quot;North Dakota&quot;  
## [33] &quot;Ohio&quot;           &quot;Oklahoma&quot;       &quot;Oregon&quot;         &quot;Pennsylvania&quot;  
## [37] &quot;Rhode Island&quot;   &quot;South Carolina&quot; &quot;South Dakota&quot;   &quot;Tennessee&quot;     
## [41] &quot;Texas&quot;          &quot;Utah&quot;           &quot;Vermont&quot;        &quot;Virginia&quot;      
## [45] &quot;Washington&quot;     &quot;West Virginia&quot;  &quot;Wisconsin&quot;      &quot;Wyoming&quot;</code></pre>
<p>Now you filter the <code>USA.sf</code> data frame keeping only the rows that are listed in the vector of state names. Assign this spatial data frame the name <code>USA_48.sf</code>.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="tuesday-september-20-2022.html#cb62-1" aria-hidden="true" tabindex="-1"></a>USA_48.sf <span class="ot">&lt;-</span> USA.sf <span class="sc">|&gt;</span></span>
<span id="cb62-2"><a href="tuesday-september-20-2022.html#cb62-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(NAME <span class="sc">%in%</span> sn)</span></code></pre></div>
<p>The function <code>%in%</code> finds only the rows in <code>USA.sf</code> with <code>NAME</code> equal to the names in the vector <code>sn</code> and the <code>dplyr::filter()</code> function chooses these rows.</p>
<p>Now redraw the map using the <code>USA_48.sf</code> simple feature data frame.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="tuesday-september-20-2022.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> USA_48.sf) <span class="sc">+</span></span>
<span id="cb63-2"><a href="tuesday-september-20-2022.html#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>()</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<p>Since the map is a <code>ggplot()</code> object, it is modified like any other <code>ggplot()</code> graph. For example, you change the color of the map and the borders as follows.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="tuesday-september-20-2022.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> USA_48.sf) <span class="sc">+</span></span>
<span id="cb64-2"><a href="tuesday-september-20-2022.html#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">fill =</span> <span class="st">&quot;skyblue&quot;</span>, </span>
<span id="cb64-3"><a href="tuesday-september-20-2022.html#cb64-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">&quot;gray70&quot;</span>)</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<p>You can filter by state. Here you create a new simple feature data frame called <code>Wisconsin.sf</code> then draw the boundary.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="tuesday-september-20-2022.html#cb65-1" aria-hidden="true" tabindex="-1"></a>Wisconsin.sf <span class="ot">&lt;-</span> USA_48.sf <span class="sc">|&gt;</span></span>
<span id="cb65-2"><a href="tuesday-september-20-2022.html#cb65-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(NAME <span class="sc">==</span> <span class="st">&quot;Wisconsin&quot;</span>)</span>
<span id="cb65-3"><a href="tuesday-september-20-2022.html#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="tuesday-september-20-2022.html#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Wisconsin.sf) <span class="sc">+</span></span>
<span id="cb65-5"><a href="tuesday-september-20-2022.html#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">fill =</span> <span class="st">&quot;palegreen&quot;</span>, </span>
<span id="cb65-6"><a href="tuesday-september-20-2022.html#cb65-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<p>Where is the state of Nebraska? Repeat but fill in Nebraska using the color brown.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="tuesday-september-20-2022.html#cb66-1" aria-hidden="true" tabindex="-1"></a>Nebraska.sf <span class="ot">&lt;-</span> USA_48.sf <span class="sc">|&gt;</span></span>
<span id="cb66-2"><a href="tuesday-september-20-2022.html#cb66-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(NAME <span class="sc">==</span> <span class="st">&quot;Nebraska&quot;</span>)</span>
<span id="cb66-3"><a href="tuesday-september-20-2022.html#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="tuesday-september-20-2022.html#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> USA_48.sf) <span class="sc">+</span></span>
<span id="cb66-5"><a href="tuesday-september-20-2022.html#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>() <span class="sc">+</span></span>
<span id="cb66-6"><a href="tuesday-september-20-2022.html#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> Nebraska.sf, </span>
<span id="cb66-7"><a href="tuesday-september-20-2022.html#cb66-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">&quot;brown&quot;</span>)</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<p>You add layers with the <code>+</code> symbol as before.</p>
<p>Boundaries serve as the background canvas for spatial data analysis. You usually need to add data to this canvas. Depending on the type of data, you either overlay it on top of the boundaries or use it to fill in the areas between the boundaries.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tuesday-september-13-2022.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="thursday-september-22-2022.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
