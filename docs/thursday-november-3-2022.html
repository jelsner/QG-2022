<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Thursday, November 3, 2022 | GEO5156: Quantitative Geography</title>
  <meta name="description" content="Thursday, November 3, 2022 | GEO5156: Quantitative Geography" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Thursday, November 3, 2022 | GEO5156: Quantitative Geography" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="jelsner/QG-2022" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Thursday, November 3, 2022 | GEO5156: Quantitative Geography" />
  
  
  

<meta name="author" content="James B. Elsner" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tuesday-november-1-2022.html"/>
<link rel="next" href="tuesday-november-8-2022.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Quantitative Geography</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html"><i class="fa fa-check"></i>Syllabus</a>
<ul>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#geo5165c-quantitative-geography"><i class="fa fa-check"></i>GEO5165C: Quantitative Geography</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#contact-information"><i class="fa fa-check"></i>Contact information</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#course-description"><i class="fa fa-check"></i>Course description</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#grades"><i class="fa fa-check"></i>Grades</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#ethics"><i class="fa fa-check"></i>Ethics</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#schedule-subject-to-change-with-notice"><i class="fa fa-check"></i>Schedule (subject to change with notice)</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#deeper-dives"><i class="fa fa-check"></i>Deeper dives</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html"><i class="fa fa-check"></i>Tuesday, August 23, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#what-is-this-course"><i class="fa fa-check"></i>What is this course?</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#where-are-the-materials-for-this-course"><i class="fa fa-check"></i>Where are the materials for this course?</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#syllabus-1"><i class="fa fa-check"></i>Syllabus</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#getting-setup"><i class="fa fa-check"></i>Getting setup</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#rstudios-integrated-development-environment-ide"><i class="fa fa-check"></i>RStudioâ€™s integrated development environment (IDE)</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#example-tallahassee-daily-temperatures"><i class="fa fa-check"></i>Example: Tallahassee daily temperatures</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-august-25-2022.html"><a href="thursday-august-25-2022.html"><i class="fa fa-check"></i>Thursday, August 25, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-august-25-2022.html"><a href="thursday-august-25-2022.html#data-science"><i class="fa fa-check"></i>Data science</a></li>
<li class="chapter" data-level="" data-path="thursday-august-25-2022.html"><a href="thursday-august-25-2022.html#structure-of-markdown-files"><i class="fa fa-check"></i>Structure of markdown files</a></li>
<li class="chapter" data-level="" data-path="thursday-august-25-2022.html"><a href="thursday-august-25-2022.html#how-to-make-a-plot"><i class="fa fa-check"></i>How to make a plot</a></li>
<li class="chapter" data-level="" data-path="thursday-august-25-2022.html"><a href="thursday-august-25-2022.html#getting-started-using-r"><i class="fa fa-check"></i>Getting started using R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-august-30-2022.html"><a href="tuesday-august-30-2022.html"><i class="fa fa-check"></i>Tuesday, August 30, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-august-30-2022.html"><a href="tuesday-august-30-2022.html#graphing-examples"><i class="fa fa-check"></i>Graphing examples</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-30-2022.html"><a href="tuesday-august-30-2022.html#working-with-r"><i class="fa fa-check"></i>Working with R</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-30-2022.html"><a href="tuesday-august-30-2022.html#data-vectors"><i class="fa fa-check"></i>Data vectors</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-september-1-2022.html"><a href="thursday-september-1-2022.html"><i class="fa fa-check"></i>Thursday, September 1, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-september-1-2022.html"><a href="thursday-september-1-2022.html#sample-statistics"><i class="fa fa-check"></i>Sample statistics</a></li>
<li class="chapter" data-level="" data-path="thursday-september-1-2022.html"><a href="thursday-september-1-2022.html#structured-data"><i class="fa fa-check"></i>Structured data</a></li>
<li class="chapter" data-level="" data-path="thursday-september-1-2022.html"><a href="thursday-september-1-2022.html#tables-and-summaries"><i class="fa fa-check"></i>Tables and summaries</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-september-6-2022.html"><a href="tuesday-september-6-2022.html"><i class="fa fa-check"></i>Tuesday, September 6, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-september-6-2022.html"><a href="tuesday-september-6-2022.html#getting-your-data-into-r"><i class="fa fa-check"></i>Getting your data into R</a></li>
<li class="chapter" data-level="" data-path="tuesday-september-6-2022.html"><a href="tuesday-september-6-2022.html#data-frames"><i class="fa fa-check"></i>Data frames</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-september-8-2022.html"><a href="thursday-september-8-2022.html"><i class="fa fa-check"></i>Thursday, September 8, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-september-8-2022.html"><a href="thursday-september-8-2022.html#using-pipes"><i class="fa fa-check"></i>Using pipes</a></li>
<li class="chapter" data-level="" data-path="thursday-september-8-2022.html"><a href="thursday-september-8-2022.html#wrangling-data-frames"><i class="fa fa-check"></i>Wrangling data frames</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-september-13-2022.html"><a href="tuesday-september-13-2022.html"><i class="fa fa-check"></i>Tuesday, September 13, 2022</a>
<ul>
<li class="chapter" data-level="0.1" data-path="tuesday-september-13-2022.html"><a href="tuesday-september-13-2022.html#data-munging-examples"><i class="fa fa-check"></i><b>0.1</b> Data munging examples</a></li>
<li class="chapter" data-level="" data-path="tuesday-september-13-2022.html"><a href="tuesday-september-13-2022.html#putting-things-together"><i class="fa fa-check"></i>Putting things together</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-september-15-2022.html"><a href="thursday-september-15-2022.html"><i class="fa fa-check"></i>Thursday, September 15, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-september-15-2022.html"><a href="thursday-september-15-2022.html#data-visualization"><i class="fa fa-check"></i>Data visualization</a></li>
<li class="chapter" data-level="" data-path="thursday-september-15-2022.html"><a href="thursday-september-15-2022.html#transforming-the-response-variable"><i class="fa fa-check"></i>Transforming the response variable</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-october-20-2022.html"><a href="thursday-october-20-2022.html"><i class="fa fa-check"></i>Thursday, October 20, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-october-20-2022.html"><a href="thursday-october-20-2022.html#more-regression-examples"><i class="fa fa-check"></i>More regression examples</a></li>
<li class="chapter" data-level="" data-path="thursday-october-20-2022.html"><a href="thursday-october-20-2022.html#outliers"><i class="fa fa-check"></i>Outliers</a></li>
<li class="chapter" data-level="" data-path="thursday-october-20-2022.html"><a href="thursday-october-20-2022.html#simpsons-paradox"><i class="fa fa-check"></i>Simpsonâ€™s paradox</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html"><i class="fa fa-check"></i>Tuesday, October 25, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#a-regression-plane"><i class="fa fa-check"></i>A regression plane</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#fitting-a-multiple-variable-regression-model"><i class="fa fa-check"></i>Fitting a multiple variable regression model</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#should-you-remove-a-variable-from-the-model"><i class="fa fa-check"></i>Should you remove a variable from the model?</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#checking-on-the-model-assumptions"><i class="fa fa-check"></i>Checking on the model assumptions</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#using-the-model-to-make-predictions"><i class="fa fa-check"></i>Using the model to make predictions</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#collinearity"><i class="fa fa-check"></i>Collinearity</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#interactions"><i class="fa fa-check"></i>Interactions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-october-27-2022.html"><a href="thursday-october-27-2022.html"><i class="fa fa-check"></i>Thursday, October 27, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-october-27-2022.html"><a href="thursday-october-27-2022.html#removing-variables-from-a-regression-model"><i class="fa fa-check"></i>Removing variables from a regression model</a></li>
<li class="chapter" data-level="" data-path="thursday-october-27-2022.html"><a href="thursday-october-27-2022.html#the-stepwise-selection-procedure"><i class="fa fa-check"></i>The stepwise selection procedure</a></li>
<li class="chapter" data-level="" data-path="thursday-october-27-2022.html"><a href="thursday-october-27-2022.html#transforming-a-response-variable"><i class="fa fa-check"></i>Transforming a response variable</a></li>
<li class="chapter" data-level="" data-path="thursday-october-27-2022.html"><a href="thursday-october-27-2022.html#regression-trees"><i class="fa fa-check"></i>Regression trees</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-november-1-2022.html"><a href="tuesday-november-1-2022.html"><i class="fa fa-check"></i>Tuesday, November 1, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-november-1-2022.html"><a href="tuesday-november-1-2022.html#predictive-uncertainty-with-regression-trees"><i class="fa fa-check"></i>Predictive uncertainty with regression trees</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-1-2022.html"><a href="tuesday-november-1-2022.html#the-random-forest-algorithm"><i class="fa fa-check"></i>The random forest algorithm</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-1-2022.html"><a href="tuesday-november-1-2022.html#cross-validation"><i class="fa fa-check"></i>Cross validation</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-1-2022.html"><a href="tuesday-november-1-2022.html#classification-trees"><i class="fa fa-check"></i>Classification trees</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-november-3-2022.html"><a href="thursday-november-3-2022.html"><i class="fa fa-check"></i>Thursday, November 3, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-november-3-2022.html"><a href="thursday-november-3-2022.html#binary-outcomes-and-probabilities"><i class="fa fa-check"></i>Binary outcomes and probabilities</a></li>
<li class="chapter" data-level="" data-path="thursday-november-3-2022.html"><a href="thursday-november-3-2022.html#logistic-regression"><i class="fa fa-check"></i>Logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html"><i class="fa fa-check"></i>Tuesday, November 8, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html#quantifying-autocorrelation-in-spatial-data"><i class="fa fa-check"></i>Quantifying autocorrelation in spatial data</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html#spatial-data-as-polygon-areas"><i class="fa fa-check"></i>Spatial data as polygon areas</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html#nearest-neighbors"><i class="fa fa-check"></i>Nearest neighbors</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html#spatial-weights"><i class="fa fa-check"></i>Spatial weights</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html#morans-i"><i class="fa fa-check"></i>Moranâ€™s I</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-8-2022.html"><a href="tuesday-november-8-2022.html#spatial-lag-variable"><i class="fa fa-check"></i>Spatial lag variable</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-november-10-2022.html"><a href="thursday-november-10-2022.html"><i class="fa fa-check"></i>Thursday, November 10, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-november-10-2022.html"><a href="thursday-november-10-2022.html#statistical-significance-of-spatial-autocorrelation"><i class="fa fa-check"></i>Statistical significance of spatial autocorrelation</a></li>
<li class="chapter" data-level="" data-path="thursday-november-10-2022.html"><a href="thursday-november-10-2022.html#a-monte-carlo-approach-to-inference-about-spatial-autocorrelation"><i class="fa fa-check"></i>A Monte Carlo approach to inference about spatial autocorrelation</a></li>
<li class="chapter" data-level="" data-path="thursday-november-10-2022.html"><a href="thursday-november-10-2022.html#spatial-autocorrelation-in-model-residuals"><i class="fa fa-check"></i>Spatial autocorrelation in model residuals</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-november-15-2022.html"><a href="tuesday-november-15-2022.html"><i class="fa fa-check"></i>Tuesday, November 15, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-november-15-2022.html"><a href="tuesday-november-15-2022.html#bi-variate-spatial-autocorrelation"><i class="fa fa-check"></i>Bi-variate spatial autocorrelation</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-15-2022.html"><a href="tuesday-november-15-2022.html#local-autocorrelation"><i class="fa fa-check"></i>Local autocorrelation</a></li>
<li class="chapter" data-level="0.2" data-path="tuesday-november-15-2022.html"><a href="tuesday-november-15-2022.html#local-regression"><i class="fa fa-check"></i><b>0.2</b> Local regression</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-15-2022.html"><a href="tuesday-november-15-2022.html#spatial-weights-1"><i class="fa fa-check"></i>Spatial weights</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-november-17-2022.html"><a href="thursday-november-17-2022.html"><i class="fa fa-check"></i>Thursday, November 17, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-november-17-2022.html"><a href="thursday-november-17-2022.html#geographic-regression"><i class="fa fa-check"></i>Geographic regression</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GEO5156: Quantitative Geography</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="thursday-november-3-2022" class="section level1 unnumbered hasAnchor">
<h1>Thursday, November 3, 2022<a href="thursday-november-3-2022.html#thursday-november-3-2022" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Today</p>
<p>Logistic regression</p>
<ul>
<li>Binary outcomes and probability</li>
<li>The logistic regression model</li>
</ul>
<p>Linear regression is one of the most powerful tools in data science. But itâ€™s utility is limited to response variables that can be approximated with a normal distribution.</p>
<p>When the response variable is binary (only two outcomes) a linear regression model should not be used.</p>
<p>Many scientific research questions involve binary outcomes, and there is often a need to predict the probability that something will happen. The probability you will get a virus.</p>
<p>Fortunately, with only a small modification to the linear regression model you can get a <em>logistic regression</em> model that describes how a binary response variable is related to a set of explanatory variables.</p>
<p>The mechanics of fitting a logistic regression model are the same as with fitting a linear regression. The model coefficients are determined using the <em>method of maximum likelihood</em>.</p>
<p>The method of maximum likelihood answers the question, what is the probability of our data given the model. A model that assigns the highest probability to our data is the model that is chosen.</p>
<div id="binary-outcomes-and-probabilities" class="section level2 unnumbered hasAnchor">
<h2>Binary outcomes and probabilities<a href="thursday-november-3-2022.html#binary-outcomes-and-probabilities" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A key understanding here is that the <em>average value</em> over a set of binary responses is a number between 0 and 1. To see this, here we generate a set of random binary responses using the <code>rbinom()</code> function. <code>r</code> for random and <code>binom</code> for binomial distribution with a long-run probability of .2.</p>
<div class="sourceCode" id="cb771"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb771-1"><a href="thursday-november-3-2022.html#cb771-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">100</span>, </span>
<span id="cb771-2"><a href="thursday-november-3-2022.html#cb771-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">size =</span> <span class="dv">1</span>, </span>
<span id="cb771-3"><a href="thursday-november-3-2022.html#cb771-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">prob =</span> .<span class="dv">2</span>)</span></code></pre></div>
<pre><code>##   [1] 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 1 0 0 1 0 1 0
##  [38] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 0 0 0 1 1 0 0 1 0 0 0 0
##  [75] 0 0 0 0 0 0 0 0 0 1 0 0 0 1 1 0 1 0 0 0 0 0 0 0 0 0</code></pre>
<p>The <code>n = 100</code> is the number of binary responses to generate, <code>size = 1</code> indicates two choices (<code>0</code> or <code>1</code>), and <code>prob = .2</code> is the long-run probability of getting a <code>1</code>.</p>
<p>If we say that an outcome of <code>1</code> is a success and that an outcome of <code>0</code> is a failure, then the average taken over all outcomes is the sample probability of success.</p>
<p>Here we compute averages over a samples of binary outcomes where the probability of a <code>1</code> (success) is .2, .5, and .9.</p>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb773-1"><a href="thursday-november-3-2022.html#cb773-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> .<span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 0.16</code></pre>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb775-1"><a href="thursday-november-3-2022.html#cb775-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> .<span class="dv">5</span>))</span></code></pre></div>
<pre><code>## [1] 0.48</code></pre>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb777-1"><a href="thursday-november-3-2022.html#cb777-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> .<span class="dv">9</span>))</span></code></pre></div>
<pre><code>## [1] 0.84</code></pre>
<p>Repeat. We see that the sample means are close to the long-run probabilities.</p>
<p>Recall that a regression model predicts the conditional mean values of the response variable. When the response variable is binary, the mean values are probabilities, so a logistic regression predicts the conditional probability of something happening. For example, the probability of getting COVID-19 given your social distancing and mask-wearing habits.</p>
<p>Probabilities are bounded between 0 and 1, but the linear regression line is not.</p>
<p>Example: Consider data collected from the recovered solid booster rockets of the 23 previous shuttle flights (before the Challenger Space Shuttle disaster in 1986). The temperature in F at launch time and whether there was (<code>1</code>) or was not (<code>0</code>) damage to the O-rings on the booster.</p>
<div class="sourceCode" id="cb779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb779-1"><a href="thursday-november-3-2022.html#cb779-1" aria-hidden="true" tabindex="-1"></a>Temperature <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">66</span>, <span class="dv">70</span>, <span class="dv">69</span>, <span class="dv">68</span>, <span class="dv">67</span>, <span class="dv">72</span>, <span class="dv">73</span>, <span class="dv">70</span>, <span class="dv">57</span>, <span class="dv">63</span>, <span class="dv">70</span>, <span class="dv">78</span>, <span class="dv">67</span>, <span class="dv">53</span>, <span class="dv">67</span>, <span class="dv">75</span>, <span class="dv">70</span>, <span class="dv">81</span>, <span class="dv">76</span>, <span class="dv">79</span>, <span class="dv">75</span>, <span class="dv">76</span>, <span class="dv">58</span>)</span>
<span id="cb779-2"><a href="thursday-november-3-2022.html#cb779-2" aria-hidden="true" tabindex="-1"></a>Damage <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<p>The variable <code>Damage</code> is the response variable and <code>Temperature</code> is the explanatory variable.</p>
<p>We start with a scatter plot of these two variables along with the linear regression line.</p>
<div class="sourceCode" id="cb780"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb780-1"><a href="thursday-november-3-2022.html#cb780-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Damage, Temperature)</span>
<span id="cb780-2"><a href="thursday-november-3-2022.html#cb780-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb780-3"><a href="thursday-november-3-2022.html#cb780-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb780-4"><a href="thursday-november-3-2022.html#cb780-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb780-5"><a href="thursday-november-3-2022.html#cb780-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, </span>
<span id="cb780-6"><a href="thursday-november-3-2022.html#cb780-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Temperature, <span class="at">y =</span> Damage)) <span class="sc">+</span></span>
<span id="cb780-7"><a href="thursday-november-3-2022.html#cb780-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb780-8"><a href="thursday-november-3-2022.html#cb780-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb780-9"><a href="thursday-november-3-2022.html#cb780-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 10 rows containing missing values (geom_smooth).</code></pre>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-644-1.png" width="672" /></p>
<p>The plot shows more points at a value of 1 (at least some damage to the O-rings) when temperatures are lower and more more points at a value of 0 (no damage) when the temperatures are higher.</p>
<p>The linear regression line indicates this inverse relationship. The line slopes from upper left to lower right. We conclude that there is less chance of O-ring damage when temperatures are higher. But we note that the straight line does not capture this relationship very well.</p>
<p>We fit a linear regression model to these data.</p>
<div class="sourceCode" id="cb783"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb783-1"><a href="thursday-november-3-2022.html#cb783-1" aria-hidden="true" tabindex="-1"></a>lrm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Damage <span class="sc">~</span> Temperature, </span>
<span id="cb783-2"><a href="thursday-november-3-2022.html#cb783-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> df)</span>
<span id="cb783-3"><a href="thursday-november-3-2022.html#cb783-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lrm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Damage ~ Temperature, data = df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.43762 -0.30679 -0.06381  0.17452  0.89881 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)  2.90476    0.84208   3.450  0.00240 **
## Temperature -0.03738    0.01205  -3.103  0.00538 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3987 on 21 degrees of freedom
## Multiple R-squared:  0.3144, Adjusted R-squared:  0.2818 
## F-statistic:  9.63 on 1 and 21 DF,  p-value: 0.005383</code></pre>
<p>The model diagnostics indicate temperature is significant in explaining O-ring damage.</p>
<p>Looking at the slope coefficient we can state that for every one degree F <em>decrease</em> in temperature the chance of damage increases by 3.7 percentage points.</p>
<p>We interpret the predicted damage as the probability of damage for a given temperature (conditional mean).</p>
<p>We use the <code>predict()</code> method to predict the probability of damage when the launch temperatures are 77 F, 65 F, and 51 F. We multiply the predicted mean values by 100 so that the probabilities are in percentages.</p>
<div class="sourceCode" id="cb785"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb785-1"><a href="thursday-november-3-2022.html#cb785-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(lrm, </span>
<span id="cb785-2"><a href="thursday-november-3-2022.html#cb785-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">Temperature =</span> <span class="fu">c</span>(<span class="dv">77</span>, <span class="dv">65</span>, <span class="dv">51</span>))) <span class="sc">*</span> <span class="dv">100</span></span></code></pre></div>
<pre><code>##         1         2         3 
##  2.642857 47.500000 99.833333</code></pre>
<p>Predictions make sense. When the launch temperature is 77 F, the chance of O-ring damage is quite small (2.6%) but when the launch temperature is 51 F, the change of O-ring damage is quite large (99.8%).</p>
<p>Although this appears to be a reasonable prediction equation, it leads to nonsensical forecasts. For example, what does the linear regression model predict when the temperature is 85 F and when it is 45 F?</p>
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb787-1"><a href="thursday-november-3-2022.html#cb787-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(lrm, </span>
<span id="cb787-2"><a href="thursday-november-3-2022.html#cb787-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">Temperature =</span> <span class="fu">c</span>(<span class="dv">85</span>, <span class="dv">45</span>))) <span class="sc">*</span> <span class="dv">100</span></span></code></pre></div>
<pre><code>##        1        2 
## -27.2619 122.2619</code></pre>
<p>These values do not make sense since probabilities are constrained to be between 0 and 100 (0 and 1).</p>
<p>Key point: Linear regression can not capture the bounded nature of probabilities.</p>
</div>
<div id="logistic-regression" class="section level2 unnumbered hasAnchor">
<h2>Logistic regression<a href="thursday-november-3-2022.html#logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A regression model has a response function and a regression structure. The response function is specified on the left side of the regression equation and the regression structure on the right side of the equation.</p>
<p>With linear regression, the response function is the identity function. That is, for any value of <span class="math inline">\(y\)</span> the function returns the value of <span class="math inline">\(y\)</span>. We write it as
<span class="math display">\[
f(y) = y
\]</span></p>
<p>With logistic regression, the response function is the <em>logit</em> function. Said another way, logistic regression is a generalization of the linear regression model where the response function is the <em>logit</em> function.</p>
<p>We write the <em>logit</em> function as
<span class="math display">\[
f(y) = \hbox{logit}(y)
\]</span></p>
<p>The logit is the logarithm of the odds ratio. The odds ratio is the probability of a thing happening to the probability it wonâ€™t happen. Using math
<span class="math display">\[
\hbox{logit}(\pi) = \log\left(\frac{\pi}{1 - \pi}\right).
\]</span></p>
<p>We write odds as <em>for:against</em>. If there is a 2:1 odds of something happening, then the probability it will happen is 2/(1 + 2) or 2/3 (67%).</p>
<p>The inverse of the logit function is the logistic function. With logit(<span class="math inline">\(\pi\)</span>) = <span class="math inline">\(z\)</span>, we have
<span class="math display">\[
\pi = \frac{\exp(z)}{1 + \exp(z)} = \frac{1}{1 + \exp(-z)}.
\]</span></p>
<p>To make a graph of the logistic function we use the <code>curve()</code> function.</p>
<div class="sourceCode" id="cb789"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb789-1"><a href="thursday-november-3-2022.html#cb789-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>x)), </span>
<span id="cb789-2"><a href="thursday-november-3-2022.html#cb789-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">from =</span> <span class="sc">-</span><span class="dv">6</span>, <span class="at">to =</span> <span class="dv">6</span>, </span>
<span id="cb789-3"><a href="thursday-november-3-2022.html#cb789-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;logistic function of z&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;z&quot;</span>)</span>
<span id="cb789-4"><a href="thursday-november-3-2022.html#cb789-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb789-5"><a href="thursday-november-3-2022.html#cb789-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-648-1.png" width="672" /></p>
<p>The logistic function takes as input any value from negative infinity to positive infinity and returns a value between 0 and 1.</p>
<p>The variable <span class="math inline">\(z\)</span> can be thought of as the exposure to some set of risk factors, while the logistic function represents the chance of a particular outcome given the exposure.</p>
<p>The variable <span class="math inline">\(z\)</span> is a measure of the total contribution (weighted sum) of all the risk factors (explanatory variables). It is defined as
<span class="math display">\[
z = \beta_0 + \beta_1  x_1 + \beta_2  x_2 + \ldots + \beta_p x_p
\]</span>
where the regression coefficients are <span class="math inline">\(\beta_0\)</span>,â€¦, <span class="math inline">\(\beta_p\)</span> and the risk factors are <span class="math inline">\(x_1\)</span>,â€¦, <span class="math inline">\(x_p\)</span>. The intercept <span class="math inline">\(\beta_0\)</span> is the value of <span class="math inline">\(z\)</span> when there is no risk (base rate).</p>
<p>The regression coefficient quantifies the amount of contribution the associated variable makes to the overall risk. For example, the magnitude of <span class="math inline">\(\beta_1\)</span> quantifies the amount of contribution variable <span class="math inline">\(x_1\)</span> makes to the overall risk.</p>
<p>A positive regression coefficient means the variable increases the probability of the outcome. If the outcome is getting COVID-19, then the variable indicating that you donâ€™t wear a mask in public, increases the probability of that outcome.</p>
<p>A negative regression coefficient means the variable decreases the probability of that outcome.</p>
<p>A large regression coefficient means the variable strongly influences the probability of that outcome; while a near-zero regression coefficient means the variable has little influence on the probability of that outcome.</p>
<p>Example: Who survives in the Donner Party?</p>
<p>The Donner and Reed families from Springfield, Illinois headed to California in 1846. The group, which became know as the â€˜Donner Partyâ€™, was stranded in the Sierra Nevada mountains by heavy late October snows. By the time the last survivor was rescued in April 1847, 40 of the 87 members had died from famine and exposure to the cold.</p>
<p>The data file <code>DonnerParty.txt</code> contains a list of individuals in the Donner Party along with their age, sex, and whether or not they survived.</p>
<div class="sourceCode" id="cb790"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb790-1"><a href="thursday-november-3-2022.html#cb790-1" aria-hidden="true" tabindex="-1"></a>DP.df <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_table</span>(<span class="at">file =</span> <span class="st">&quot;http://myweb.fsu.edu/jelsner/temp/data/DonnerParty.txt&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb790-2"><a href="thursday-november-3-2022.html#cb790-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Survival =</span> <span class="fu">as.factor</span>(Survival))</span></code></pre></div>
<pre><code>## 
## â”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
## cols(
##   Last = col_character(),
##   First = col_character(),
##   Sex = col_character(),
##   Age = col_double(),
##   Survival = col_character()
## )</code></pre>
<div class="sourceCode" id="cb792"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb792-1"><a href="thursday-november-3-2022.html#cb792-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(DP.df)</span></code></pre></div>
<pre><code>## tibble [45 Ã— 5] (S3: tbl_df/tbl/data.frame)
##  $ Last    : chr [1:45] &quot;Antoine&quot; &quot;Breen&quot; &quot;Breen&quot; &quot;Burger&quot; ...
##  $ First   : chr [1:45] &quot;A&quot; &quot;Mary&quot; &quot;Patrick&quot; &quot;Charles&quot; ...
##  $ Sex     : chr [1:45] &quot;male&quot; &quot;female&quot; &quot;male&quot; &quot;male&quot; ...
##  $ Age     : num [1:45] 23 40 40 30 28 40 45 62 65 45 ...
##  $ Survival: Factor w/ 2 levels &quot;no&quot;,&quot;yes&quot;: 1 2 2 1 1 1 1 1 1 1 ...</code></pre>
<p>The data frame contains the <code>Name</code>, <code>Sex</code>, <code>Age</code>, and <code>Survival</code> status of all individuals that were at least 15 years old.</p>
<p>How many individuals are coded as <code>female</code> and how many are coded as <code>male</code>?</p>
<div class="sourceCode" id="cb794"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb794-1"><a href="thursday-november-3-2022.html#cb794-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(DP.df<span class="sc">$</span>Sex)</span></code></pre></div>
<pre><code>## 
## female   male 
##     15     30</code></pre>
<p>How many survived?</p>
<div class="sourceCode" id="cb796"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb796-1"><a href="thursday-november-3-2022.html#cb796-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(DP.df<span class="sc">$</span>Survival)</span></code></pre></div>
<pre><code>## 
##  no yes 
##  25  20</code></pre>
<p>What was the average age in the party?</p>
<div class="sourceCode" id="cb798"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb798-1"><a href="thursday-november-3-2022.html#cb798-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(DP.df<span class="sc">$</span>Age)</span></code></pre></div>
<pre><code>## [1] 31.8</code></pre>
<p>What is the relationship between an individualâ€™s age and whether or not they survived?</p>
<div class="sourceCode" id="cb800"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb800-1"><a href="thursday-november-3-2022.html#cb800-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> DP.df, </span>
<span id="cb800-2"><a href="thursday-november-3-2022.html#cb800-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Survival, <span class="at">y =</span> Age)) <span class="sc">+</span> </span>
<span id="cb800-3"><a href="thursday-november-3-2022.html#cb800-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="QG-2022_files/figure-html/unnamed-chunk-653-1.png" width="672" /></p>
<p>Age appears to be a factor in explaining whether or not someone survived. Younger members of the party appear to have had a better chance of survival.</p>
<p>What about sex as an explanatory variable?</p>
<div class="sourceCode" id="cb801"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb801-1"><a href="thursday-november-3-2022.html#cb801-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(DP.df<span class="sc">$</span>Sex, DP.df<span class="sc">$</span>Survival)</span></code></pre></div>
<pre><code>##         
##          no yes
##   female  5  10
##   male   20  10</code></pre>
<p>The table shows that of the 15 women, 5 perished and 10 survived. This compares with 20 deaths and 10 survivors among the men. It appears that sex is also important. Relatively more women survived than men.</p>
<p>Logistic regression quantifies these risk factors (sex and age) in terms of survival probability.</p>
<p>The variable <code>Survival</code> is our dependent (response) variable coded as <code>no</code> and <code>yes</code>. The two risk factors are <code>Sex</code> coded as <code>male</code> and <code>female</code> and <code>Age</code> in years.</p>
<p>So you fit a logistic model to these data with <code>Survival</code> as your response variable. You use the <code>glm()</code> function (generalized linear model) and specify <code>family = binomial</code>.</p>
<div class="sourceCode" id="cb803"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb803-1"><a href="thursday-november-3-2022.html#cb803-1" aria-hidden="true" tabindex="-1"></a>logrm <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">factor</span>(Survival) <span class="sc">~</span> Age <span class="sc">+</span> Sex, </span>
<span id="cb803-2"><a href="thursday-november-3-2022.html#cb803-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> DP.df, </span>
<span id="cb803-3"><a href="thursday-november-3-2022.html#cb803-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">family =</span> binomial)</span>
<span id="cb803-4"><a href="thursday-november-3-2022.html#cb803-4" aria-hidden="true" tabindex="-1"></a>logrm</span></code></pre></div>
<pre><code>## 
## Call:  glm(formula = factor(Survival) ~ Age + Sex, family = binomial, 
##     data = DP.df)
## 
## Coefficients:
## (Intercept)          Age      Sexmale  
##      3.2304      -0.0782      -1.5973  
## 
## Degrees of Freedom: 44 Total (i.e. Null);  42 Residual
## Null Deviance:       61.83 
## Residual Deviance: 51.26     AIC: 57.26</code></pre>
<p>You write the model, where <span class="math inline">\(\pi\)</span> represents survival probability, as
<span class="math display">\[
\hbox{logit}(\pi) = 3.23 - .0782 \times \hbox{Age} - 1.597 \times \hbox{Sex}
\]</span></p>
<p>You interpret the value of 3.23 as the base rate when <code>Age</code> is zero and <code>Sex</code> is zero. Although <code>Sex</code> is coded as a factor variable <code>female</code> comes before <code>male</code> alphabetically so <code>female</code> is zero.</p>
<p>You take the value of 3.23 as input to the logistic function and get</p>
<div class="sourceCode" id="cb805"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb805-1"><a href="thursday-november-3-2022.html#cb805-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fl">3.23</span>)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="fl">3.23</span>))</span></code></pre></div>
<pre><code>## [1] 0.9619478</code></pre>
<p>The resulting value tells you that a newborn (<code>Age</code> = 0) girl would have a 96% chance of survival.</p>
<p>You get this answer directly with the <code>predict()</code> method by typing</p>
<div class="sourceCode" id="cb807"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb807-1"><a href="thursday-november-3-2022.html#cb807-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logrm, </span>
<span id="cb807-2"><a href="thursday-november-3-2022.html#cb807-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">Age =</span> <span class="dv">0</span>, <span class="at">Sex =</span> <span class="st">&quot;female&quot;</span>),</span>
<span id="cb807-3"><a href="thursday-november-3-2022.html#cb807-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<pre><code>##         1 
## 0.9619629</code></pre>
<p>Without the <code>type =</code> argument you get the logit value of 3.23.</p>
<p>You can also interpret the model in terms of the odds ratio. For example, the model tells you that the odds ratio of a 20-year old surviving relative to a 50-year old is
<span class="math display">\[
\exp(-.0782 \times (20 - 50))
\]</span></p>
<p>With code</p>
<div class="sourceCode" id="cb809"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb809-1"><a href="thursday-november-3-2022.html#cb809-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="sc">-</span>.<span class="dv">0782</span> <span class="sc">*</span> (<span class="dv">20</span> <span class="sc">-</span> <span class="dv">50</span>))</span></code></pre></div>
<pre><code>## [1] 10.44371</code></pre>
<p>The odds of a 20-year old surviving is more than 10 times the odds of a 50-year old surviving regardless of whether the person is a man or woman.</p>
<p>If an explanatory variable increases by one unit while the other explanatory variables remain constant, the odds will change by a <em>multiplicative</em> amount given by the exponent of the coefficient.</p>
<p>The odds of a woman (<code>Sex = 0</code>) surviving relative to the odds of a man (<code>Sex = 1</code>) of the same age is</p>
<div class="sourceCode" id="cb811"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb811-1"><a href="thursday-november-3-2022.html#cb811-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="sc">-</span><span class="fl">1.597</span> <span class="sc">*</span> (<span class="dv">0</span> <span class="sc">-</span> <span class="dv">1</span>))</span></code></pre></div>
<pre><code>## [1] 4.938196</code></pre>
<p>Thus, the survival odds of a women are about 5 times the survival odds of a man both at the same age.</p>
<p>You get uncertainty intervals on the coefficients using an extractor function.</p>
<div class="sourceCode" id="cb813"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb813-1"><a href="thursday-november-3-2022.html#cb813-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(logrm)</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<pre><code>##                  2.5 %      97.5 %
## (Intercept)  0.8514190  6.42669512
## Age         -0.1624377 -0.01406576
## Sexmale     -3.2286705 -0.19510198</code></pre>
<p>You see that the 95% uncertainty intervals for both factors do not include the value of zero. This indicates that <code>Age</code> and <code>Sex</code> are significant in statistically explaining survivability.</p>
<p>You can also check the importance of the variables with the <code>summary()</code> method on the model object.</p>
<div class="sourceCode" id="cb816"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb816-1"><a href="thursday-november-3-2022.html#cb816-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logrm)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = factor(Survival) ~ Age + Sex, family = binomial, 
##     data = DP.df)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.7445  -1.0441  -0.3029   0.8877   2.0472  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept)  3.23041    1.38686   2.329   0.0198 *
## Age         -0.07820    0.03728  -2.097   0.0359 *
## Sexmale     -1.59729    0.75547  -2.114   0.0345 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 61.827  on 44  degrees of freedom
## Residual deviance: 51.256  on 42  degrees of freedom
## AIC: 57.256
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>You see that <code>Age</code> and <code>Sex</code> are significant variables in explaining the probability of survival (<span class="math inline">\(p\)</span> values less than .05).</p>
<p>The smaller the residual deviance, the better the logistic model fits. Output shows a null deviance of 61.827 on 44 degrees of freedom. The null deviance is the deviance of a model with a constant (no explanatory variables) survival probability (44%; 20 out of 45 survived).</p>
<p>The residual deviance for the model with <code>Age</code> and <code>Sex</code> as explanatory variables is 51.256 on 42 degrees of freedom. The difference in deviance between the null and the full model is: 61.827 - 51.256 = 10.571. The difference in degrees of freedom is 44 - 42 = 2.</p>
<p>You compare this drop in deviance to a value from the chi-squared distribution with 2 degrees of freedom.</p>
<div class="sourceCode" id="cb818"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb818-1"><a href="thursday-november-3-2022.html#cb818-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(<span class="fl">10.571</span>, </span>
<span id="cb818-2"><a href="thursday-november-3-2022.html#cb818-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">df =</span> <span class="dv">2</span>, </span>
<span id="cb818-3"><a href="thursday-november-3-2022.html#cb818-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.005064499</code></pre>
<p>This is the <span class="math inline">\(p\)</span> value for the model as a whole. Since it is less than .01 you state that there is convincing evidence that the model helps statistically explain survivability given these data.</p>
<p>Here you predict the survival probability of a 50-year old man.</p>
<div class="sourceCode" id="cb820"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb820-1"><a href="thursday-november-3-2022.html#cb820-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logrm, </span>
<span id="cb820-2"><a href="thursday-november-3-2022.html#cb820-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">Age =</span> <span class="dv">50</span>, </span>
<span id="cb820-3"><a href="thursday-november-3-2022.html#cb820-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">Sex =</span> <span class="st">&quot;male&quot;</span>))</span></code></pre></div>
<pre><code>##         1 
## -2.277083</code></pre>
<p>By default the predicted value is the logarithm of the odds. To convert this to a probability we use the logistic function or we use the <code>type = "response"</code> argument in the <code>predict()</code> method.</p>
<div class="sourceCode" id="cb822"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb822-1"><a href="thursday-november-3-2022.html#cb822-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="sc">-</span><span class="fl">2.277</span>)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">2.277</span>))</span></code></pre></div>
<pre><code>## [1] 0.09304581</code></pre>
<div class="sourceCode" id="cb824"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb824-1"><a href="thursday-november-3-2022.html#cb824-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logrm, </span>
<span id="cb824-2"><a href="thursday-november-3-2022.html#cb824-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">Age =</span> <span class="dv">50</span>, </span>
<span id="cb824-3"><a href="thursday-november-3-2022.html#cb824-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">Sex =</span> <span class="st">&quot;male&quot;</span>),</span>
<span id="cb824-4"><a href="thursday-november-3-2022.html#cb824-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<pre><code>##          1 
## 0.09303878</code></pre>
<p>You see that, based on the data and the model, you would predict a survival probability of 9.3% for a 50-year old man.</p>
<p>What is the survival probability for a 50-year old woman? A 25-year old woman?</p>
<div class="sourceCode" id="cb826"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb826-1"><a href="thursday-november-3-2022.html#cb826-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logrm, </span>
<span id="cb826-2"><a href="thursday-november-3-2022.html#cb826-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">Age =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">25</span>), </span>
<span id="cb826-3"><a href="thursday-november-3-2022.html#cb826-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">Sex =</span> <span class="st">&quot;female&quot;</span>),</span>
<span id="cb826-4"><a href="thursday-november-3-2022.html#cb826-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;response&quot;</span>,</span>
<span id="cb826-5"><a href="thursday-november-3-2022.html#cb826-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## $fit
##         1         2 
## 0.3363082 0.7816507 
## 
## $se.fit
##         1         2 
## 0.1904773 0.1153756 
## 
## $residual.scale
## [1] 1</code></pre>
<p>You include the argument <code>se.fit = TRUE</code> to get a standard error on the predicted survival probability.</p>
<p>Assessing the adequacy of a linear regression model involves plots of the residuals. Similar diagnostics are available for assessing the adequacy of logistic regression, but they are often more difficult to interpret. For instance how do you examine the linearity assumption when the linearity is on the log of the odds?</p>
<p>Residual deviance: Returning to the output from <code>summary(logrm)</code>, you find that the residual deviance is 51.256 on 42 degrees of freedom. A <span class="math inline">\(p\)</span> value from a <span class="math inline">\(\chi^2\)</span> distribution with a quantile value of 51.256 with this many degrees of freedom provides evidence against the null hypothesis. The null hypothesis is that the model is adequate.</p>
<p>Thus a small <span class="math inline">\(p\)</span> value in this case is evidence <em>against</em> the null hypothesis, which is that the model is adequate.</p>
<div class="sourceCode" id="cb828"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb828-1"><a href="thursday-november-3-2022.html#cb828-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(<span class="at">q =</span> <span class="fl">51.256</span>, </span>
<span id="cb828-2"><a href="thursday-november-3-2022.html#cb828-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">df =</span> <span class="dv">42</span>, </span>
<span id="cb828-3"><a href="thursday-november-3-2022.html#cb828-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.1549141</code></pre>
<p>Since the <span class="math inline">\(p\)</span> value exceeds .05 you fail to reject the null hypothesis that the model is adequate and report that there is no compelling evidence that the model needs to be improved.</p>
<p>Example: Probability of rocket damage on liftoff</p>
<p>Returning to the data on the Space Shuttle O-ring damage and launch time temperature. The recovered booster rockets were checked for damage to the rings. A damaged rocket booster is coded as <code>1</code>.</p>
<div class="sourceCode" id="cb830"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb830-1"><a href="thursday-november-3-2022.html#cb830-1" aria-hidden="true" tabindex="-1"></a>Temperature <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">66</span>, <span class="dv">70</span>, <span class="dv">69</span>, <span class="dv">68</span>, <span class="dv">67</span>, <span class="dv">72</span>, <span class="dv">73</span>, <span class="dv">70</span>, <span class="dv">57</span>, <span class="dv">63</span>, <span class="dv">70</span>, <span class="dv">78</span>, <span class="dv">67</span>, <span class="dv">53</span>, <span class="dv">67</span>, <span class="dv">75</span>, <span class="dv">70</span>, <span class="dv">81</span>, <span class="dv">76</span>, <span class="dv">79</span>, <span class="dv">75</span>, <span class="dv">76</span>, <span class="dv">58</span>)</span>
<span id="cb830-2"><a href="thursday-november-3-2022.html#cb830-2" aria-hidden="true" tabindex="-1"></a>Damage <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb830-3"><a href="thursday-november-3-2022.html#cb830-3" aria-hidden="true" tabindex="-1"></a>ORings.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Temperature, Damage)</span></code></pre></div>
<p>A logistic regression model is used to predict the probability of damage given the temperature.</p>
<p>Fit a logistic regression model to the data.</p>
<div class="sourceCode" id="cb831"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb831-1"><a href="thursday-november-3-2022.html#cb831-1" aria-hidden="true" tabindex="-1"></a>logrm <span class="ot">&lt;-</span> <span class="fu">glm</span>(Damage <span class="sc">~</span> Temperature, </span>
<span id="cb831-2"><a href="thursday-november-3-2022.html#cb831-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> ORings.df,</span>
<span id="cb831-3"><a href="thursday-november-3-2022.html#cb831-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">family =</span> binomial)</span>
<span id="cb831-4"><a href="thursday-november-3-2022.html#cb831-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logrm)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Damage ~ Temperature, family = binomial, data = ORings.df)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.0611  -0.7613  -0.3783   0.4524   2.2175  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept)  15.0429     7.3786   2.039   0.0415 *
## Temperature  -0.2322     0.1082  -2.145   0.0320 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 28.267  on 22  degrees of freedom
## Residual deviance: 20.315  on 21  degrees of freedom
## AIC: 24.315
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>The negative sign on the <code>Temperature</code> coefficient indicates that the chance of O-ring damages decreases with increasing temperature.</p>
<p>You interpret the magnitude of the coefficient by first applying the exponentiation function (<code>exp()</code>).</p>
<div class="sourceCode" id="cb833"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb833-1"><a href="thursday-november-3-2022.html#cb833-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="sc">-</span>.<span class="dv">2322</span>)</span></code></pre></div>
<pre><code>## [1] 0.7927875</code></pre>
<p>The value of .79 tells you that for every 1 degree increase in temperature the chance of O-ring damage is only 79% of itâ€™s previous value (given the model).</p>
<p>For example, to determine how much more likely there is to be damage when the temperature is 65 F compared to when the temperature is 69 F you use</p>
<div class="sourceCode" id="cb835"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb835-1"><a href="thursday-november-3-2022.html#cb835-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">exp</span>(<span class="sc">-</span>.<span class="dv">2322</span> <span class="sc">*</span> (<span class="dv">65</span> <span class="sc">-</span> <span class="dv">69</span>)), <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 2.5</code></pre>
<p>Thus, on average, there is a 2.5 times increase in the chance of O-ring damage when launch temperatures are 65 F compared to when they are 69 F.</p>
<div class="sourceCode" id="cb837"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb837-1"><a href="thursday-november-3-2022.html#cb837-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(logrm,</span>
<span id="cb837-2"><a href="thursday-november-3-2022.html#cb837-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">Temperature =</span> <span class="fu">c</span>(<span class="dv">45</span>, <span class="dv">95</span>)),</span>
<span id="cb837-3"><a href="thursday-november-3-2022.html#cb837-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<pre><code>##           1           2 
## 0.990004536 0.000899691</code></pre>
<p>With generalized linear models, model adequacy is determined by the residual deviance. No plots are needed.</p>
<p>The residual deviance is 20.315 on 21 degrees of freedom. A <span class="math inline">\(p\)</span> value from a <span class="math inline">\(\chi^2\)</span> distribution with this quantile value and this many degrees of freedom is evidence in favor of the null hypothesis that the model is adequate.</p>
<div class="sourceCode" id="cb839"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb839-1"><a href="thursday-november-3-2022.html#cb839-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(<span class="at">q =</span> <span class="fl">20.315</span>, </span>
<span id="cb839-2"><a href="thursday-november-3-2022.html#cb839-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">df =</span> <span class="dv">21</span>,</span>
<span id="cb839-3"><a href="thursday-november-3-2022.html#cb839-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.5013948</code></pre>
<p>The large <span class="math inline">\(p\)</span> value gives you no reason to question the adequacy of the model.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tuesday-november-1-2022.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tuesday-november-8-2022.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
